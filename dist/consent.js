(function(){"use strict";var Sa=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ta(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function Ia(r){if(Object.prototype.hasOwnProperty.call(r,"__esModule"))return r;var e=r.default;if(typeof e=="function"){var n=function p(){var b=!1;try{b=this instanceof p}catch{}return b?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(r).forEach(function(p){var b=Object.getOwnPropertyDescriptor(r,p);Object.defineProperty(n,p,b.get?b:{enumerable:!0,get:function(){return r[p]}})}),n}var _t,xr;function ue(){return xr||(xr=1,_t={options:{usePureJavaScript:!1}}),_t}var Nt={exports:{}},Rt,Sr;function Aa(){if(Sr)return Rt;Sr=1;var r={};Rt=r;var e={};r.encode=function(p,b,x){if(typeof b!="string")throw new TypeError('"alphabet" must be a string.');if(x!==void 0&&typeof x!="number")throw new TypeError('"maxline" must be a number.');var c="";if(!(p instanceof Uint8Array))c=n(p,b);else{var t=0,y=b.length,f=b.charAt(0),S=[0];for(t=0;t<p.length;++t){for(var k=0,E=p[t];k<S.length;++k)E+=S[k]<<8,S[k]=E%y,E=E/y|0;for(;E>0;)S.push(E%y),E=E/y|0}for(t=0;p[t]===0&&t<p.length-1;++t)c+=f;for(t=S.length-1;t>=0;--t)c+=b[S[t]]}if(x){var u=new RegExp(".{1,"+x+"}","g");c=c.match(u).join(`\r
`)}return c},r.decode=function(p,b){if(typeof p!="string")throw new TypeError('"input" must be a string.');if(typeof b!="string")throw new TypeError('"alphabet" must be a string.');var x=e[b];if(!x){x=e[b]=[];for(var c=0;c<b.length;++c)x[b.charCodeAt(c)]=c}p=p.replace(/\s/g,"");for(var t=b.length,y=b.charAt(0),f=[0],c=0;c<p.length;c++){var S=x[p.charCodeAt(c)];if(S===void 0)return;for(var k=0,E=S;k<f.length;++k)E+=f[k]*t,f[k]=E&255,E>>=8;for(;E>0;)f.push(E&255),E>>=8}for(var u=0;p[u]===y&&u<p.length-1;++u)f.push(0);return typeof Buffer<"u"?Buffer.from(f.reverse()):new Uint8Array(f.reverse())};function n(p,b){var x=0,c=b.length,t=b.charAt(0),y=[0];for(x=0;x<p.length();++x){for(var f=0,S=p.at(x);f<y.length;++f)S+=y[f]<<8,y[f]=S%c,S=S/c|0;for(;S>0;)y.push(S%c),S=S/c|0}var k="";for(x=0;p.at(x)===0&&x<p.length()-1;++x)k+=t;for(x=y.length-1;x>=0;--x)k+=b[y[x]];return k}return Rt}var Tr;function de(){if(Tr)return Nt.exports;Tr=1;var r=ue(),e=Aa(),n=Nt.exports=r.util=r.util||{};(function(){if(typeof process<"u"&&process.nextTick&&!process.browser){n.nextTick=process.nextTick,typeof setImmediate=="function"?n.setImmediate=setImmediate:n.setImmediate=n.nextTick;return}if(typeof setImmediate=="function"){n.setImmediate=function(){return setImmediate.apply(void 0,arguments)},n.nextTick=function(i){return setImmediate(i)};return}if(n.setImmediate=function(i){setTimeout(i,0)},typeof window<"u"&&typeof window.postMessage=="function"){let i=function(a){if(a.source===window&&a.data===s){a.stopPropagation();var B=d.slice();d.length=0,B.forEach(function(D){D()})}};var s="forge.setImmediate",d=[];n.setImmediate=function(a){d.push(a),d.length===1&&window.postMessage(s,"*")},window.addEventListener("message",i,!0)}if(typeof MutationObserver<"u"){var v=Date.now(),I=!0,R=document.createElement("div"),d=[];new MutationObserver(function(){var a=d.slice();d.length=0,a.forEach(function(B){B()})}).observe(R,{attributes:!0});var h=n.setImmediate;n.setImmediate=function(a){Date.now()-v>15?(v=Date.now(),h(a)):(d.push(a),d.length===1&&R.setAttribute("a",I=!I))}}n.nextTick=n.setImmediate})(),n.isNodejs=typeof process<"u"&&process.versions&&process.versions.node,n.globalScope=function(){return n.isNodejs?Sa:typeof self>"u"?window:self}(),n.isArray=Array.isArray||function(s){return Object.prototype.toString.call(s)==="[object Array]"},n.isArrayBuffer=function(s){return typeof ArrayBuffer<"u"&&s instanceof ArrayBuffer},n.isArrayBufferView=function(s){return s&&n.isArrayBuffer(s.buffer)&&s.byteLength!==void 0};function p(s){if(!(s===8||s===16||s===24||s===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+s)}n.ByteBuffer=b;function b(s){if(this.data="",this.read=0,typeof s=="string")this.data=s;else if(n.isArrayBuffer(s)||n.isArrayBufferView(s))if(typeof Buffer<"u"&&s instanceof Buffer)this.data=s.toString("binary");else{var d=new Uint8Array(s);try{this.data=String.fromCharCode.apply(null,d)}catch{for(var v=0;v<d.length;++v)this.putByte(d[v])}}else(s instanceof b||typeof s=="object"&&typeof s.data=="string"&&typeof s.read=="number")&&(this.data=s.data,this.read=s.read);this._constructedStringLength=0}n.ByteStringBuffer=b;var x=4096;n.ByteStringBuffer.prototype._optimizeConstructedString=function(s){this._constructedStringLength+=s,this._constructedStringLength>x&&(this.data.substr(0,1),this._constructedStringLength=0)},n.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read},n.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0},n.ByteStringBuffer.prototype.putByte=function(s){return this.putBytes(String.fromCharCode(s))},n.ByteStringBuffer.prototype.fillWithByte=function(s,d){s=String.fromCharCode(s);for(var v=this.data;d>0;)d&1&&(v+=s),d>>>=1,d>0&&(s+=s);return this.data=v,this._optimizeConstructedString(d),this},n.ByteStringBuffer.prototype.putBytes=function(s){return this.data+=s,this._optimizeConstructedString(s.length),this},n.ByteStringBuffer.prototype.putString=function(s){return this.putBytes(n.encodeUtf8(s))},n.ByteStringBuffer.prototype.putInt16=function(s){return this.putBytes(String.fromCharCode(s>>8&255)+String.fromCharCode(s&255))},n.ByteStringBuffer.prototype.putInt24=function(s){return this.putBytes(String.fromCharCode(s>>16&255)+String.fromCharCode(s>>8&255)+String.fromCharCode(s&255))},n.ByteStringBuffer.prototype.putInt32=function(s){return this.putBytes(String.fromCharCode(s>>24&255)+String.fromCharCode(s>>16&255)+String.fromCharCode(s>>8&255)+String.fromCharCode(s&255))},n.ByteStringBuffer.prototype.putInt16Le=function(s){return this.putBytes(String.fromCharCode(s&255)+String.fromCharCode(s>>8&255))},n.ByteStringBuffer.prototype.putInt24Le=function(s){return this.putBytes(String.fromCharCode(s&255)+String.fromCharCode(s>>8&255)+String.fromCharCode(s>>16&255))},n.ByteStringBuffer.prototype.putInt32Le=function(s){return this.putBytes(String.fromCharCode(s&255)+String.fromCharCode(s>>8&255)+String.fromCharCode(s>>16&255)+String.fromCharCode(s>>24&255))},n.ByteStringBuffer.prototype.putInt=function(s,d){p(d);var v="";do d-=8,v+=String.fromCharCode(s>>d&255);while(d>0);return this.putBytes(v)},n.ByteStringBuffer.prototype.putSignedInt=function(s,d){return s<0&&(s+=2<<d-1),this.putInt(s,d)},n.ByteStringBuffer.prototype.putBuffer=function(s){return this.putBytes(s.getBytes())},n.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)},n.ByteStringBuffer.prototype.getInt16=function(){var s=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,s},n.ByteStringBuffer.prototype.getInt24=function(){var s=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,s},n.ByteStringBuffer.prototype.getInt32=function(){var s=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,s},n.ByteStringBuffer.prototype.getInt16Le=function(){var s=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,s},n.ByteStringBuffer.prototype.getInt24Le=function(){var s=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,s},n.ByteStringBuffer.prototype.getInt32Le=function(){var s=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,s},n.ByteStringBuffer.prototype.getInt=function(s){p(s);var d=0;do d=(d<<8)+this.data.charCodeAt(this.read++),s-=8;while(s>0);return d},n.ByteStringBuffer.prototype.getSignedInt=function(s){var d=this.getInt(s),v=2<<s-2;return d>=v&&(d-=v<<1),d},n.ByteStringBuffer.prototype.getBytes=function(s){var d;return s?(s=Math.min(this.length(),s),d=this.data.slice(this.read,this.read+s),this.read+=s):s===0?d="":(d=this.read===0?this.data:this.data.slice(this.read),this.clear()),d},n.ByteStringBuffer.prototype.bytes=function(s){return typeof s>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+s)},n.ByteStringBuffer.prototype.at=function(s){return this.data.charCodeAt(this.read+s)},n.ByteStringBuffer.prototype.setAt=function(s,d){return this.data=this.data.substr(0,this.read+s)+String.fromCharCode(d)+this.data.substr(this.read+s+1),this},n.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)},n.ByteStringBuffer.prototype.copy=function(){var s=n.createBuffer(this.data);return s.read=this.read,s},n.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this},n.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this},n.ByteStringBuffer.prototype.truncate=function(s){var d=Math.max(0,this.length()-s);return this.data=this.data.substr(this.read,d),this.read=0,this},n.ByteStringBuffer.prototype.toHex=function(){for(var s="",d=this.read;d<this.data.length;++d){var v=this.data.charCodeAt(d);v<16&&(s+="0"),s+=v.toString(16)}return s},n.ByteStringBuffer.prototype.toString=function(){return n.decodeUtf8(this.bytes())};function c(s,d){d=d||{},this.read=d.readOffset||0,this.growSize=d.growSize||1024;var v=n.isArrayBuffer(s),I=n.isArrayBufferView(s);if(v||I){v?this.data=new DataView(s):this.data=new DataView(s.buffer,s.byteOffset,s.byteLength),this.write="writeOffset"in d?d.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,s!=null&&this.putBytes(s),"writeOffset"in d&&(this.write=d.writeOffset)}n.DataBuffer=c,n.DataBuffer.prototype.length=function(){return this.write-this.read},n.DataBuffer.prototype.isEmpty=function(){return this.length()<=0},n.DataBuffer.prototype.accommodate=function(s,d){if(this.length()>=s)return this;d=Math.max(d||this.growSize,s);var v=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),I=new Uint8Array(this.length()+d);return I.set(v),this.data=new DataView(I.buffer),this},n.DataBuffer.prototype.putByte=function(s){return this.accommodate(1),this.data.setUint8(this.write++,s),this},n.DataBuffer.prototype.fillWithByte=function(s,d){this.accommodate(d);for(var v=0;v<d;++v)this.data.setUint8(s);return this},n.DataBuffer.prototype.putBytes=function(s,d){if(n.isArrayBufferView(s)){var v=new Uint8Array(s.buffer,s.byteOffset,s.byteLength),I=v.byteLength-v.byteOffset;this.accommodate(I);var R=new Uint8Array(this.data.buffer,this.write);return R.set(v),this.write+=I,this}if(n.isArrayBuffer(s)){var v=new Uint8Array(s);this.accommodate(v.byteLength);var R=new Uint8Array(this.data.buffer);return R.set(v,this.write),this.write+=v.byteLength,this}if(s instanceof n.DataBuffer||typeof s=="object"&&typeof s.read=="number"&&typeof s.write=="number"&&n.isArrayBufferView(s.data)){var v=new Uint8Array(s.data.byteLength,s.read,s.length());this.accommodate(v.byteLength);var R=new Uint8Array(s.data.byteLength,this.write);return R.set(v),this.write+=v.byteLength,this}if(s instanceof n.ByteStringBuffer&&(s=s.data,d="binary"),d=d||"binary",typeof s=="string"){var h;if(d==="hex")return this.accommodate(Math.ceil(s.length/2)),h=new Uint8Array(this.data.buffer,this.write),this.write+=n.binary.hex.decode(s,h,this.write),this;if(d==="base64")return this.accommodate(Math.ceil(s.length/4)*3),h=new Uint8Array(this.data.buffer,this.write),this.write+=n.binary.base64.decode(s,h,this.write),this;if(d==="utf8"&&(s=n.encodeUtf8(s),d="binary"),d==="binary"||d==="raw")return this.accommodate(s.length),h=new Uint8Array(this.data.buffer,this.write),this.write+=n.binary.raw.decode(h),this;if(d==="utf16")return this.accommodate(s.length*2),h=new Uint16Array(this.data.buffer,this.write),this.write+=n.text.utf16.encode(h),this;throw new Error("Invalid encoding: "+d)}throw Error("Invalid parameter: "+s)},n.DataBuffer.prototype.putBuffer=function(s){return this.putBytes(s),s.clear(),this},n.DataBuffer.prototype.putString=function(s){return this.putBytes(s,"utf16")},n.DataBuffer.prototype.putInt16=function(s){return this.accommodate(2),this.data.setInt16(this.write,s),this.write+=2,this},n.DataBuffer.prototype.putInt24=function(s){return this.accommodate(3),this.data.setInt16(this.write,s>>8&65535),this.data.setInt8(this.write,s>>16&255),this.write+=3,this},n.DataBuffer.prototype.putInt32=function(s){return this.accommodate(4),this.data.setInt32(this.write,s),this.write+=4,this},n.DataBuffer.prototype.putInt16Le=function(s){return this.accommodate(2),this.data.setInt16(this.write,s,!0),this.write+=2,this},n.DataBuffer.prototype.putInt24Le=function(s){return this.accommodate(3),this.data.setInt8(this.write,s>>16&255),this.data.setInt16(this.write,s>>8&65535,!0),this.write+=3,this},n.DataBuffer.prototype.putInt32Le=function(s){return this.accommodate(4),this.data.setInt32(this.write,s,!0),this.write+=4,this},n.DataBuffer.prototype.putInt=function(s,d){p(d),this.accommodate(d/8);do d-=8,this.data.setInt8(this.write++,s>>d&255);while(d>0);return this},n.DataBuffer.prototype.putSignedInt=function(s,d){return p(d),this.accommodate(d/8),s<0&&(s+=2<<d-1),this.putInt(s,d)},n.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)},n.DataBuffer.prototype.getInt16=function(){var s=this.data.getInt16(this.read);return this.read+=2,s},n.DataBuffer.prototype.getInt24=function(){var s=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,s},n.DataBuffer.prototype.getInt32=function(){var s=this.data.getInt32(this.read);return this.read+=4,s},n.DataBuffer.prototype.getInt16Le=function(){var s=this.data.getInt16(this.read,!0);return this.read+=2,s},n.DataBuffer.prototype.getInt24Le=function(){var s=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,s},n.DataBuffer.prototype.getInt32Le=function(){var s=this.data.getInt32(this.read,!0);return this.read+=4,s},n.DataBuffer.prototype.getInt=function(s){p(s);var d=0;do d=(d<<8)+this.data.getInt8(this.read++),s-=8;while(s>0);return d},n.DataBuffer.prototype.getSignedInt=function(s){var d=this.getInt(s),v=2<<s-2;return d>=v&&(d-=v<<1),d},n.DataBuffer.prototype.getBytes=function(s){var d;return s?(s=Math.min(this.length(),s),d=this.data.slice(this.read,this.read+s),this.read+=s):s===0?d="":(d=this.read===0?this.data:this.data.slice(this.read),this.clear()),d},n.DataBuffer.prototype.bytes=function(s){return typeof s>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+s)},n.DataBuffer.prototype.at=function(s){return this.data.getUint8(this.read+s)},n.DataBuffer.prototype.setAt=function(s,d){return this.data.setUint8(s,d),this},n.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)},n.DataBuffer.prototype.copy=function(){return new n.DataBuffer(this)},n.DataBuffer.prototype.compact=function(){if(this.read>0){var s=new Uint8Array(this.data.buffer,this.read),d=new Uint8Array(s.byteLength);d.set(s),this.data=new DataView(d),this.write-=this.read,this.read=0}return this},n.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this},n.DataBuffer.prototype.truncate=function(s){return this.write=Math.max(0,this.length()-s),this.read=Math.min(this.read,this.write),this},n.DataBuffer.prototype.toHex=function(){for(var s="",d=this.read;d<this.data.byteLength;++d){var v=this.data.getUint8(d);v<16&&(s+="0"),s+=v.toString(16)}return s},n.DataBuffer.prototype.toString=function(s){var d=new Uint8Array(this.data,this.read,this.length());if(s=s||"utf8",s==="binary"||s==="raw")return n.binary.raw.encode(d);if(s==="hex")return n.binary.hex.encode(d);if(s==="base64")return n.binary.base64.encode(d);if(s==="utf8")return n.text.utf8.decode(d);if(s==="utf16")return n.text.utf16.decode(d);throw new Error("Invalid encoding: "+s)},n.createBuffer=function(s,d){return d=d||"raw",s!==void 0&&d==="utf8"&&(s=n.encodeUtf8(s)),new n.ByteBuffer(s)},n.fillString=function(s,d){for(var v="";d>0;)d&1&&(v+=s),d>>>=1,d>0&&(s+=s);return v},n.xorBytes=function(s,d,v){for(var I="",R="",h="",i=0,a=0;v>0;--v,++i)R=s.charCodeAt(i)^d.charCodeAt(i),a>=10&&(I+=h,h="",a=0),h+=String.fromCharCode(R),++a;return I+=h,I},n.hexToBytes=function(s){var d="",v=0;for(s.length&!0&&(v=1,d+=String.fromCharCode(parseInt(s[0],16)));v<s.length;v+=2)d+=String.fromCharCode(parseInt(s.substr(v,2),16));return d},n.bytesToHex=function(s){return n.createBuffer(s).toHex()},n.int32ToBytes=function(s){return String.fromCharCode(s>>24&255)+String.fromCharCode(s>>16&255)+String.fromCharCode(s>>8&255)+String.fromCharCode(s&255)};var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",y=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],f="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";n.encode64=function(s,d){for(var v="",I="",R,h,i,a=0;a<s.length;)R=s.charCodeAt(a++),h=s.charCodeAt(a++),i=s.charCodeAt(a++),v+=t.charAt(R>>2),v+=t.charAt((R&3)<<4|h>>4),isNaN(h)?v+="==":(v+=t.charAt((h&15)<<2|i>>6),v+=isNaN(i)?"=":t.charAt(i&63)),d&&v.length>d&&(I+=v.substr(0,d)+`\r
`,v=v.substr(d));return I+=v,I},n.decode64=function(s){s=s.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var d="",v,I,R,h,i=0;i<s.length;)v=y[s.charCodeAt(i++)-43],I=y[s.charCodeAt(i++)-43],R=y[s.charCodeAt(i++)-43],h=y[s.charCodeAt(i++)-43],d+=String.fromCharCode(v<<2|I>>4),R!==64&&(d+=String.fromCharCode((I&15)<<4|R>>2),h!==64&&(d+=String.fromCharCode((R&3)<<6|h)));return d},n.encodeUtf8=function(s){return unescape(encodeURIComponent(s))},n.decodeUtf8=function(s){return decodeURIComponent(escape(s))},n.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:e.encode,decode:e.decode}},n.binary.raw.encode=function(s){return String.fromCharCode.apply(null,s)},n.binary.raw.decode=function(s,d,v){var I=d;I||(I=new Uint8Array(s.length)),v=v||0;for(var R=v,h=0;h<s.length;++h)I[R++]=s.charCodeAt(h);return d?R-v:I},n.binary.hex.encode=n.bytesToHex,n.binary.hex.decode=function(s,d,v){var I=d;I||(I=new Uint8Array(Math.ceil(s.length/2))),v=v||0;var R=0,h=v;for(s.length&1&&(R=1,I[h++]=parseInt(s[0],16));R<s.length;R+=2)I[h++]=parseInt(s.substr(R,2),16);return d?h-v:I},n.binary.base64.encode=function(s,d){for(var v="",I="",R,h,i,a=0;a<s.byteLength;)R=s[a++],h=s[a++],i=s[a++],v+=t.charAt(R>>2),v+=t.charAt((R&3)<<4|h>>4),isNaN(h)?v+="==":(v+=t.charAt((h&15)<<2|i>>6),v+=isNaN(i)?"=":t.charAt(i&63)),d&&v.length>d&&(I+=v.substr(0,d)+`\r
`,v=v.substr(d));return I+=v,I},n.binary.base64.decode=function(s,d,v){var I=d;I||(I=new Uint8Array(Math.ceil(s.length/4)*3)),s=s.replace(/[^A-Za-z0-9\+\/\=]/g,""),v=v||0;for(var R,h,i,a,B=0,D=v;B<s.length;)R=y[s.charCodeAt(B++)-43],h=y[s.charCodeAt(B++)-43],i=y[s.charCodeAt(B++)-43],a=y[s.charCodeAt(B++)-43],I[D++]=R<<2|h>>4,i!==64&&(I[D++]=(h&15)<<4|i>>2,a!==64&&(I[D++]=(i&3)<<6|a));return d?D-v:I.subarray(0,D)},n.binary.base58.encode=function(s,d){return n.binary.baseN.encode(s,f,d)},n.binary.base58.decode=function(s,d){return n.binary.baseN.decode(s,f,d)},n.text={utf8:{},utf16:{}},n.text.utf8.encode=function(s,d,v){s=n.encodeUtf8(s);var I=d;I||(I=new Uint8Array(s.length)),v=v||0;for(var R=v,h=0;h<s.length;++h)I[R++]=s.charCodeAt(h);return d?R-v:I},n.text.utf8.decode=function(s){return n.decodeUtf8(String.fromCharCode.apply(null,s))},n.text.utf16.encode=function(s,d,v){var I=d;I||(I=new Uint8Array(s.length*2));var R=new Uint16Array(I.buffer);v=v||0;for(var h=v,i=v,a=0;a<s.length;++a)R[i++]=s.charCodeAt(a),h+=2;return d?h-v:I},n.text.utf16.decode=function(s){return String.fromCharCode.apply(null,new Uint16Array(s.buffer))},n.deflate=function(s,d,v){if(d=n.decode64(s.deflate(n.encode64(d)).rval),v){var I=2,R=d.charCodeAt(1);R&32&&(I=6),d=d.substring(I,d.length-4)}return d},n.inflate=function(s,d,v){var I=s.inflate(n.encode64(d)).rval;return I===null?null:n.decode64(I)};var S=function(s,d,v){if(!s)throw new Error("WebStorage not available.");var I;if(v===null?I=s.removeItem(d):(v=n.encode64(JSON.stringify(v)),I=s.setItem(d,v)),typeof I<"u"&&I.rval!==!0){var R=new Error(I.error.message);throw R.id=I.error.id,R.name=I.error.name,R}},k=function(s,d){if(!s)throw new Error("WebStorage not available.");var v=s.getItem(d);if(s.init)if(v.rval===null){if(v.error){var I=new Error(v.error.message);throw I.id=v.error.id,I.name=v.error.name,I}v=null}else v=v.rval;return v!==null&&(v=JSON.parse(n.decode64(v))),v},E=function(s,d,v,I){var R=k(s,d);R===null&&(R={}),R[v]=I,S(s,d,R)},u=function(s,d,v){var I=k(s,d);return I!==null&&(I=v in I?I[v]:null),I},g=function(s,d,v){var I=k(s,d);if(I!==null&&v in I){delete I[v];var R=!0;for(var h in I){R=!1;break}R&&(I=null),S(s,d,I)}},C=function(s,d){S(s,d,null)},m=function(s,d,v){var I=null;typeof v>"u"&&(v=["web","flash"]);var R,h=!1,i=null;for(var a in v){R=v[a];try{if(R==="flash"||R==="both"){if(d[0]===null)throw new Error("Flash local storage not available.");I=s.apply(this,d),h=R==="flash"}(R==="web"||R==="both")&&(d[0]=localStorage,I=s.apply(this,d),h=!0)}catch(B){i=B}if(h)break}if(!h)throw i;return I};return n.setItem=function(s,d,v,I,R){m(E,arguments,R)},n.getItem=function(s,d,v,I){return m(u,arguments,I)},n.removeItem=function(s,d,v,I){m(g,arguments,I)},n.clearItems=function(s,d,v){m(C,arguments,v)},n.isEmpty=function(s){for(var d in s)if(s.hasOwnProperty(d))return!1;return!0},n.format=function(s){for(var d=/%./g,v,I,R=0,h=[],i=0;v=d.exec(s);){I=s.substring(i,d.lastIndex-2),I.length>0&&h.push(I),i=d.lastIndex;var a=v[0][1];switch(a){case"s":case"o":R<arguments.length?h.push(arguments[R+++1]):h.push("<?>");break;case"%":h.push("%");break;default:h.push("<%"+a+"?>")}}return h.push(s.substring(i)),h.join("")},n.formatNumber=function(s,d,v,I){var R=s,h=isNaN(d=Math.abs(d))?2:d,i=v===void 0?",":v,a=I===void 0?".":I,B=R<0?"-":"",D=parseInt(R=Math.abs(+R||0).toFixed(h),10)+"",V=D.length>3?D.length%3:0;return B+(V?D.substr(0,V)+a:"")+D.substr(V).replace(/(\d{3})(?=\d)/g,"$1"+a)+(h?i+Math.abs(R-D).toFixed(h).slice(2):"")},n.formatSize=function(s){return s>=1073741824?s=n.formatNumber(s/1073741824,2,".","")+" GiB":s>=1048576?s=n.formatNumber(s/1048576,2,".","")+" MiB":s>=1024?s=n.formatNumber(s/1024,0)+" KiB":s=n.formatNumber(s,0)+" bytes",s},n.bytesFromIP=function(s){return s.indexOf(".")!==-1?n.bytesFromIPv4(s):s.indexOf(":")!==-1?n.bytesFromIPv6(s):null},n.bytesFromIPv4=function(s){if(s=s.split("."),s.length!==4)return null;for(var d=n.createBuffer(),v=0;v<s.length;++v){var I=parseInt(s[v],10);if(isNaN(I))return null;d.putByte(I)}return d.getBytes()},n.bytesFromIPv6=function(s){var d=0;s=s.split(":").filter(function(i){return i.length===0&&++d,!0});for(var v=(8-s.length+d)*2,I=n.createBuffer(),R=0;R<8;++R){if(!s[R]||s[R].length===0){I.fillWithByte(0,v),v=0;continue}var h=n.hexToBytes(s[R]);h.length<2&&I.putByte(0),I.putBytes(h)}return I.getBytes()},n.bytesToIP=function(s){return s.length===4?n.bytesToIPv4(s):s.length===16?n.bytesToIPv6(s):null},n.bytesToIPv4=function(s){if(s.length!==4)return null;for(var d=[],v=0;v<s.length;++v)d.push(s.charCodeAt(v));return d.join(".")},n.bytesToIPv6=function(s){if(s.length!==16)return null;for(var d=[],v=[],I=0,R=0;R<s.length;R+=2){for(var h=n.bytesToHex(s[R]+s[R+1]);h[0]==="0"&&h!=="0";)h=h.substr(1);if(h==="0"){var i=v[v.length-1],a=d.length;!i||a!==i.end+1?v.push({start:a,end:a}):(i.end=a,i.end-i.start>v[I].end-v[I].start&&(I=v.length-1))}d.push(h)}if(v.length>0){var B=v[I];B.end-B.start>0&&(d.splice(B.start,B.end-B.start+1,""),B.start===0&&d.unshift(""),B.end===7&&d.push(""))}return d.join(":")},n.estimateCores=function(s,d){if(typeof s=="function"&&(d=s,s={}),s=s||{},"cores"in n&&!s.update)return d(null,n.cores);if(typeof navigator<"u"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return n.cores=navigator.hardwareConcurrency,d(null,n.cores);if(typeof Worker>"u")return n.cores=1,d(null,n.cores);if(typeof Blob>"u")return n.cores=2,d(null,n.cores);var v=URL.createObjectURL(new Blob(["(",(function(){self.addEventListener("message",function(i){var a=Date.now(),B=a+4;self.postMessage({st:a,et:B})})}).toString(),")()"],{type:"application/javascript"}));I([],5,16);function I(i,a,B){if(a===0){var D=Math.floor(i.reduce(function(V,L){return V+L},0)/i.length);return n.cores=Math.max(1,D),URL.revokeObjectURL(v),d(null,n.cores)}R(B,function(V,L){i.push(h(B,L)),I(i,a-1,B)})}function R(i,a){for(var B=[],D=[],V=0;V<i;++V){var L=new Worker(v);L.addEventListener("message",function(O){if(D.push(O.data),D.length===i){for(var q=0;q<i;++q)B[q].terminate();a(null,D)}}),B.push(L)}for(var V=0;V<i;++V)B[V].postMessage(V)}function h(i,a){for(var B=[],D=0;D<i;++D)for(var V=a[D],L=B[D]=[],O=0;O<i;++O)if(D!==O){var q=a[O];(V.st>q.st&&V.st<q.et||q.st>V.st&&q.st<V.et)&&L.push(O)}return B.reduce(function(M,H){return Math.max(M,H.length)},0)}},Nt.exports}var wt,Ir;function Lt(){if(Ir)return wt;Ir=1;var r=ue();de(),wt=r.cipher=r.cipher||{},r.cipher.algorithms=r.cipher.algorithms||{},r.cipher.createCipher=function(n,p){var b=n;if(typeof b=="string"&&(b=r.cipher.getAlgorithm(b),b&&(b=b())),!b)throw new Error("Unsupported algorithm: "+n);return new r.cipher.BlockCipher({algorithm:b,key:p,decrypt:!1})},r.cipher.createDecipher=function(n,p){var b=n;if(typeof b=="string"&&(b=r.cipher.getAlgorithm(b),b&&(b=b())),!b)throw new Error("Unsupported algorithm: "+n);return new r.cipher.BlockCipher({algorithm:b,key:p,decrypt:!0})},r.cipher.registerAlgorithm=function(n,p){n=n.toUpperCase(),r.cipher.algorithms[n]=p},r.cipher.getAlgorithm=function(n){return n=n.toUpperCase(),n in r.cipher.algorithms?r.cipher.algorithms[n]:null};var e=r.cipher.BlockCipher=function(n){this.algorithm=n.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=n.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=n.decrypt,this.algorithm.initialize(n)};return e.prototype.start=function(n){n=n||{};var p={};for(var b in n)p[b]=n[b];p.decrypt=this._decrypt,this._finish=!1,this._input=r.util.createBuffer(),this.output=n.output||r.util.createBuffer(),this.mode.start(p)},e.prototype.update=function(n){for(n&&this._input.putBuffer(n);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()},e.prototype.finish=function(n){n&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(b){return n(this.blockSize,b,!1)},this.mode.unpad=function(b){return n(this.blockSize,b,!0)});var p={};return p.decrypt=this._decrypt,p.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,p)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,p))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,p))},wt}var kt={exports:{}},Ar;function Br(){if(Ar)return kt.exports;Ar=1;var r=ue();de(),r.cipher=r.cipher||{};var e=kt.exports=r.cipher.modes=r.cipher.modes||{};e.ecb=function(x){x=x||{},this.name="ECB",this.cipher=x.cipher,this.blockSize=x.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},e.ecb.prototype.start=function(x){},e.ecb.prototype.encrypt=function(x,c,t){if(x.length()<this.blockSize&&!(t&&x.length()>0))return!0;for(var y=0;y<this._ints;++y)this._inBlock[y]=x.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var y=0;y<this._ints;++y)c.putInt32(this._outBlock[y])},e.ecb.prototype.decrypt=function(x,c,t){if(x.length()<this.blockSize&&!(t&&x.length()>0))return!0;for(var y=0;y<this._ints;++y)this._inBlock[y]=x.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var y=0;y<this._ints;++y)c.putInt32(this._outBlock[y])},e.ecb.prototype.pad=function(x,c){var t=x.length()===this.blockSize?this.blockSize:this.blockSize-x.length();return x.fillWithByte(t,t),!0},e.ecb.prototype.unpad=function(x,c){if(c.overflow>0)return!1;var t=x.length(),y=x.at(t-1);return y>this.blockSize<<2?!1:(x.truncate(y),!0)},e.cbc=function(x){x=x||{},this.name="CBC",this.cipher=x.cipher,this.blockSize=x.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},e.cbc.prototype.start=function(x){if(x.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in x)this._iv=n(x.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")},e.cbc.prototype.encrypt=function(x,c,t){if(x.length()<this.blockSize&&!(t&&x.length()>0))return!0;for(var y=0;y<this._ints;++y)this._inBlock[y]=this._prev[y]^x.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var y=0;y<this._ints;++y)c.putInt32(this._outBlock[y]);this._prev=this._outBlock},e.cbc.prototype.decrypt=function(x,c,t){if(x.length()<this.blockSize&&!(t&&x.length()>0))return!0;for(var y=0;y<this._ints;++y)this._inBlock[y]=x.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var y=0;y<this._ints;++y)c.putInt32(this._prev[y]^this._outBlock[y]);this._prev=this._inBlock.slice(0)},e.cbc.prototype.pad=function(x,c){var t=x.length()===this.blockSize?this.blockSize:this.blockSize-x.length();return x.fillWithByte(t,t),!0},e.cbc.prototype.unpad=function(x,c){if(c.overflow>0)return!1;var t=x.length(),y=x.at(t-1);return y>this.blockSize<<2?!1:(x.truncate(y),!0)},e.cfb=function(x){x=x||{},this.name="CFB",this.cipher=x.cipher,this.blockSize=x.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=r.util.createBuffer(),this._partialBytes=0},e.cfb.prototype.start=function(x){if(!("iv"in x))throw new Error("Invalid IV parameter.");this._iv=n(x.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},e.cfb.prototype.encrypt=function(x,c,t){var y=x.length();if(y===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&y>=this.blockSize){for(var f=0;f<this._ints;++f)this._inBlock[f]=x.getInt32()^this._outBlock[f],c.putInt32(this._inBlock[f]);return}var S=(this.blockSize-y)%this.blockSize;S>0&&(S=this.blockSize-S),this._partialOutput.clear();for(var f=0;f<this._ints;++f)this._partialBlock[f]=x.getInt32()^this._outBlock[f],this._partialOutput.putInt32(this._partialBlock[f]);if(S>0)x.read-=this.blockSize;else for(var f=0;f<this._ints;++f)this._inBlock[f]=this._partialBlock[f];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),S>0&&!t)return c.putBytes(this._partialOutput.getBytes(S-this._partialBytes)),this._partialBytes=S,!0;c.putBytes(this._partialOutput.getBytes(y-this._partialBytes)),this._partialBytes=0},e.cfb.prototype.decrypt=function(x,c,t){var y=x.length();if(y===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&y>=this.blockSize){for(var f=0;f<this._ints;++f)this._inBlock[f]=x.getInt32(),c.putInt32(this._inBlock[f]^this._outBlock[f]);return}var S=(this.blockSize-y)%this.blockSize;S>0&&(S=this.blockSize-S),this._partialOutput.clear();for(var f=0;f<this._ints;++f)this._partialBlock[f]=x.getInt32(),this._partialOutput.putInt32(this._partialBlock[f]^this._outBlock[f]);if(S>0)x.read-=this.blockSize;else for(var f=0;f<this._ints;++f)this._inBlock[f]=this._partialBlock[f];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),S>0&&!t)return c.putBytes(this._partialOutput.getBytes(S-this._partialBytes)),this._partialBytes=S,!0;c.putBytes(this._partialOutput.getBytes(y-this._partialBytes)),this._partialBytes=0},e.ofb=function(x){x=x||{},this.name="OFB",this.cipher=x.cipher,this.blockSize=x.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=r.util.createBuffer(),this._partialBytes=0},e.ofb.prototype.start=function(x){if(!("iv"in x))throw new Error("Invalid IV parameter.");this._iv=n(x.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},e.ofb.prototype.encrypt=function(x,c,t){var y=x.length();if(x.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&y>=this.blockSize){for(var f=0;f<this._ints;++f)c.putInt32(x.getInt32()^this._outBlock[f]),this._inBlock[f]=this._outBlock[f];return}var S=(this.blockSize-y)%this.blockSize;S>0&&(S=this.blockSize-S),this._partialOutput.clear();for(var f=0;f<this._ints;++f)this._partialOutput.putInt32(x.getInt32()^this._outBlock[f]);if(S>0)x.read-=this.blockSize;else for(var f=0;f<this._ints;++f)this._inBlock[f]=this._outBlock[f];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),S>0&&!t)return c.putBytes(this._partialOutput.getBytes(S-this._partialBytes)),this._partialBytes=S,!0;c.putBytes(this._partialOutput.getBytes(y-this._partialBytes)),this._partialBytes=0},e.ofb.prototype.decrypt=e.ofb.prototype.encrypt,e.ctr=function(x){x=x||{},this.name="CTR",this.cipher=x.cipher,this.blockSize=x.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=r.util.createBuffer(),this._partialBytes=0},e.ctr.prototype.start=function(x){if(!("iv"in x))throw new Error("Invalid IV parameter.");this._iv=n(x.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},e.ctr.prototype.encrypt=function(x,c,t){var y=x.length();if(y===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&y>=this.blockSize)for(var f=0;f<this._ints;++f)c.putInt32(x.getInt32()^this._outBlock[f]);else{var S=(this.blockSize-y)%this.blockSize;S>0&&(S=this.blockSize-S),this._partialOutput.clear();for(var f=0;f<this._ints;++f)this._partialOutput.putInt32(x.getInt32()^this._outBlock[f]);if(S>0&&(x.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),S>0&&!t)return c.putBytes(this._partialOutput.getBytes(S-this._partialBytes)),this._partialBytes=S,!0;c.putBytes(this._partialOutput.getBytes(y-this._partialBytes)),this._partialBytes=0}p(this._inBlock)},e.ctr.prototype.decrypt=e.ctr.prototype.encrypt,e.gcm=function(x){x=x||{},this.name="GCM",this.cipher=x.cipher,this.blockSize=x.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=r.util.createBuffer(),this._partialBytes=0,this._R=3774873600},e.gcm.prototype.start=function(x){if(!("iv"in x))throw new Error("Invalid IV parameter.");var c=r.util.createBuffer(x.iv);this._cipherLength=0;var t;if("additionalData"in x?t=r.util.createBuffer(x.additionalData):t=r.util.createBuffer(),"tagLength"in x?this._tagLength=x.tagLength:this._tagLength=128,this._tag=null,x.decrypt&&(this._tag=r.util.createBuffer(x.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var y=c.length();if(y===12)this._j0=[c.getInt32(),c.getInt32(),c.getInt32(),1];else{for(this._j0=[0,0,0,0];c.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[c.getInt32(),c.getInt32(),c.getInt32(),c.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(b(y*8)))}this._inBlock=this._j0.slice(0),p(this._inBlock),this._partialBytes=0,t=r.util.createBuffer(t),this._aDataLength=b(t.length()*8);var f=t.length()%this.blockSize;for(f&&t.fillWithByte(0,this.blockSize-f),this._s=[0,0,0,0];t.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[t.getInt32(),t.getInt32(),t.getInt32(),t.getInt32()])},e.gcm.prototype.encrypt=function(x,c,t){var y=x.length();if(y===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&y>=this.blockSize){for(var f=0;f<this._ints;++f)c.putInt32(this._outBlock[f]^=x.getInt32());this._cipherLength+=this.blockSize}else{var S=(this.blockSize-y)%this.blockSize;S>0&&(S=this.blockSize-S),this._partialOutput.clear();for(var f=0;f<this._ints;++f)this._partialOutput.putInt32(x.getInt32()^this._outBlock[f]);if(S<=0||t){if(t){var k=y%this.blockSize;this._cipherLength+=k,this._partialOutput.truncate(this.blockSize-k)}else this._cipherLength+=this.blockSize;for(var f=0;f<this._ints;++f)this._outBlock[f]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),S>0&&!t)return x.read-=this.blockSize,c.putBytes(this._partialOutput.getBytes(S-this._partialBytes)),this._partialBytes=S,!0;c.putBytes(this._partialOutput.getBytes(y-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),p(this._inBlock)},e.gcm.prototype.decrypt=function(x,c,t){var y=x.length();if(y<this.blockSize&&!(t&&y>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),p(this._inBlock),this._hashBlock[0]=x.getInt32(),this._hashBlock[1]=x.getInt32(),this._hashBlock[2]=x.getInt32(),this._hashBlock[3]=x.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var f=0;f<this._ints;++f)c.putInt32(this._outBlock[f]^this._hashBlock[f]);y<this.blockSize?this._cipherLength+=y%this.blockSize:this._cipherLength+=this.blockSize},e.gcm.prototype.afterFinish=function(x,c){var t=!0;c.decrypt&&c.overflow&&x.truncate(this.blockSize-c.overflow),this.tag=r.util.createBuffer();var y=this._aDataLength.concat(b(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,y);var f=[];this.cipher.encrypt(this._j0,f);for(var S=0;S<this._ints;++S)this.tag.putInt32(this._s[S]^f[S]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),c.decrypt&&this.tag.bytes()!==this._tag&&(t=!1),t},e.gcm.prototype.multiply=function(x,c){for(var t=[0,0,0,0],y=c.slice(0),f=0;f<128;++f){var S=x[f/32|0]&1<<31-f%32;S&&(t[0]^=y[0],t[1]^=y[1],t[2]^=y[2],t[3]^=y[3]),this.pow(y,y)}return t},e.gcm.prototype.pow=function(x,c){for(var t=x[3]&1,y=3;y>0;--y)c[y]=x[y]>>>1|(x[y-1]&1)<<31;c[0]=x[0]>>>1,t&&(c[0]^=this._R)},e.gcm.prototype.tableMultiply=function(x){for(var c=[0,0,0,0],t=0;t<32;++t){var y=t/8|0,f=x[y]>>>(7-t%8)*4&15,S=this._m[t][f];c[0]^=S[0],c[1]^=S[1],c[2]^=S[2],c[3]^=S[3]}return c},e.gcm.prototype.ghash=function(x,c,t){return c[0]^=t[0],c[1]^=t[1],c[2]^=t[2],c[3]^=t[3],this.tableMultiply(c)},e.gcm.prototype.generateHashTable=function(x,c){for(var t=8/c,y=4*t,f=16*t,S=new Array(f),k=0;k<f;++k){var E=[0,0,0,0],u=k/y|0,g=(y-1-k%y)*c;E[u]=1<<c-1<<g,S[k]=this.generateSubHashTable(this.multiply(E,x),c)}return S},e.gcm.prototype.generateSubHashTable=function(x,c){var t=1<<c,y=t>>>1,f=new Array(t);f[y]=x.slice(0);for(var S=y>>>1;S>0;)this.pow(f[2*S],f[S]=[]),S>>=1;for(S=2;S<y;){for(var k=1;k<S;++k){var E=f[S],u=f[k];f[S+k]=[E[0]^u[0],E[1]^u[1],E[2]^u[2],E[3]^u[3]]}S*=2}for(f[0]=[0,0,0,0],S=y+1;S<t;++S){var g=f[S^y];f[S]=[x[0]^g[0],x[1]^g[1],x[2]^g[2],x[3]^g[3]]}return f};function n(x,c){if(typeof x=="string"&&(x=r.util.createBuffer(x)),r.util.isArray(x)&&x.length>4){var t=x;x=r.util.createBuffer();for(var y=0;y<t.length;++y)x.putByte(t[y])}if(x.length()<c)throw new Error("Invalid IV length; got "+x.length()+" bytes and expected "+c+" bytes.");if(!r.util.isArray(x)){for(var f=[],S=c/4,y=0;y<S;++y)f.push(x.getInt32());x=f}return x}function p(x){x[x.length-1]=x[x.length-1]+1&4294967295}function b(x){return[x/4294967296|0,x&4294967295]}return kt.exports}var Dt,br;function ot(){if(br)return Dt;br=1;var r=ue();Lt(),Br(),de(),Dt=r.aes=r.aes||{},r.aes.startEncrypting=function(u,g,C,m){var s=E({key:u,output:C,decrypt:!1,mode:m});return s.start(g),s},r.aes.createEncryptionCipher=function(u,g){return E({key:u,output:null,decrypt:!1,mode:g})},r.aes.startDecrypting=function(u,g,C,m){var s=E({key:u,output:C,decrypt:!0,mode:m});return s.start(g),s},r.aes.createDecryptionCipher=function(u,g){return E({key:u,output:null,decrypt:!0,mode:g})},r.aes.Algorithm=function(u,g){n||f();var C=this;C.name=u,C.mode=new g({blockSize:16,cipher:{encrypt:function(m,s){return k(C._w,m,s,!1)},decrypt:function(m,s){return k(C._w,m,s,!0)}}}),C._init=!1},r.aes.Algorithm.prototype.initialize=function(u){if(!this._init){var g=u.key,C;if(typeof g=="string"&&(g.length===16||g.length===24||g.length===32))g=r.util.createBuffer(g);else if(r.util.isArray(g)&&(g.length===16||g.length===24||g.length===32)){C=g,g=r.util.createBuffer();for(var m=0;m<C.length;++m)g.putByte(C[m])}if(!r.util.isArray(g)){C=g,g=[];var s=C.length();if(s===16||s===24||s===32){s=s>>>2;for(var m=0;m<s;++m)g.push(C.getInt32())}}if(!r.util.isArray(g)||!(g.length===4||g.length===6||g.length===8))throw new Error("Invalid key parameter.");var d=this.mode.name,v=["CFB","OFB","CTR","GCM"].indexOf(d)!==-1;this._w=S(g,u.decrypt&&!v),this._init=!0}},r.aes._expandKey=function(u,g){return n||f(),S(u,g)},r.aes._updateBlock=k,e("AES-ECB",r.cipher.modes.ecb),e("AES-CBC",r.cipher.modes.cbc),e("AES-CFB",r.cipher.modes.cfb),e("AES-OFB",r.cipher.modes.ofb),e("AES-CTR",r.cipher.modes.ctr),e("AES-GCM",r.cipher.modes.gcm);function e(u,g){var C=function(){return new r.aes.Algorithm(u,g)};r.cipher.registerAlgorithm(u,C)}var n=!1,p=4,b,x,c,t,y;function f(){n=!0,c=[0,1,2,4,8,16,32,64,128,27,54];for(var u=new Array(256),g=0;g<128;++g)u[g]=g<<1,u[g+128]=g+128<<1^283;b=new Array(256),x=new Array(256),t=new Array(4),y=new Array(4);for(var g=0;g<4;++g)t[g]=new Array(256),y[g]=new Array(256);for(var C=0,m=0,s,d,v,I,R,h,i,g=0;g<256;++g){I=m^m<<1^m<<2^m<<3^m<<4,I=I>>8^I&255^99,b[C]=I,x[I]=C,R=u[I],s=u[C],d=u[s],v=u[d],h=R<<24^I<<16^I<<8^(I^R),i=(s^d^v)<<24^(C^v)<<16^(C^d^v)<<8^(C^s^v);for(var a=0;a<4;++a)t[a][C]=h,y[a][I]=i,h=h<<24|h>>>8,i=i<<24|i>>>8;C===0?C=m=1:(C=s^u[u[u[s^v]]],m^=u[u[m]])}}function S(u,g){for(var C=u.slice(0),m,s=1,d=C.length,v=d+6+1,I=p*v,R=d;R<I;++R)m=C[R-1],R%d===0?(m=b[m>>>16&255]<<24^b[m>>>8&255]<<16^b[m&255]<<8^b[m>>>24]^c[s]<<24,s++):d>6&&R%d===4&&(m=b[m>>>24]<<24^b[m>>>16&255]<<16^b[m>>>8&255]<<8^b[m&255]),C[R]=C[R-d]^m;if(g){var h,i=y[0],a=y[1],B=y[2],D=y[3],V=C.slice(0);I=C.length;for(var R=0,L=I-p;R<I;R+=p,L-=p)if(R===0||R===I-p)V[R]=C[L],V[R+1]=C[L+3],V[R+2]=C[L+2],V[R+3]=C[L+1];else for(var O=0;O<p;++O)h=C[L+O],V[R+(3&-O)]=i[b[h>>>24]]^a[b[h>>>16&255]]^B[b[h>>>8&255]]^D[b[h&255]];C=V}return C}function k(u,g,C,m){var s=u.length/4-1,d,v,I,R,h;m?(d=y[0],v=y[1],I=y[2],R=y[3],h=x):(d=t[0],v=t[1],I=t[2],R=t[3],h=b);var i,a,B,D,V,L,O;i=g[0]^u[0],a=g[m?3:1]^u[1],B=g[2]^u[2],D=g[m?1:3]^u[3];for(var q=3,M=1;M<s;++M)V=d[i>>>24]^v[a>>>16&255]^I[B>>>8&255]^R[D&255]^u[++q],L=d[a>>>24]^v[B>>>16&255]^I[D>>>8&255]^R[i&255]^u[++q],O=d[B>>>24]^v[D>>>16&255]^I[i>>>8&255]^R[a&255]^u[++q],D=d[D>>>24]^v[i>>>16&255]^I[a>>>8&255]^R[B&255]^u[++q],i=V,a=L,B=O;C[0]=h[i>>>24]<<24^h[a>>>16&255]<<16^h[B>>>8&255]<<8^h[D&255]^u[++q],C[m?3:1]=h[a>>>24]<<24^h[B>>>16&255]<<16^h[D>>>8&255]<<8^h[i&255]^u[++q],C[2]=h[B>>>24]<<24^h[D>>>16&255]<<16^h[i>>>8&255]<<8^h[a&255]^u[++q],C[m?1:3]=h[D>>>24]<<24^h[i>>>16&255]<<16^h[a>>>8&255]<<8^h[B&255]^u[++q]}function E(u){u=u||{};var g=(u.mode||"CBC").toUpperCase(),C="AES-"+g,m;u.decrypt?m=r.cipher.createDecipher(C,u.key):m=r.cipher.createCipher(C,u.key);var s=m.start;return m.start=function(d,v){var I=null;v instanceof r.util.ByteBuffer&&(I=v,v={}),v=v||{},v.output=I,v.iv=d,s.call(m,v)},m}return Dt}var Ut={exports:{}},Pt={exports:{}},Vt={exports:{}},_r;function ut(){if(_r)return Vt.exports;_r=1;var r=ue();r.pki=r.pki||{};var e=Vt.exports=r.pki.oids=r.oids=r.oids||{};function n(b,x){e[b]=x,e[x]=b}function p(b,x){e[b]=x}return n("1.2.840.113549.1.1.1","rsaEncryption"),n("1.2.840.113549.1.1.4","md5WithRSAEncryption"),n("1.2.840.113549.1.1.5","sha1WithRSAEncryption"),n("1.2.840.113549.1.1.7","RSAES-OAEP"),n("1.2.840.113549.1.1.8","mgf1"),n("1.2.840.113549.1.1.9","pSpecified"),n("1.2.840.113549.1.1.10","RSASSA-PSS"),n("1.2.840.113549.1.1.11","sha256WithRSAEncryption"),n("1.2.840.113549.1.1.12","sha384WithRSAEncryption"),n("1.2.840.113549.1.1.13","sha512WithRSAEncryption"),n("1.3.101.112","EdDSA25519"),n("1.2.840.10040.4.3","dsa-with-sha1"),n("1.3.14.3.2.7","desCBC"),n("1.3.14.3.2.26","sha1"),n("1.3.14.3.2.29","sha1WithRSASignature"),n("2.16.840.1.101.3.4.2.1","sha256"),n("2.16.840.1.101.3.4.2.2","sha384"),n("2.16.840.1.101.3.4.2.3","sha512"),n("2.16.840.1.101.3.4.2.4","sha224"),n("2.16.840.1.101.3.4.2.5","sha512-224"),n("2.16.840.1.101.3.4.2.6","sha512-256"),n("1.2.840.113549.2.2","md2"),n("1.2.840.113549.2.5","md5"),n("1.2.840.113549.1.7.1","data"),n("1.2.840.113549.1.7.2","signedData"),n("1.2.840.113549.1.7.3","envelopedData"),n("1.2.840.113549.1.7.4","signedAndEnvelopedData"),n("1.2.840.113549.1.7.5","digestedData"),n("1.2.840.113549.1.7.6","encryptedData"),n("1.2.840.113549.1.9.1","emailAddress"),n("1.2.840.113549.1.9.2","unstructuredName"),n("1.2.840.113549.1.9.3","contentType"),n("1.2.840.113549.1.9.4","messageDigest"),n("1.2.840.113549.1.9.5","signingTime"),n("1.2.840.113549.1.9.6","counterSignature"),n("1.2.840.113549.1.9.7","challengePassword"),n("1.2.840.113549.1.9.8","unstructuredAddress"),n("1.2.840.113549.1.9.14","extensionRequest"),n("1.2.840.113549.1.9.20","friendlyName"),n("1.2.840.113549.1.9.21","localKeyId"),n("1.2.840.113549.1.9.22.1","x509Certificate"),n("1.2.840.113549.1.12.10.1.1","keyBag"),n("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag"),n("1.2.840.113549.1.12.10.1.3","certBag"),n("1.2.840.113549.1.12.10.1.4","crlBag"),n("1.2.840.113549.1.12.10.1.5","secretBag"),n("1.2.840.113549.1.12.10.1.6","safeContentsBag"),n("1.2.840.113549.1.5.13","pkcs5PBES2"),n("1.2.840.113549.1.5.12","pkcs5PBKDF2"),n("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4"),n("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4"),n("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC"),n("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC"),n("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC"),n("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC"),n("1.2.840.113549.2.7","hmacWithSHA1"),n("1.2.840.113549.2.8","hmacWithSHA224"),n("1.2.840.113549.2.9","hmacWithSHA256"),n("1.2.840.113549.2.10","hmacWithSHA384"),n("1.2.840.113549.2.11","hmacWithSHA512"),n("1.2.840.113549.3.7","des-EDE3-CBC"),n("2.16.840.1.101.3.4.1.2","aes128-CBC"),n("2.16.840.1.101.3.4.1.22","aes192-CBC"),n("2.16.840.1.101.3.4.1.42","aes256-CBC"),n("2.5.4.3","commonName"),n("2.5.4.4","surname"),n("2.5.4.5","serialNumber"),n("2.5.4.6","countryName"),n("2.5.4.7","localityName"),n("2.5.4.8","stateOrProvinceName"),n("2.5.4.9","streetAddress"),n("2.5.4.10","organizationName"),n("2.5.4.11","organizationalUnitName"),n("2.5.4.12","title"),n("2.5.4.13","description"),n("2.5.4.15","businessCategory"),n("2.5.4.17","postalCode"),n("2.5.4.42","givenName"),n("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName"),n("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName"),n("2.16.840.1.113730.1.1","nsCertType"),n("2.16.840.1.113730.1.13","nsComment"),p("2.5.29.1","authorityKeyIdentifier"),p("2.5.29.2","keyAttributes"),p("2.5.29.3","certificatePolicies"),p("2.5.29.4","keyUsageRestriction"),p("2.5.29.5","policyMapping"),p("2.5.29.6","subtreesConstraint"),p("2.5.29.7","subjectAltName"),p("2.5.29.8","issuerAltName"),p("2.5.29.9","subjectDirectoryAttributes"),p("2.5.29.10","basicConstraints"),p("2.5.29.11","nameConstraints"),p("2.5.29.12","policyConstraints"),p("2.5.29.13","basicConstraints"),n("2.5.29.14","subjectKeyIdentifier"),n("2.5.29.15","keyUsage"),p("2.5.29.16","privateKeyUsagePeriod"),n("2.5.29.17","subjectAltName"),n("2.5.29.18","issuerAltName"),n("2.5.29.19","basicConstraints"),p("2.5.29.20","cRLNumber"),p("2.5.29.21","cRLReason"),p("2.5.29.22","expirationDate"),p("2.5.29.23","instructionCode"),p("2.5.29.24","invalidityDate"),p("2.5.29.25","cRLDistributionPoints"),p("2.5.29.26","issuingDistributionPoint"),p("2.5.29.27","deltaCRLIndicator"),p("2.5.29.28","issuingDistributionPoint"),p("2.5.29.29","certificateIssuer"),p("2.5.29.30","nameConstraints"),n("2.5.29.31","cRLDistributionPoints"),n("2.5.29.32","certificatePolicies"),p("2.5.29.33","policyMappings"),p("2.5.29.34","policyConstraints"),n("2.5.29.35","authorityKeyIdentifier"),p("2.5.29.36","policyConstraints"),n("2.5.29.37","extKeyUsage"),p("2.5.29.46","freshestCRL"),p("2.5.29.54","inhibitAnyPolicy"),n("1.3.6.1.4.1.11129.2.4.2","timestampList"),n("1.3.6.1.5.5.7.1.1","authorityInfoAccess"),n("1.3.6.1.5.5.7.3.1","serverAuth"),n("1.3.6.1.5.5.7.3.2","clientAuth"),n("1.3.6.1.5.5.7.3.3","codeSigning"),n("1.3.6.1.5.5.7.3.4","emailProtection"),n("1.3.6.1.5.5.7.3.8","timeStamping"),Vt.exports}var Nr;function et(){if(Nr)return Pt.exports;Nr=1;var r=ue();de(),ut();var e=Pt.exports=r.asn1=r.asn1||{};e.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192},e.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30},e.create=function(c,t,y,f,S){if(r.util.isArray(f)){for(var k=[],E=0;E<f.length;++E)f[E]!==void 0&&k.push(f[E]);f=k}var u={tagClass:c,type:t,constructed:y,composed:y||r.util.isArray(f),value:f};return S&&"bitStringContents"in S&&(u.bitStringContents=S.bitStringContents,u.original=e.copy(u)),u},e.copy=function(c,t){var y;if(r.util.isArray(c)){y=[];for(var f=0;f<c.length;++f)y.push(e.copy(c[f],t));return y}return typeof c=="string"?c:(y={tagClass:c.tagClass,type:c.type,constructed:c.constructed,composed:c.composed,value:e.copy(c.value,t)},t&&!t.excludeBitStringContents&&(y.bitStringContents=c.bitStringContents),y)},e.equals=function(c,t,y){if(r.util.isArray(c)){if(!r.util.isArray(t)||c.length!==t.length)return!1;for(var f=0;f<c.length;++f)if(!e.equals(c[f],t[f]))return!1;return!0}if(typeof c!=typeof t)return!1;if(typeof c=="string")return c===t;var S=c.tagClass===t.tagClass&&c.type===t.type&&c.constructed===t.constructed&&c.composed===t.composed&&e.equals(c.value,t.value);return y&&y.includeBitStringContents&&(S=S&&c.bitStringContents===t.bitStringContents),S},e.getBerValueLength=function(c){var t=c.getByte();if(t!==128){var y,f=t&128;return f?y=c.getInt((t&127)<<3):y=t,y}};function n(c,t,y){if(y>t){var f=new Error("Too few bytes to parse DER.");throw f.available=c.length(),f.remaining=t,f.requested=y,f}}var p=function(c,t){var y=c.getByte();if(t--,y!==128){var f,S=y&128;if(!S)f=y;else{var k=y&127;n(c,t,k),f=c.getInt(k<<3)}if(f<0)throw new Error("Negative length: "+f);return f}};e.fromDer=function(c,t){t===void 0&&(t={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),typeof t=="boolean"&&(t={strict:t,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in t||(t.strict=!0),"parseAllBytes"in t||(t.parseAllBytes=!0),"decodeBitStrings"in t||(t.decodeBitStrings=!0),typeof c=="string"&&(c=r.util.createBuffer(c));var y=c.length(),f=b(c,c.length(),0,t);if(t.parseAllBytes&&c.length()!==0){var S=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw S.byteCount=y,S.remaining=c.length(),S}return f};function b(c,t,y,f){var S;n(c,t,2);var k=c.getByte();t--;var E=k&192,u=k&31;S=c.length();var g=p(c,t);if(t-=S-c.length(),g!==void 0&&g>t){if(f.strict){var C=new Error("Too few bytes to read ASN.1 value.");throw C.available=c.length(),C.remaining=t,C.requested=g,C}g=t}var m,s,d=(k&32)===32;if(d)if(m=[],g===void 0)for(;;){if(n(c,t,2),c.bytes(2)==="\0\0"){c.getBytes(2),t-=2;break}S=c.length(),m.push(b(c,t,y+1,f)),t-=S-c.length()}else for(;g>0;)S=c.length(),m.push(b(c,g,y+1,f)),t-=S-c.length(),g-=S-c.length();if(m===void 0&&E===e.Class.UNIVERSAL&&u===e.Type.BITSTRING&&(s=c.bytes(g)),m===void 0&&f.decodeBitStrings&&E===e.Class.UNIVERSAL&&u===e.Type.BITSTRING&&g>1){var v=c.read,I=t,R=0;if(u===e.Type.BITSTRING&&(n(c,t,1),R=c.getByte(),t--),R===0)try{S=c.length();var h={strict:!0,decodeBitStrings:!0},i=b(c,t,y+1,h),a=S-c.length();t-=a,u==e.Type.BITSTRING&&a++;var B=i.tagClass;a===g&&(B===e.Class.UNIVERSAL||B===e.Class.CONTEXT_SPECIFIC)&&(m=[i])}catch{}m===void 0&&(c.read=v,t=I)}if(m===void 0){if(g===void 0){if(f.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");g=t}if(u===e.Type.BMPSTRING)for(m="";g>0;g-=2)n(c,t,2),m+=String.fromCharCode(c.getInt16()),t-=2;else m=c.getBytes(g),t-=g}var D=s===void 0?null:{bitStringContents:s};return e.create(E,u,d,m,D)}e.toDer=function(c){var t=r.util.createBuffer(),y=c.tagClass|c.type,f=r.util.createBuffer(),S=!1;if("bitStringContents"in c&&(S=!0,c.original&&(S=e.equals(c,c.original))),S)f.putBytes(c.bitStringContents);else if(c.composed){c.constructed?y|=32:f.putByte(0);for(var k=0;k<c.value.length;++k)c.value[k]!==void 0&&f.putBuffer(e.toDer(c.value[k]))}else if(c.type===e.Type.BMPSTRING)for(var k=0;k<c.value.length;++k)f.putInt16(c.value.charCodeAt(k));else c.type===e.Type.INTEGER&&c.value.length>1&&(c.value.charCodeAt(0)===0&&(c.value.charCodeAt(1)&128)===0||c.value.charCodeAt(0)===255&&(c.value.charCodeAt(1)&128)===128)?f.putBytes(c.value.substr(1)):f.putBytes(c.value);if(t.putByte(y),f.length()<=127)t.putByte(f.length()&127);else{var E=f.length(),u="";do u+=String.fromCharCode(E&255),E=E>>>8;while(E>0);t.putByte(u.length|128);for(var k=u.length-1;k>=0;--k)t.putByte(u.charCodeAt(k))}return t.putBuffer(f),t},e.oidToDer=function(c){var t=c.split("."),y=r.util.createBuffer();y.putByte(40*parseInt(t[0],10)+parseInt(t[1],10));for(var f,S,k,E,u=2;u<t.length;++u){f=!0,S=[],k=parseInt(t[u],10);do E=k&127,k=k>>>7,f||(E|=128),S.push(E),f=!1;while(k>0);for(var g=S.length-1;g>=0;--g)y.putByte(S[g])}return y},e.derToOid=function(c){var t;typeof c=="string"&&(c=r.util.createBuffer(c));var y=c.getByte();t=Math.floor(y/40)+"."+y%40;for(var f=0;c.length()>0;)y=c.getByte(),f=f<<7,y&128?f+=y&127:(t+="."+(f+y),f=0);return t},e.utcTimeToDate=function(c){var t=new Date,y=parseInt(c.substr(0,2),10);y=y>=50?1900+y:2e3+y;var f=parseInt(c.substr(2,2),10)-1,S=parseInt(c.substr(4,2),10),k=parseInt(c.substr(6,2),10),E=parseInt(c.substr(8,2),10),u=0;if(c.length>11){var g=c.charAt(10),C=10;g!=="+"&&g!=="-"&&(u=parseInt(c.substr(10,2),10),C+=2)}if(t.setUTCFullYear(y,f,S),t.setUTCHours(k,E,u,0),C&&(g=c.charAt(C),g==="+"||g==="-")){var m=parseInt(c.substr(C+1,2),10),s=parseInt(c.substr(C+4,2),10),d=m*60+s;d*=6e4,g==="+"?t.setTime(+t-d):t.setTime(+t+d)}return t},e.generalizedTimeToDate=function(c){var t=new Date,y=parseInt(c.substr(0,4),10),f=parseInt(c.substr(4,2),10)-1,S=parseInt(c.substr(6,2),10),k=parseInt(c.substr(8,2),10),E=parseInt(c.substr(10,2),10),u=parseInt(c.substr(12,2),10),g=0,C=0,m=!1;c.charAt(c.length-1)==="Z"&&(m=!0);var s=c.length-5,d=c.charAt(s);if(d==="+"||d==="-"){var v=parseInt(c.substr(s+1,2),10),I=parseInt(c.substr(s+4,2),10);C=v*60+I,C*=6e4,d==="+"&&(C*=-1),m=!0}return c.charAt(14)==="."&&(g=parseFloat(c.substr(14),10)*1e3),m?(t.setUTCFullYear(y,f,S),t.setUTCHours(k,E,u,g),t.setTime(+t+C)):(t.setFullYear(y,f,S),t.setHours(k,E,u,g)),t},e.dateToUtcTime=function(c){if(typeof c=="string")return c;var t="",y=[];y.push((""+c.getUTCFullYear()).substr(2)),y.push(""+(c.getUTCMonth()+1)),y.push(""+c.getUTCDate()),y.push(""+c.getUTCHours()),y.push(""+c.getUTCMinutes()),y.push(""+c.getUTCSeconds());for(var f=0;f<y.length;++f)y[f].length<2&&(t+="0"),t+=y[f];return t+="Z",t},e.dateToGeneralizedTime=function(c){if(typeof c=="string")return c;var t="",y=[];y.push(""+c.getUTCFullYear()),y.push(""+(c.getUTCMonth()+1)),y.push(""+c.getUTCDate()),y.push(""+c.getUTCHours()),y.push(""+c.getUTCMinutes()),y.push(""+c.getUTCSeconds());for(var f=0;f<y.length;++f)y[f].length<2&&(t+="0"),t+=y[f];return t+="Z",t},e.integerToDer=function(c){var t=r.util.createBuffer();if(c>=-128&&c<128)return t.putSignedInt(c,8);if(c>=-32768&&c<32768)return t.putSignedInt(c,16);if(c>=-8388608&&c<8388608)return t.putSignedInt(c,24);if(c>=-2147483648&&c<2147483648)return t.putSignedInt(c,32);var y=new Error("Integer too large; max is 32-bits.");throw y.integer=c,y},e.derToInteger=function(c){typeof c=="string"&&(c=r.util.createBuffer(c));var t=c.length()*8;if(t>32)throw new Error("Integer too large; max is 32-bits.");return c.getSignedInt(t)},e.validate=function(c,t,y,f){var S=!1;if((c.tagClass===t.tagClass||typeof t.tagClass>"u")&&(c.type===t.type||typeof t.type>"u"))if(c.constructed===t.constructed||typeof t.constructed>"u"){if(S=!0,t.value&&r.util.isArray(t.value))for(var k=0,E=0;S&&E<t.value.length;++E)S=t.value[E].optional||!1,c.value[k]&&(S=e.validate(c.value[k],t.value[E],y,f),S?++k:t.value[E].optional&&(S=!0)),!S&&f&&f.push("["+t.name+'] Tag class "'+t.tagClass+'", type "'+t.type+'" expected value length "'+t.value.length+'", got "'+c.value.length+'"');if(S&&y&&(t.capture&&(y[t.capture]=c.value),t.captureAsn1&&(y[t.captureAsn1]=c),t.captureBitStringContents&&"bitStringContents"in c&&(y[t.captureBitStringContents]=c.bitStringContents),t.captureBitStringValue&&"bitStringContents"in c))if(c.bitStringContents.length<2)y[t.captureBitStringValue]="";else{var u=c.bitStringContents.charCodeAt(0);if(u!==0)throw new Error("captureBitStringValue only supported for zero unused bits");y[t.captureBitStringValue]=c.bitStringContents.slice(1)}}else f&&f.push("["+t.name+'] Expected constructed "'+t.constructed+'", got "'+c.constructed+'"');else f&&(c.tagClass!==t.tagClass&&f.push("["+t.name+'] Expected tag class "'+t.tagClass+'", got "'+c.tagClass+'"'),c.type!==t.type&&f.push("["+t.name+'] Expected type "'+t.type+'", got "'+c.type+'"'));return S};var x=/[^\\u0000-\\u00ff]/;return e.prettyPrint=function(c,t,y){var f="";t=t||0,y=y||2,t>0&&(f+=`
`);for(var S="",k=0;k<t*y;++k)S+=" ";switch(f+=S+"Tag: ",c.tagClass){case e.Class.UNIVERSAL:f+="Universal:";break;case e.Class.APPLICATION:f+="Application:";break;case e.Class.CONTEXT_SPECIFIC:f+="Context-Specific:";break;case e.Class.PRIVATE:f+="Private:";break}if(c.tagClass===e.Class.UNIVERSAL)switch(f+=c.type,c.type){case e.Type.NONE:f+=" (None)";break;case e.Type.BOOLEAN:f+=" (Boolean)";break;case e.Type.INTEGER:f+=" (Integer)";break;case e.Type.BITSTRING:f+=" (Bit string)";break;case e.Type.OCTETSTRING:f+=" (Octet string)";break;case e.Type.NULL:f+=" (Null)";break;case e.Type.OID:f+=" (Object Identifier)";break;case e.Type.ODESC:f+=" (Object Descriptor)";break;case e.Type.EXTERNAL:f+=" (External or Instance of)";break;case e.Type.REAL:f+=" (Real)";break;case e.Type.ENUMERATED:f+=" (Enumerated)";break;case e.Type.EMBEDDED:f+=" (Embedded PDV)";break;case e.Type.UTF8:f+=" (UTF8)";break;case e.Type.ROID:f+=" (Relative Object Identifier)";break;case e.Type.SEQUENCE:f+=" (Sequence)";break;case e.Type.SET:f+=" (Set)";break;case e.Type.PRINTABLESTRING:f+=" (Printable String)";break;case e.Type.IA5String:f+=" (IA5String (ASCII))";break;case e.Type.UTCTIME:f+=" (UTC time)";break;case e.Type.GENERALIZEDTIME:f+=" (Generalized time)";break;case e.Type.BMPSTRING:f+=" (BMP String)";break}else f+=c.type;if(f+=`
`,f+=S+"Constructed: "+c.constructed+`
`,c.composed){for(var E=0,u="",k=0;k<c.value.length;++k)c.value[k]!==void 0&&(E+=1,u+=e.prettyPrint(c.value[k],t+1,y),k+1<c.value.length&&(u+=","));f+=S+"Sub values: "+E+u}else{if(f+=S+"Value: ",c.type===e.Type.OID){var g=e.derToOid(c.value);f+=g,r.pki&&r.pki.oids&&g in r.pki.oids&&(f+=" ("+r.pki.oids[g]+") ")}if(c.type===e.Type.INTEGER)try{f+=e.derToInteger(c.value)}catch{f+="0x"+r.util.bytesToHex(c.value)}else if(c.type===e.Type.BITSTRING){if(c.value.length>1?f+="0x"+r.util.bytesToHex(c.value.slice(1)):f+="(none)",c.value.length>0){var C=c.value.charCodeAt(0);C==1?f+=" (1 unused bit shown)":C>1&&(f+=" ("+C+" unused bits shown)")}}else if(c.type===e.Type.OCTETSTRING)x.test(c.value)||(f+="("+c.value+") "),f+="0x"+r.util.bytesToHex(c.value);else if(c.type===e.Type.UTF8)try{f+=r.util.decodeUtf8(c.value)}catch(m){if(m.message==="URI malformed")f+="0x"+r.util.bytesToHex(c.value)+" (malformed UTF8)";else throw m}else c.type===e.Type.PRINTABLESTRING||c.type===e.Type.IA5String?f+=c.value:x.test(c.value)?f+="0x"+r.util.bytesToHex(c.value):c.value.length===0?f+="[null]":f+=c.value}return f},Pt.exports}var Ot={exports:{}},Kt,Rr;function rt(){if(Rr)return Kt;Rr=1;var r=ue();return Kt=r.md=r.md||{},r.md.algorithms=r.md.algorithms||{},Kt}var wr;function dt(){if(wr)return Ot.exports;wr=1;var r=ue();rt(),de();var e=Ot.exports=r.hmac=r.hmac||{};return e.create=function(){var n=null,p=null,b=null,x=null,c={};return c.start=function(t,y){if(t!==null)if(typeof t=="string")if(t=t.toLowerCase(),t in r.md.algorithms)p=r.md.algorithms[t].create();else throw new Error('Unknown hash algorithm "'+t+'"');else p=t;if(y===null)y=n;else{if(typeof y=="string")y=r.util.createBuffer(y);else if(r.util.isArray(y)){var f=y;y=r.util.createBuffer();for(var S=0;S<f.length;++S)y.putByte(f[S])}var k=y.length();k>p.blockLength&&(p.start(),p.update(y.bytes()),y=p.digest()),b=r.util.createBuffer(),x=r.util.createBuffer(),k=y.length();for(var S=0;S<k;++S){var f=y.at(S);b.putByte(54^f),x.putByte(92^f)}if(k<p.blockLength)for(var f=p.blockLength-k,S=0;S<f;++S)b.putByte(54),x.putByte(92);n=y,b=b.bytes(),x=x.bytes()}p.start(),p.update(b)},c.update=function(t){p.update(t)},c.getMac=function(){var t=p.digest().bytes();return p.start(),p.update(x),p.update(t),p.digest()},c.digest=c.getMac,c},Ot.exports}var Ft={exports:{}},Lr;function Mt(){if(Lr)return Ft.exports;Lr=1;var r=ue();rt(),de();var e=Ft.exports=r.md5=r.md5||{};r.md.md5=r.md.algorithms.md5=e,e.create=function(){c||t();var f=null,S=r.util.createBuffer(),k=new Array(16),E={algorithm:"md5",blockLength:64,digestLength:16,messageLength:0,fullMessageLength:null,messageLengthSize:8};return E.start=function(){E.messageLength=0,E.fullMessageLength=E.messageLength64=[];for(var u=E.messageLengthSize/4,g=0;g<u;++g)E.fullMessageLength.push(0);return S=r.util.createBuffer(),f={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878},E},E.start(),E.update=function(u,g){g==="utf8"&&(u=r.util.encodeUtf8(u));var C=u.length;E.messageLength+=C,C=[C/4294967296>>>0,C>>>0];for(var m=E.fullMessageLength.length-1;m>=0;--m)E.fullMessageLength[m]+=C[1],C[1]=C[0]+(E.fullMessageLength[m]/4294967296>>>0),E.fullMessageLength[m]=E.fullMessageLength[m]>>>0,C[0]=C[1]/4294967296>>>0;return S.putBytes(u),y(f,k,S),(S.read>2048||S.length()===0)&&S.compact(),E},E.digest=function(){var u=r.util.createBuffer();u.putBytes(S.bytes());var g=E.fullMessageLength[E.fullMessageLength.length-1]+E.messageLengthSize,C=g&E.blockLength-1;u.putBytes(n.substr(0,E.blockLength-C));for(var m,s=0,d=E.fullMessageLength.length-1;d>=0;--d)m=E.fullMessageLength[d]*8+s,s=m/4294967296>>>0,u.putInt32Le(m>>>0);var v={h0:f.h0,h1:f.h1,h2:f.h2,h3:f.h3};y(v,k,u);var I=r.util.createBuffer();return I.putInt32Le(v.h0),I.putInt32Le(v.h1),I.putInt32Le(v.h2),I.putInt32Le(v.h3),I},E};var n=null,p=null,b=null,x=null,c=!1;function t(){n="",n+=r.util.fillString("\0",64),p=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,1,6,11,0,5,10,15,4,9,14,3,8,13,2,7,12,5,8,11,14,1,4,7,10,13,0,3,6,9,12,15,2,0,7,14,5,12,3,10,1,8,15,6,13,4,11,2,9],b=[7,12,17,22,7,12,17,22,7,12,17,22,7,12,17,22,5,9,14,20,5,9,14,20,5,9,14,20,5,9,14,20,4,11,16,23,4,11,16,23,4,11,16,23,4,11,16,23,6,10,15,21,6,10,15,21,6,10,15,21,6,10,15,21],x=new Array(64);for(var f=0;f<64;++f)x[f]=Math.floor(Math.abs(Math.sin(f+1))*4294967296);c=!0}function y(f,S,k){for(var E,u,g,C,m,s,d,v,I=k.length();I>=64;){for(u=f.h0,g=f.h1,C=f.h2,m=f.h3,v=0;v<16;++v)S[v]=k.getInt32Le(),s=m^g&(C^m),E=u+s+x[v]+S[v],d=b[v],u=m,m=C,C=g,g+=E<<d|E>>>32-d;for(;v<32;++v)s=C^m&(g^C),E=u+s+x[v]+S[p[v]],d=b[v],u=m,m=C,C=g,g+=E<<d|E>>>32-d;for(;v<48;++v)s=g^C^m,E=u+s+x[v]+S[p[v]],d=b[v],u=m,m=C,C=g,g+=E<<d|E>>>32-d;for(;v<64;++v)s=C^(g|~m),E=u+s+x[v]+S[p[v]],d=b[v],u=m,m=C,C=g,g+=E<<d|E>>>32-d;f.h0=f.h0+u|0,f.h1=f.h1+g|0,f.h2=f.h2+C|0,f.h3=f.h3+m|0,I-=64}}return Ft.exports}var qt={exports:{}},kr;function ft(){if(kr)return qt.exports;kr=1;var r=ue();de();var e=qt.exports=r.pem=r.pem||{};e.encode=function(b,x){x=x||{};var c="-----BEGIN "+b.type+`-----\r
`,t;if(b.procType&&(t={name:"Proc-Type",values:[String(b.procType.version),b.procType.type]},c+=n(t)),b.contentDomain&&(t={name:"Content-Domain",values:[b.contentDomain]},c+=n(t)),b.dekInfo&&(t={name:"DEK-Info",values:[b.dekInfo.algorithm]},b.dekInfo.parameters&&t.values.push(b.dekInfo.parameters),c+=n(t)),b.headers)for(var y=0;y<b.headers.length;++y)c+=n(b.headers[y]);return b.procType&&(c+=`\r
`),c+=r.util.encode64(b.body,x.maxline||64)+`\r
`,c+="-----END "+b.type+`-----\r
`,c},e.decode=function(b){for(var x=[],c=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,t=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,y=/\r?\n/,f;f=c.exec(b),!!f;){var S=f[1];S==="NEW CERTIFICATE REQUEST"&&(S="CERTIFICATE REQUEST");var k={type:S,procType:null,contentDomain:null,dekInfo:null,headers:[],body:r.util.decode64(f[3])};if(x.push(k),!!f[2]){for(var E=f[2].split(y),u=0;f&&u<E.length;){for(var g=E[u].replace(/\s+$/,""),C=u+1;C<E.length;++C){var m=E[C];if(!/\s/.test(m[0]))break;g+=m,u=C}if(f=g.match(t),f){for(var s={name:f[1],values:[]},d=f[2].split(","),v=0;v<d.length;++v)s.values.push(p(d[v]));if(k.procType)if(!k.contentDomain&&s.name==="Content-Domain")k.contentDomain=d[0]||"";else if(!k.dekInfo&&s.name==="DEK-Info"){if(s.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');k.dekInfo={algorithm:d[0],parameters:d[1]||null}}else k.headers.push(s);else{if(s.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(s.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');k.procType={version:d[0],type:d[1]}}}++u}if(k.procType==="ENCRYPTED"&&!k.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(x.length===0)throw new Error("Invalid PEM formatted message.");return x};function n(b){for(var x=b.name+": ",c=[],t=function(E,u){return" "+u},y=0;y<b.values.length;++y)c.push(b.values[y].replace(/^(\S+\r\n)/,t));x+=c.join(",")+`\r
`;for(var f=0,S=-1,y=0;y<x.length;++y,++f)if(f>65&&S!==-1){var k=x[S];k===","?(++S,x=x.substr(0,S)+`\r
 `+x.substr(S)):x=x.substr(0,S)+`\r
`+k+x.substr(S+1),f=y-S-1,S=-1,++y}else(x[y]===" "||x[y]==="	"||x[y]===",")&&(S=y);return x}function p(b){return b.replace(/^\s+/,"")}return qt.exports}var Ht={exports:{}},Gt,Dr;function yt(){if(Dr)return Gt;Dr=1;var r=ue();Lt(),Br(),de(),Gt=r.des=r.des||{},r.des.startEncrypting=function(u,g,C,m){var s=E({key:u,output:C,decrypt:!1,mode:m||(g===null?"ECB":"CBC")});return s.start(g),s},r.des.createEncryptionCipher=function(u,g){return E({key:u,output:null,decrypt:!1,mode:g})},r.des.startDecrypting=function(u,g,C,m){var s=E({key:u,output:C,decrypt:!0,mode:m||(g===null?"ECB":"CBC")});return s.start(g),s},r.des.createDecryptionCipher=function(u,g){return E({key:u,output:null,decrypt:!0,mode:g})},r.des.Algorithm=function(u,g){var C=this;C.name=u,C.mode=new g({blockSize:8,cipher:{encrypt:function(m,s){return k(C._keys,m,s,!1)},decrypt:function(m,s){return k(C._keys,m,s,!0)}}}),C._init=!1},r.des.Algorithm.prototype.initialize=function(u){if(!this._init){var g=r.util.createBuffer(u.key);if(this.name.indexOf("3DES")===0&&g.length()!==24)throw new Error("Invalid Triple-DES key size: "+g.length()*8);this._keys=S(g),this._init=!0}},e("DES-ECB",r.cipher.modes.ecb),e("DES-CBC",r.cipher.modes.cbc),e("DES-CFB",r.cipher.modes.cfb),e("DES-OFB",r.cipher.modes.ofb),e("DES-CTR",r.cipher.modes.ctr),e("3DES-ECB",r.cipher.modes.ecb),e("3DES-CBC",r.cipher.modes.cbc),e("3DES-CFB",r.cipher.modes.cfb),e("3DES-OFB",r.cipher.modes.ofb),e("3DES-CTR",r.cipher.modes.ctr);function e(u,g){var C=function(){return new r.des.Algorithm(u,g)};r.cipher.registerAlgorithm(u,C)}var n=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],p=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],b=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],x=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],c=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],t=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],y=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],f=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function S(u){for(var g=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],C=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],m=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],s=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],d=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],v=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],I=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],R=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],h=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],i=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],a=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],B=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],D=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],V=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],L=u.length()>8?3:1,O=[],q=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],M=0,H,Y=0;Y<L;Y++){var X=u.getInt32(),J=u.getInt32();H=(X>>>4^J)&252645135,J^=H,X^=H<<4,H=(J>>>-16^X)&65535,X^=H,J^=H<<-16,H=(X>>>2^J)&858993459,J^=H,X^=H<<2,H=(J>>>-16^X)&65535,X^=H,J^=H<<-16,H=(X>>>1^J)&1431655765,J^=H,X^=H<<1,H=(J>>>8^X)&16711935,X^=H,J^=H<<8,H=(X>>>1^J)&1431655765,J^=H,X^=H<<1,H=X<<8|J>>>20&240,X=J<<24|J<<8&16711680|J>>>8&65280|J>>>24&240,J=H;for(var ne=0;ne<q.length;++ne){q[ne]?(X=X<<2|X>>>26,J=J<<2|J>>>26):(X=X<<1|X>>>27,J=J<<1|J>>>27),X&=-15,J&=-15;var se=g[X>>>28]|C[X>>>24&15]|m[X>>>20&15]|s[X>>>16&15]|d[X>>>12&15]|v[X>>>8&15]|I[X>>>4&15],he=R[J>>>28]|h[J>>>24&15]|i[J>>>20&15]|a[J>>>16&15]|B[J>>>12&15]|D[J>>>8&15]|V[J>>>4&15];H=(he>>>16^se)&65535,O[M++]=se^H,O[M++]=he^H<<16}}return O}function k(u,g,C,m){var s=u.length===32?3:9,d;s===3?d=m?[30,-2,-2]:[0,32,2]:d=m?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var v,I=g[0],R=g[1];v=(I>>>4^R)&252645135,R^=v,I^=v<<4,v=(I>>>16^R)&65535,R^=v,I^=v<<16,v=(R>>>2^I)&858993459,I^=v,R^=v<<2,v=(R>>>8^I)&16711935,I^=v,R^=v<<8,v=(I>>>1^R)&1431655765,R^=v,I^=v<<1,I=I<<1|I>>>31,R=R<<1|R>>>31;for(var h=0;h<s;h+=3){for(var i=d[h+1],a=d[h+2],B=d[h];B!=i;B+=a){var D=R^u[B],V=(R>>>4|R<<28)^u[B+1];v=I,I=R,R=v^(p[D>>>24&63]|x[D>>>16&63]|t[D>>>8&63]|f[D&63]|n[V>>>24&63]|b[V>>>16&63]|c[V>>>8&63]|y[V&63])}v=I,I=R,R=v}I=I>>>1|I<<31,R=R>>>1|R<<31,v=(I>>>1^R)&1431655765,R^=v,I^=v<<1,v=(R>>>8^I)&16711935,I^=v,R^=v<<8,v=(R>>>2^I)&858993459,I^=v,R^=v<<2,v=(I>>>16^R)&65535,R^=v,I^=v<<16,v=(I>>>4^R)&252645135,R^=v,I^=v<<4,C[0]=I,C[1]=R}function E(u){u=u||{};var g=(u.mode||"CBC").toUpperCase(),C="DES-"+g,m;u.decrypt?m=r.cipher.createDecipher(C,u.key):m=r.cipher.createCipher(C,u.key);var s=m.start;return m.start=function(d,v){var I=null;v instanceof r.util.ByteBuffer&&(I=v,v={}),v=v||{},v.output=I,v.iv=d,s.call(m,v)},m}return Gt}const Qt=Ia(Object.freeze(Object.defineProperty({__proto__:null,default:{}},Symbol.toStringTag,{value:"Module"})));var zt,Ur;function Yt(){if(Ur)return zt;Ur=1;var r=ue();dt(),rt(),de();var e=r.pkcs5=r.pkcs5||{},n;return r.util.isNodejs&&!r.options.usePureJavaScript&&(n=Qt),zt=r.pbkdf2=e.pbkdf2=function(p,b,x,c,t,y){if(typeof t=="function"&&(y=t,t=null),r.util.isNodejs&&!r.options.usePureJavaScript&&n.pbkdf2&&(t===null||typeof t!="object")&&(n.pbkdf2Sync.length>4||!t||t==="sha1"))return typeof t!="string"&&(t="sha1"),p=Buffer.from(p,"binary"),b=Buffer.from(b,"binary"),y?n.pbkdf2Sync.length===4?n.pbkdf2(p,b,x,c,function(h,i){if(h)return y(h);y(null,i.toString("binary"))}):n.pbkdf2(p,b,x,c,t,function(h,i){if(h)return y(h);y(null,i.toString("binary"))}):n.pbkdf2Sync.length===4?n.pbkdf2Sync(p,b,x,c).toString("binary"):n.pbkdf2Sync(p,b,x,c,t).toString("binary");if((typeof t>"u"||t===null)&&(t="sha1"),typeof t=="string"){if(!(t in r.md.algorithms))throw new Error("Unknown hash algorithm: "+t);t=r.md[t].create()}var f=t.digestLength;if(c>4294967295*f){var S=new Error("Derived key is too long.");if(y)return y(S);throw S}var k=Math.ceil(c/f),E=c-(k-1)*f,u=r.hmac.create();u.start(t,p);var g="",C,m,s;if(!y){for(var d=1;d<=k;++d){u.start(null,null),u.update(b),u.update(r.util.int32ToBytes(d)),C=s=u.digest().getBytes();for(var v=2;v<=x;++v)u.start(null,null),u.update(s),m=u.digest().getBytes(),C=r.util.xorBytes(C,m,f),s=m;g+=d<k?C:C.substr(0,E)}return g}var d=1,v;function I(){if(d>k)return y(null,g);u.start(null,null),u.update(b),u.update(r.util.int32ToBytes(d)),C=s=u.digest().getBytes(),v=2,R()}function R(){if(v<=x)return u.start(null,null),u.update(s),m=u.digest().getBytes(),C=r.util.xorBytes(C,m,f),s=m,++v,r.util.setImmediate(R);g+=d<k?C:C.substr(0,E),++d,I()}I()},zt}var mt={exports:{}},Wt={exports:{}},Pr;function Vr(){if(Pr)return Wt.exports;Pr=1;var r=ue();rt(),de();var e=Wt.exports=r.sha256=r.sha256||{};r.md.sha256=r.md.algorithms.sha256=e,e.create=function(){p||x();var t=null,y=r.util.createBuffer(),f=new Array(64),S={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return S.start=function(){S.messageLength=0,S.fullMessageLength=S.messageLength64=[];for(var k=S.messageLengthSize/4,E=0;E<k;++E)S.fullMessageLength.push(0);return y=r.util.createBuffer(),t={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},S},S.start(),S.update=function(k,E){E==="utf8"&&(k=r.util.encodeUtf8(k));var u=k.length;S.messageLength+=u,u=[u/4294967296>>>0,u>>>0];for(var g=S.fullMessageLength.length-1;g>=0;--g)S.fullMessageLength[g]+=u[1],u[1]=u[0]+(S.fullMessageLength[g]/4294967296>>>0),S.fullMessageLength[g]=S.fullMessageLength[g]>>>0,u[0]=u[1]/4294967296>>>0;return y.putBytes(k),c(t,f,y),(y.read>2048||y.length()===0)&&y.compact(),S},S.digest=function(){var k=r.util.createBuffer();k.putBytes(y.bytes());var E=S.fullMessageLength[S.fullMessageLength.length-1]+S.messageLengthSize,u=E&S.blockLength-1;k.putBytes(n.substr(0,S.blockLength-u));for(var g,C,m=S.fullMessageLength[0]*8,s=0;s<S.fullMessageLength.length-1;++s)g=S.fullMessageLength[s+1]*8,C=g/4294967296>>>0,m+=C,k.putInt32(m>>>0),m=g>>>0;k.putInt32(m);var d={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4,h5:t.h5,h6:t.h6,h7:t.h7};c(d,f,k);var v=r.util.createBuffer();return v.putInt32(d.h0),v.putInt32(d.h1),v.putInt32(d.h2),v.putInt32(d.h3),v.putInt32(d.h4),v.putInt32(d.h5),v.putInt32(d.h6),v.putInt32(d.h7),v},S};var n=null,p=!1,b=null;function x(){n="",n+=r.util.fillString("\0",64),b=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],p=!0}function c(t,y,f){for(var S,k,E,u,g,C,m,s,d,v,I,R,h,i,a,B=f.length();B>=64;){for(m=0;m<16;++m)y[m]=f.getInt32();for(;m<64;++m)S=y[m-2],S=(S>>>17|S<<15)^(S>>>19|S<<13)^S>>>10,k=y[m-15],k=(k>>>7|k<<25)^(k>>>18|k<<14)^k>>>3,y[m]=S+y[m-7]+k+y[m-16]|0;for(s=t.h0,d=t.h1,v=t.h2,I=t.h3,R=t.h4,h=t.h5,i=t.h6,a=t.h7,m=0;m<64;++m)u=(R>>>6|R<<26)^(R>>>11|R<<21)^(R>>>25|R<<7),g=i^R&(h^i),E=(s>>>2|s<<30)^(s>>>13|s<<19)^(s>>>22|s<<10),C=s&d|v&(s^d),S=a+u+g+b[m]+y[m],k=E+C,a=i,i=h,h=R,R=I+S>>>0,I=v,v=d,d=s,s=S+k>>>0;t.h0=t.h0+s|0,t.h1=t.h1+d|0,t.h2=t.h2+v|0,t.h3=t.h3+I|0,t.h4=t.h4+R|0,t.h5=t.h5+h|0,t.h6=t.h6+i|0,t.h7=t.h7+a|0,B-=64}}return Wt.exports}var Xt={exports:{}},Or;function Kr(){if(Or)return Xt.exports;Or=1;var r=ue();de();var e=null;r.util.isNodejs&&!r.options.usePureJavaScript&&!process.versions["node-webkit"]&&(e=Qt);var n=Xt.exports=r.prng=r.prng||{};return n.create=function(p){for(var b={plugin:p,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},x=p.md,c=new Array(32),t=0;t<32;++t)c[t]=x.create();b.pools=c,b.pool=0,b.generate=function(E,u){if(!u)return b.generateSync(E);var g=b.plugin.cipher,C=b.plugin.increment,m=b.plugin.formatKey,s=b.plugin.formatSeed,d=r.util.createBuffer();b.key=null,v();function v(I){if(I)return u(I);if(d.length()>=E)return u(null,d.getBytes(E));if(b.generated>1048575&&(b.key=null),b.key===null)return r.util.nextTick(function(){y(v)});var R=g(b.key,b.seed);b.generated+=R.length,d.putBytes(R),b.key=m(g(b.key,C(b.seed))),b.seed=s(g(b.key,b.seed)),r.util.setImmediate(v)}},b.generateSync=function(E){var u=b.plugin.cipher,g=b.plugin.increment,C=b.plugin.formatKey,m=b.plugin.formatSeed;b.key=null;for(var s=r.util.createBuffer();s.length()<E;){b.generated>1048575&&(b.key=null),b.key===null&&f();var d=u(b.key,b.seed);b.generated+=d.length,s.putBytes(d),b.key=C(u(b.key,g(b.seed))),b.seed=m(u(b.key,b.seed))}return s.getBytes(E)};function y(E){if(b.pools[0].messageLength>=32)return S(),E();var u=32-b.pools[0].messageLength<<5;b.seedFile(u,function(g,C){if(g)return E(g);b.collect(C),S(),E()})}function f(){if(b.pools[0].messageLength>=32)return S();var E=32-b.pools[0].messageLength<<5;b.collect(b.seedFileSync(E)),S()}function S(){b.reseeds=b.reseeds===4294967295?0:b.reseeds+1;var E=b.plugin.md.create();E.update(b.keyBytes);for(var u=1,g=0;g<32;++g)b.reseeds%u===0&&(E.update(b.pools[g].digest().getBytes()),b.pools[g].start()),u=u<<1;b.keyBytes=E.digest().getBytes(),E.start(),E.update(b.keyBytes);var C=E.digest().getBytes();b.key=b.plugin.formatKey(b.keyBytes),b.seed=b.plugin.formatSeed(C),b.generated=0}function k(E){var u=null,g=r.util.globalScope,C=g.crypto||g.msCrypto;C&&C.getRandomValues&&(u=function(a){return C.getRandomValues(a)});var m=r.util.createBuffer();if(u)for(;m.length()<E;){var s=Math.max(1,Math.min(E-m.length(),65536)/4),d=new Uint32Array(Math.floor(s));try{u(d);for(var v=0;v<d.length;++v)m.putInt32(d[v])}catch(a){if(!(typeof QuotaExceededError<"u"&&a instanceof QuotaExceededError))throw a}}if(m.length()<E)for(var I,R,h,i=Math.floor(Math.random()*65536);m.length()<E;){R=16807*(i&65535),I=16807*(i>>16),R+=(I&32767)<<16,R+=I>>15,R=(R&2147483647)+(R>>31),i=R&4294967295;for(var v=0;v<3;++v)h=i>>>(v<<3),h^=Math.floor(Math.random()*256),m.putByte(h&255)}return m.getBytes(E)}return e?(b.seedFile=function(E,u){e.randomBytes(E,function(g,C){if(g)return u(g);u(null,C.toString())})},b.seedFileSync=function(E){return e.randomBytes(E).toString()}):(b.seedFile=function(E,u){try{u(null,k(E))}catch(g){u(g)}},b.seedFileSync=k),b.collect=function(E){for(var u=E.length,g=0;g<u;++g)b.pools[b.pool].update(E.substr(g,1)),b.pool=b.pool===31?0:b.pool+1},b.collectInt=function(E,u){for(var g="",C=0;C<u;C+=8)g+=String.fromCharCode(E>>C&255);b.collect(g)},b.registerWorker=function(E){if(E===self)b.seedFile=function(g,C){function m(s){var d=s.data;d.forge&&d.forge.prng&&(self.removeEventListener("message",m),C(d.forge.prng.err,d.forge.prng.bytes))}self.addEventListener("message",m),self.postMessage({forge:{prng:{needed:g}}})};else{var u=function(g){var C=g.data;C.forge&&C.forge.prng&&b.seedFile(C.forge.prng.needed,function(m,s){E.postMessage({forge:{prng:{err:m,bytes:s}}})})};E.addEventListener("message",u)}},b},Xt.exports}var Fr;function Xe(){if(Fr)return mt.exports;Fr=1;var r=ue();return ot(),Vr(),Kr(),de(),function(){if(r.random&&r.random.getBytes){mt.exports=r.random;return}(function(e){var n={},p=new Array(4),b=r.util.createBuffer();n.formatKey=function(E){var u=r.util.createBuffer(E);return E=new Array(4),E[0]=u.getInt32(),E[1]=u.getInt32(),E[2]=u.getInt32(),E[3]=u.getInt32(),r.aes._expandKey(E,!1)},n.formatSeed=function(E){var u=r.util.createBuffer(E);return E=new Array(4),E[0]=u.getInt32(),E[1]=u.getInt32(),E[2]=u.getInt32(),E[3]=u.getInt32(),E},n.cipher=function(E,u){return r.aes._updateBlock(E,u,p,!1),b.putInt32(p[0]),b.putInt32(p[1]),b.putInt32(p[2]),b.putInt32(p[3]),b.getBytes()},n.increment=function(E){return++E[3],E},n.md=r.md.sha256;function x(){var E=r.prng.create(n);return E.getBytes=function(u,g){return E.generate(u,g)},E.getBytesSync=function(u){return E.generate(u)},E}var c=x(),t=null,y=r.util.globalScope,f=y.crypto||y.msCrypto;if(f&&f.getRandomValues&&(t=function(E){return f.getRandomValues(E)}),r.options.usePureJavaScript||!r.util.isNodejs&&!t){if(c.collectInt(+new Date,32),typeof navigator<"u"){var S="";for(var k in navigator)try{typeof navigator[k]=="string"&&(S+=navigator[k])}catch{}c.collect(S),S=null}e&&(e().mousemove(function(E){c.collectInt(E.clientX,16),c.collectInt(E.clientY,16)}),e().keypress(function(E){c.collectInt(E.charCode,8)}))}if(!r.random)r.random=c;else for(var k in c)r.random[k]=c[k];r.random.createInstance=x,mt.exports=r.random})(typeof jQuery<"u"?jQuery:null)}(),mt.exports}var jt,Mr;function qr(){if(Mr)return jt;Mr=1;var r=ue();de();var e=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],n=[1,2,3,5],p=function(c,t){return c<<t&65535|(c&65535)>>16-t},b=function(c,t){return(c&65535)>>t|c<<16-t&65535};jt=r.rc2=r.rc2||{},r.rc2.expandKey=function(c,t){typeof c=="string"&&(c=r.util.createBuffer(c)),t=t||128;var y=c,f=c.length(),S=t,k=Math.ceil(S/8),E=255>>(S&7),u;for(u=f;u<128;u++)y.putByte(e[y.at(u-1)+y.at(u-f)&255]);for(y.setAt(128-k,e[y.at(128-k)&E]),u=127-k;u>=0;u--)y.setAt(u,e[y.at(u+1)^y.at(u+k)]);return y};var x=function(c,t,y){var f=!1,S=null,k=null,E=null,u,g,C,m,s=[];for(c=r.rc2.expandKey(c,t),C=0;C<64;C++)s.push(c.getInt16Le());y?(u=function(I){for(C=0;C<4;C++)I[C]+=s[m]+(I[(C+3)%4]&I[(C+2)%4])+(~I[(C+3)%4]&I[(C+1)%4]),I[C]=p(I[C],n[C]),m++},g=function(I){for(C=0;C<4;C++)I[C]+=s[I[(C+3)%4]&63]}):(u=function(I){for(C=3;C>=0;C--)I[C]=b(I[C],n[C]),I[C]-=s[m]+(I[(C+3)%4]&I[(C+2)%4])+(~I[(C+3)%4]&I[(C+1)%4]),m--},g=function(I){for(C=3;C>=0;C--)I[C]-=s[I[(C+3)%4]&63]});var d=function(I){var R=[];for(C=0;C<4;C++){var h=S.getInt16Le();E!==null&&(y?h^=E.getInt16Le():E.putInt16Le(h)),R.push(h&65535)}m=y?0:63;for(var i=0;i<I.length;i++)for(var a=0;a<I[i][0];a++)I[i][1](R);for(C=0;C<4;C++)E!==null&&(y?E.putInt16Le(R[C]):R[C]^=E.getInt16Le()),k.putInt16Le(R[C])},v=null;return v={start:function(I,R){I&&typeof I=="string"&&(I=r.util.createBuffer(I)),f=!1,S=r.util.createBuffer(),k=R||new r.util.createBuffer,E=I,v.output=k},update:function(I){for(f||S.putBuffer(I);S.length()>=8;)d([[5,u],[1,g],[6,u],[1,g],[5,u]])},finish:function(I){var R=!0;if(y)if(I)R=I(8,S,!y);else{var h=S.length()===8?8:8-S.length();S.fillWithByte(h,h)}if(R&&(f=!0,v.update()),!y&&(R=S.length()===0,R))if(I)R=I(8,k,!y);else{var i=k.length(),a=k.at(i-1);a>i?R=!1:k.truncate(a)}return R}},v};return r.rc2.startEncrypting=function(c,t,y){var f=r.rc2.createEncryptionCipher(c,128);return f.start(t,y),f},r.rc2.createEncryptionCipher=function(c,t){return x(c,t,!0)},r.rc2.startDecrypting=function(c,t,y){var f=r.rc2.createDecryptionCipher(c,128);return f.start(t,y),f},r.rc2.createDecryptionCipher=function(c,t){return x(c,t,!1)},jt}var $t,Hr;function Ct(){if(Hr)return $t;Hr=1;var r=ue();$t=r.jsbn=r.jsbn||{};var e;function n(T,_,U){this.data=[],T!=null&&(typeof T=="number"?this.fromNumber(T,_,U):_==null&&typeof T!="string"?this.fromString(T,256):this.fromString(T,_))}r.jsbn.BigInteger=n;function p(){return new n(null)}function b(T,_,U,F,Q,W){for(;--W>=0;){var re=_*this.data[T++]+U.data[F]+Q;Q=Math.floor(re/67108864),U.data[F++]=re&67108863}return Q}function x(T,_,U,F,Q,W){for(var re=_&32767,Z=_>>15;--W>=0;){var pe=this.data[T]&32767,Ke=this.data[T++]>>15,We=Z*pe+Ke*re;pe=re*pe+((We&32767)<<15)+U.data[F]+(Q&1073741823),Q=(pe>>>30)+(We>>>15)+Z*Ke+(Q>>>30),U.data[F++]=pe&1073741823}return Q}function c(T,_,U,F,Q,W){for(var re=_&16383,Z=_>>14;--W>=0;){var pe=this.data[T]&16383,Ke=this.data[T++]>>14,We=Z*pe+Ke*re;pe=re*pe+((We&16383)<<14)+U.data[F]+Q,Q=(pe>>28)+(We>>14)+Z*Ke,U.data[F++]=pe&268435455}return Q}typeof navigator>"u"?(n.prototype.am=c,e=28):navigator.appName=="Microsoft Internet Explorer"?(n.prototype.am=x,e=30):navigator.appName!="Netscape"?(n.prototype.am=b,e=26):(n.prototype.am=c,e=28),n.prototype.DB=e,n.prototype.DM=(1<<e)-1,n.prototype.DV=1<<e;var t=52;n.prototype.FV=Math.pow(2,t),n.prototype.F1=t-e,n.prototype.F2=2*e-t;var y="0123456789abcdefghijklmnopqrstuvwxyz",f=new Array,S,k;for(S=48,k=0;k<=9;++k)f[S++]=k;for(S=97,k=10;k<36;++k)f[S++]=k;for(S=65,k=10;k<36;++k)f[S++]=k;function E(T){return y.charAt(T)}function u(T,_){var U=f[T.charCodeAt(_)];return U??-1}function g(T){for(var _=this.t-1;_>=0;--_)T.data[_]=this.data[_];T.t=this.t,T.s=this.s}function C(T){this.t=1,this.s=T<0?-1:0,T>0?this.data[0]=T:T<-1?this.data[0]=T+this.DV:this.t=0}function m(T){var _=p();return _.fromInt(T),_}function s(T,_){var U;if(_==16)U=4;else if(_==8)U=3;else if(_==256)U=8;else if(_==2)U=1;else if(_==32)U=5;else if(_==4)U=2;else{this.fromRadix(T,_);return}this.t=0,this.s=0;for(var F=T.length,Q=!1,W=0;--F>=0;){var re=U==8?T[F]&255:u(T,F);if(re<0){T.charAt(F)=="-"&&(Q=!0);continue}Q=!1,W==0?this.data[this.t++]=re:W+U>this.DB?(this.data[this.t-1]|=(re&(1<<this.DB-W)-1)<<W,this.data[this.t++]=re>>this.DB-W):this.data[this.t-1]|=re<<W,W+=U,W>=this.DB&&(W-=this.DB)}U==8&&(T[0]&128)!=0&&(this.s=-1,W>0&&(this.data[this.t-1]|=(1<<this.DB-W)-1<<W)),this.clamp(),Q&&n.ZERO.subTo(this,this)}function d(){for(var T=this.s&this.DM;this.t>0&&this.data[this.t-1]==T;)--this.t}function v(T){if(this.s<0)return"-"+this.negate().toString(T);var _;if(T==16)_=4;else if(T==8)_=3;else if(T==2)_=1;else if(T==32)_=5;else if(T==4)_=2;else return this.toRadix(T);var U=(1<<_)-1,F,Q=!1,W="",re=this.t,Z=this.DB-re*this.DB%_;if(re-- >0)for(Z<this.DB&&(F=this.data[re]>>Z)>0&&(Q=!0,W=E(F));re>=0;)Z<_?(F=(this.data[re]&(1<<Z)-1)<<_-Z,F|=this.data[--re]>>(Z+=this.DB-_)):(F=this.data[re]>>(Z-=_)&U,Z<=0&&(Z+=this.DB,--re)),F>0&&(Q=!0),Q&&(W+=E(F));return Q?W:"0"}function I(){var T=p();return n.ZERO.subTo(this,T),T}function R(){return this.s<0?this.negate():this}function h(T){var _=this.s-T.s;if(_!=0)return _;var U=this.t;if(_=U-T.t,_!=0)return this.s<0?-_:_;for(;--U>=0;)if((_=this.data[U]-T.data[U])!=0)return _;return 0}function i(T){var _=1,U;return(U=T>>>16)!=0&&(T=U,_+=16),(U=T>>8)!=0&&(T=U,_+=8),(U=T>>4)!=0&&(T=U,_+=4),(U=T>>2)!=0&&(T=U,_+=2),(U=T>>1)!=0&&(T=U,_+=1),_}function a(){return this.t<=0?0:this.DB*(this.t-1)+i(this.data[this.t-1]^this.s&this.DM)}function B(T,_){var U;for(U=this.t-1;U>=0;--U)_.data[U+T]=this.data[U];for(U=T-1;U>=0;--U)_.data[U]=0;_.t=this.t+T,_.s=this.s}function D(T,_){for(var U=T;U<this.t;++U)_.data[U-T]=this.data[U];_.t=Math.max(this.t-T,0),_.s=this.s}function V(T,_){var U=T%this.DB,F=this.DB-U,Q=(1<<F)-1,W=Math.floor(T/this.DB),re=this.s<<U&this.DM,Z;for(Z=this.t-1;Z>=0;--Z)_.data[Z+W+1]=this.data[Z]>>F|re,re=(this.data[Z]&Q)<<U;for(Z=W-1;Z>=0;--Z)_.data[Z]=0;_.data[W]=re,_.t=this.t+W+1,_.s=this.s,_.clamp()}function L(T,_){_.s=this.s;var U=Math.floor(T/this.DB);if(U>=this.t){_.t=0;return}var F=T%this.DB,Q=this.DB-F,W=(1<<F)-1;_.data[0]=this.data[U]>>F;for(var re=U+1;re<this.t;++re)_.data[re-U-1]|=(this.data[re]&W)<<Q,_.data[re-U]=this.data[re]>>F;F>0&&(_.data[this.t-U-1]|=(this.s&W)<<Q),_.t=this.t-U,_.clamp()}function O(T,_){for(var U=0,F=0,Q=Math.min(T.t,this.t);U<Q;)F+=this.data[U]-T.data[U],_.data[U++]=F&this.DM,F>>=this.DB;if(T.t<this.t){for(F-=T.s;U<this.t;)F+=this.data[U],_.data[U++]=F&this.DM,F>>=this.DB;F+=this.s}else{for(F+=this.s;U<T.t;)F-=T.data[U],_.data[U++]=F&this.DM,F>>=this.DB;F-=T.s}_.s=F<0?-1:0,F<-1?_.data[U++]=this.DV+F:F>0&&(_.data[U++]=F),_.t=U,_.clamp()}function q(T,_){var U=this.abs(),F=T.abs(),Q=U.t;for(_.t=Q+F.t;--Q>=0;)_.data[Q]=0;for(Q=0;Q<F.t;++Q)_.data[Q+U.t]=U.am(0,F.data[Q],_,Q,0,U.t);_.s=0,_.clamp(),this.s!=T.s&&n.ZERO.subTo(_,_)}function M(T){for(var _=this.abs(),U=T.t=2*_.t;--U>=0;)T.data[U]=0;for(U=0;U<_.t-1;++U){var F=_.am(U,_.data[U],T,2*U,0,1);(T.data[U+_.t]+=_.am(U+1,2*_.data[U],T,2*U+1,F,_.t-U-1))>=_.DV&&(T.data[U+_.t]-=_.DV,T.data[U+_.t+1]=1)}T.t>0&&(T.data[T.t-1]+=_.am(U,_.data[U],T,2*U,0,1)),T.s=0,T.clamp()}function H(T,_,U){var F=T.abs();if(!(F.t<=0)){var Q=this.abs();if(Q.t<F.t){_?.fromInt(0),U!=null&&this.copyTo(U);return}U==null&&(U=p());var W=p(),re=this.s,Z=T.s,pe=this.DB-i(F.data[F.t-1]);pe>0?(F.lShiftTo(pe,W),Q.lShiftTo(pe,U)):(F.copyTo(W),Q.copyTo(U));var Ke=W.t,We=W.data[Ke-1];if(We!=0){var ze=We*(1<<this.F1)+(Ke>1?W.data[Ke-2]>>this.F2:0),nt=this.FV/ze,Bt=(1<<this.F1)/ze,Je=1<<this.F2,Ze=U.t,bt=Ze-Ke,st=_??p();for(W.dlShiftTo(bt,st),U.compareTo(st)>=0&&(U.data[U.t++]=1,U.subTo(st,U)),n.ONE.dlShiftTo(Ke,st),st.subTo(W,W);W.t<Ke;)W.data[W.t++]=0;for(;--bt>=0;){var Er=U.data[--Ze]==We?this.DM:Math.floor(U.data[Ze]*nt+(U.data[Ze-1]+Je)*Bt);if((U.data[Ze]+=W.am(0,Er,U,bt,0,Ke))<Er)for(W.dlShiftTo(bt,st),U.subTo(st,U);U.data[Ze]<--Er;)U.subTo(st,U)}_!=null&&(U.drShiftTo(Ke,_),re!=Z&&n.ZERO.subTo(_,_)),U.t=Ke,U.clamp(),pe>0&&U.rShiftTo(pe,U),re<0&&n.ZERO.subTo(U,U)}}}function Y(T){var _=p();return this.abs().divRemTo(T,null,_),this.s<0&&_.compareTo(n.ZERO)>0&&T.subTo(_,_),_}function X(T){this.m=T}function J(T){return T.s<0||T.compareTo(this.m)>=0?T.mod(this.m):T}function ne(T){return T}function se(T){T.divRemTo(this.m,null,T)}function he(T,_,U){T.multiplyTo(_,U),this.reduce(U)}function ye(T,_){T.squareTo(_),this.reduce(_)}X.prototype.convert=J,X.prototype.revert=ne,X.prototype.reduce=se,X.prototype.mulTo=he,X.prototype.sqrTo=ye;function j(){if(this.t<1)return 0;var T=this.data[0];if((T&1)==0)return 0;var _=T&3;return _=_*(2-(T&15)*_)&15,_=_*(2-(T&255)*_)&255,_=_*(2-((T&65535)*_&65535))&65535,_=_*(2-T*_%this.DV)%this.DV,_>0?this.DV-_:-_}function le(T){this.m=T,this.mp=T.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<T.DB-15)-1,this.mt2=2*T.t}function $(T){var _=p();return T.abs().dlShiftTo(this.m.t,_),_.divRemTo(this.m,null,_),T.s<0&&_.compareTo(n.ZERO)>0&&this.m.subTo(_,_),_}function qe(T){var _=p();return T.copyTo(_),this.reduce(_),_}function fe(T){for(;T.t<=this.mt2;)T.data[T.t++]=0;for(var _=0;_<this.m.t;++_){var U=T.data[_]&32767,F=U*this.mpl+((U*this.mph+(T.data[_]>>15)*this.mpl&this.um)<<15)&T.DM;for(U=_+this.m.t,T.data[U]+=this.m.am(0,F,T,_,0,this.m.t);T.data[U]>=T.DV;)T.data[U]-=T.DV,T.data[++U]++}T.clamp(),T.drShiftTo(this.m.t,T),T.compareTo(this.m)>=0&&T.subTo(this.m,T)}function l(T,_){T.squareTo(_),this.reduce(_)}function w(T,_,U){T.multiplyTo(_,U),this.reduce(U)}le.prototype.convert=$,le.prototype.revert=qe,le.prototype.reduce=fe,le.prototype.mulTo=w,le.prototype.sqrTo=l;function N(){return(this.t>0?this.data[0]&1:this.s)==0}function o(T,_){if(T>4294967295||T<1)return n.ONE;var U=p(),F=p(),Q=_.convert(this),W=i(T)-1;for(Q.copyTo(U);--W>=0;)if(_.sqrTo(U,F),(T&1<<W)>0)_.mulTo(F,Q,U);else{var re=U;U=F,F=re}return _.revert(U)}function A(T,_){var U;return T<256||_.isEven()?U=new X(_):U=new le(_),this.exp(T,U)}n.prototype.copyTo=g,n.prototype.fromInt=C,n.prototype.fromString=s,n.prototype.clamp=d,n.prototype.dlShiftTo=B,n.prototype.drShiftTo=D,n.prototype.lShiftTo=V,n.prototype.rShiftTo=L,n.prototype.subTo=O,n.prototype.multiplyTo=q,n.prototype.squareTo=M,n.prototype.divRemTo=H,n.prototype.invDigit=j,n.prototype.isEven=N,n.prototype.exp=o,n.prototype.toString=v,n.prototype.negate=I,n.prototype.abs=R,n.prototype.compareTo=h,n.prototype.bitLength=a,n.prototype.mod=Y,n.prototype.modPowInt=A,n.ZERO=m(0),n.ONE=m(1);function K(){var T=p();return this.copyTo(T),T}function P(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function z(){return this.t==0?this.s:this.data[0]<<24>>24}function ee(){return this.t==0?this.s:this.data[0]<<16>>16}function ae(T){return Math.floor(Math.LN2*this.DB/Math.log(T))}function G(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function te(T){if(T==null&&(T=10),this.signum()==0||T<2||T>36)return"0";var _=this.chunkSize(T),U=Math.pow(T,_),F=m(U),Q=p(),W=p(),re="";for(this.divRemTo(F,Q,W);Q.signum()>0;)re=(U+W.intValue()).toString(T).substr(1)+re,Q.divRemTo(F,Q,W);return W.intValue().toString(T)+re}function ie(T,_){this.fromInt(0),_==null&&(_=10);for(var U=this.chunkSize(_),F=Math.pow(_,U),Q=!1,W=0,re=0,Z=0;Z<T.length;++Z){var pe=u(T,Z);if(pe<0){T.charAt(Z)=="-"&&this.signum()==0&&(Q=!0);continue}re=_*re+pe,++W>=U&&(this.dMultiply(F),this.dAddOffset(re,0),W=0,re=0)}W>0&&(this.dMultiply(Math.pow(_,W)),this.dAddOffset(re,0)),Q&&n.ZERO.subTo(this,this)}function ce(T,_,U){if(typeof _=="number")if(T<2)this.fromInt(1);else for(this.fromNumber(T,U),this.testBit(T-1)||this.bitwiseTo(n.ONE.shiftLeft(T-1),Te,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(_);)this.dAddOffset(2,0),this.bitLength()>T&&this.subTo(n.ONE.shiftLeft(T-1),this);else{var F=new Array,Q=T&7;F.length=(T>>3)+1,_.nextBytes(F),Q>0?F[0]&=(1<<Q)-1:F[0]=0,this.fromString(F,256)}}function oe(){var T=this.t,_=new Array;_[0]=this.s;var U=this.DB-T*this.DB%8,F,Q=0;if(T-- >0)for(U<this.DB&&(F=this.data[T]>>U)!=(this.s&this.DM)>>U&&(_[Q++]=F|this.s<<this.DB-U);T>=0;)U<8?(F=(this.data[T]&(1<<U)-1)<<8-U,F|=this.data[--T]>>(U+=this.DB-8)):(F=this.data[T]>>(U-=8)&255,U<=0&&(U+=this.DB,--T)),(F&128)!=0&&(F|=-256),Q==0&&(this.s&128)!=(F&128)&&++Q,(Q>0||F!=this.s)&&(_[Q++]=F);return _}function me(T){return this.compareTo(T)==0}function Se(T){return this.compareTo(T)<0?this:T}function xe(T){return this.compareTo(T)>0?this:T}function Ce(T,_,U){var F,Q,W=Math.min(T.t,this.t);for(F=0;F<W;++F)U.data[F]=_(this.data[F],T.data[F]);if(T.t<this.t){for(Q=T.s&this.DM,F=W;F<this.t;++F)U.data[F]=_(this.data[F],Q);U.t=this.t}else{for(Q=this.s&this.DM,F=W;F<T.t;++F)U.data[F]=_(Q,T.data[F]);U.t=T.t}U.s=_(this.s,T.s),U.clamp()}function ve(T,_){return T&_}function ge(T){var _=p();return this.bitwiseTo(T,ve,_),_}function Te(T,_){return T|_}function Fe(T){var _=p();return this.bitwiseTo(T,Te,_),_}function Me(T,_){return T^_}function He(T){var _=p();return this.bitwiseTo(T,Me,_),_}function Ge(T,_){return T&~_}function Qe(T){var _=p();return this.bitwiseTo(T,Ge,_),_}function Ye(){for(var T=p(),_=0;_<this.t;++_)T.data[_]=this.DM&~this.data[_];return T.t=this.t,T.s=~this.s,T}function je(T){var _=p();return T<0?this.rShiftTo(-T,_):this.lShiftTo(T,_),_}function tt(T){var _=p();return T<0?this.lShiftTo(-T,_):this.rShiftTo(T,_),_}function at(T){if(T==0)return-1;var _=0;return(T&65535)==0&&(T>>=16,_+=16),(T&255)==0&&(T>>=8,_+=8),(T&15)==0&&(T>>=4,_+=4),(T&3)==0&&(T>>=2,_+=2),(T&1)==0&&++_,_}function it(){for(var T=0;T<this.t;++T)if(this.data[T]!=0)return T*this.DB+at(this.data[T]);return this.s<0?this.t*this.DB:-1}function lt(T){for(var _=0;T!=0;)T&=T-1,++_;return _}function ct(){for(var T=0,_=this.s&this.DM,U=0;U<this.t;++U)T+=lt(this.data[U]^_);return T}function gt(T){var _=Math.floor(T/this.DB);return _>=this.t?this.s!=0:(this.data[_]&1<<T%this.DB)!=0}function At(T,_){var U=n.ONE.shiftLeft(T);return this.bitwiseTo(U,_,U),U}function Ae(T){return this.changeBit(T,Te)}function Be(T){return this.changeBit(T,Ge)}function be(T){return this.changeBit(T,Me)}function _e(T,_){for(var U=0,F=0,Q=Math.min(T.t,this.t);U<Q;)F+=this.data[U]+T.data[U],_.data[U++]=F&this.DM,F>>=this.DB;if(T.t<this.t){for(F+=T.s;U<this.t;)F+=this.data[U],_.data[U++]=F&this.DM,F>>=this.DB;F+=this.s}else{for(F+=this.s;U<T.t;)F+=T.data[U],_.data[U++]=F&this.DM,F>>=this.DB;F+=T.s}_.s=F<0?-1:0,F>0?_.data[U++]=F:F<-1&&(_.data[U++]=this.DV+F),_.t=U,_.clamp()}function Ne(T){var _=p();return this.addTo(T,_),_}function Re(T){var _=p();return this.subTo(T,_),_}function we(T){var _=p();return this.multiplyTo(T,_),_}function Le(T){var _=p();return this.divRemTo(T,_,null),_}function ke(T){var _=p();return this.divRemTo(T,null,_),_}function De(T){var _=p(),U=p();return this.divRemTo(T,_,U),new Array(_,U)}function Ue(T){this.data[this.t]=this.am(0,T-1,this,0,0,this.t),++this.t,this.clamp()}function Pe(T,_){if(T!=0){for(;this.t<=_;)this.data[this.t++]=0;for(this.data[_]+=T;this.data[_]>=this.DV;)this.data[_]-=this.DV,++_>=this.t&&(this.data[this.t++]=0),++this.data[_]}}function Ee(){}function Ie(T){return T}function Ve(T,_,U){T.multiplyTo(_,U)}function Oe(T,_){T.squareTo(_)}Ee.prototype.convert=Ie,Ee.prototype.revert=Ie,Ee.prototype.mulTo=Ve,Ee.prototype.sqrTo=Oe;function Va(T){return this.exp(T,new Ee)}function Oa(T,_,U){var F=Math.min(this.t+T.t,_);for(U.s=0,U.t=F;F>0;)U.data[--F]=0;var Q;for(Q=U.t-this.t;F<Q;++F)U.data[F+this.t]=this.am(0,T.data[F],U,F,0,this.t);for(Q=Math.min(T.t,_);F<Q;++F)this.am(0,T.data[F],U,F,0,_-F);U.clamp()}function Ka(T,_,U){--_;var F=U.t=this.t+T.t-_;for(U.s=0;--F>=0;)U.data[F]=0;for(F=Math.max(_-this.t,0);F<T.t;++F)U.data[this.t+F-_]=this.am(_-F,T.data[F],U,0,0,this.t+F-_);U.clamp(),U.drShiftTo(1,U)}function ht(T){this.r2=p(),this.q3=p(),n.ONE.dlShiftTo(2*T.t,this.r2),this.mu=this.r2.divide(T),this.m=T}function Fa(T){if(T.s<0||T.t>2*this.m.t)return T.mod(this.m);if(T.compareTo(this.m)<0)return T;var _=p();return T.copyTo(_),this.reduce(_),_}function Ma(T){return T}function qa(T){for(T.drShiftTo(this.m.t-1,this.r2),T.t>this.m.t+1&&(T.t=this.m.t+1,T.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);T.compareTo(this.r2)<0;)T.dAddOffset(1,this.m.t+1);for(T.subTo(this.r2,T);T.compareTo(this.m)>=0;)T.subTo(this.m,T)}function Ha(T,_){T.squareTo(_),this.reduce(_)}function Ga(T,_,U){T.multiplyTo(_,U),this.reduce(U)}ht.prototype.convert=Fa,ht.prototype.revert=Ma,ht.prototype.reduce=qa,ht.prototype.mulTo=Ga,ht.prototype.sqrTo=Ha;function Qa(T,_){var U=T.bitLength(),F,Q=m(1),W;if(U<=0)return Q;U<18?F=1:U<48?F=3:U<144?F=4:U<768?F=5:F=6,U<8?W=new X(_):_.isEven()?W=new ht(_):W=new le(_);var re=new Array,Z=3,pe=F-1,Ke=(1<<F)-1;if(re[1]=W.convert(this),F>1){var We=p();for(W.sqrTo(re[1],We);Z<=Ke;)re[Z]=p(),W.mulTo(We,re[Z-2],re[Z]),Z+=2}var ze=T.t-1,nt,Bt=!0,Je=p(),Ze;for(U=i(T.data[ze])-1;ze>=0;){for(U>=pe?nt=T.data[ze]>>U-pe&Ke:(nt=(T.data[ze]&(1<<U+1)-1)<<pe-U,ze>0&&(nt|=T.data[ze-1]>>this.DB+U-pe)),Z=F;(nt&1)==0;)nt>>=1,--Z;if((U-=Z)<0&&(U+=this.DB,--ze),Bt)re[nt].copyTo(Q),Bt=!1;else{for(;Z>1;)W.sqrTo(Q,Je),W.sqrTo(Je,Q),Z-=2;Z>0?W.sqrTo(Q,Je):(Ze=Q,Q=Je,Je=Ze),W.mulTo(Je,re[nt],Q)}for(;ze>=0&&(T.data[ze]&1<<U)==0;)W.sqrTo(Q,Je),Ze=Q,Q=Je,Je=Ze,--U<0&&(U=this.DB-1,--ze)}return W.revert(Q)}function za(T){var _=this.s<0?this.negate():this.clone(),U=T.s<0?T.negate():T.clone();if(_.compareTo(U)<0){var F=_;_=U,U=F}var Q=_.getLowestSetBit(),W=U.getLowestSetBit();if(W<0)return _;for(Q<W&&(W=Q),W>0&&(_.rShiftTo(W,_),U.rShiftTo(W,U));_.signum()>0;)(Q=_.getLowestSetBit())>0&&_.rShiftTo(Q,_),(Q=U.getLowestSetBit())>0&&U.rShiftTo(Q,U),_.compareTo(U)>=0?(_.subTo(U,_),_.rShiftTo(1,_)):(U.subTo(_,U),U.rShiftTo(1,U));return W>0&&U.lShiftTo(W,U),U}function Ya(T){if(T<=0)return 0;var _=this.DV%T,U=this.s<0?T-1:0;if(this.t>0)if(_==0)U=this.data[0]%T;else for(var F=this.t-1;F>=0;--F)U=(_*U+this.data[F])%T;return U}function Wa(T){var _=T.isEven();if(this.isEven()&&_||T.signum()==0)return n.ZERO;for(var U=T.clone(),F=this.clone(),Q=m(1),W=m(0),re=m(0),Z=m(1);U.signum()!=0;){for(;U.isEven();)U.rShiftTo(1,U),_?((!Q.isEven()||!W.isEven())&&(Q.addTo(this,Q),W.subTo(T,W)),Q.rShiftTo(1,Q)):W.isEven()||W.subTo(T,W),W.rShiftTo(1,W);for(;F.isEven();)F.rShiftTo(1,F),_?((!re.isEven()||!Z.isEven())&&(re.addTo(this,re),Z.subTo(T,Z)),re.rShiftTo(1,re)):Z.isEven()||Z.subTo(T,Z),Z.rShiftTo(1,Z);U.compareTo(F)>=0?(U.subTo(F,U),_&&Q.subTo(re,Q),W.subTo(Z,W)):(F.subTo(U,F),_&&re.subTo(Q,re),Z.subTo(W,Z))}if(F.compareTo(n.ONE)!=0)return n.ZERO;if(Z.compareTo(T)>=0)return Z.subtract(T);if(Z.signum()<0)Z.addTo(T,Z);else return Z;return Z.signum()<0?Z.add(T):Z}var $e=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],Xa=(1<<26)/$e[$e.length-1];function ja(T){var _,U=this.abs();if(U.t==1&&U.data[0]<=$e[$e.length-1]){for(_=0;_<$e.length;++_)if(U.data[0]==$e[_])return!0;return!1}if(U.isEven())return!1;for(_=1;_<$e.length;){for(var F=$e[_],Q=_+1;Q<$e.length&&F<Xa;)F*=$e[Q++];for(F=U.modInt(F);_<Q;)if(F%$e[_++]==0)return!1}return U.millerRabin(T)}function $a(T){var _=this.subtract(n.ONE),U=_.getLowestSetBit();if(U<=0)return!1;for(var F=_.shiftRight(U),Q=Ja(),W,re=0;re<T;++re){do W=new n(this.bitLength(),Q);while(W.compareTo(n.ONE)<=0||W.compareTo(_)>=0);var Z=W.modPow(F,this);if(Z.compareTo(n.ONE)!=0&&Z.compareTo(_)!=0){for(var pe=1;pe++<U&&Z.compareTo(_)!=0;)if(Z=Z.modPowInt(2,this),Z.compareTo(n.ONE)==0)return!1;if(Z.compareTo(_)!=0)return!1}}return!0}function Ja(){return{nextBytes:function(T){for(var _=0;_<T.length;++_)T[_]=Math.floor(Math.random()*256)}}}return n.prototype.chunkSize=ae,n.prototype.toRadix=te,n.prototype.fromRadix=ie,n.prototype.fromNumber=ce,n.prototype.bitwiseTo=Ce,n.prototype.changeBit=At,n.prototype.addTo=_e,n.prototype.dMultiply=Ue,n.prototype.dAddOffset=Pe,n.prototype.multiplyLowerTo=Oa,n.prototype.multiplyUpperTo=Ka,n.prototype.modInt=Ya,n.prototype.millerRabin=$a,n.prototype.clone=K,n.prototype.intValue=P,n.prototype.byteValue=z,n.prototype.shortValue=ee,n.prototype.signum=G,n.prototype.toByteArray=oe,n.prototype.equals=me,n.prototype.min=Se,n.prototype.max=xe,n.prototype.and=ge,n.prototype.or=Fe,n.prototype.xor=He,n.prototype.andNot=Qe,n.prototype.not=Ye,n.prototype.shiftLeft=je,n.prototype.shiftRight=tt,n.prototype.getLowestSetBit=it,n.prototype.bitCount=ct,n.prototype.testBit=gt,n.prototype.setBit=Ae,n.prototype.clearBit=Be,n.prototype.flipBit=be,n.prototype.add=Ne,n.prototype.subtract=Re,n.prototype.multiply=we,n.prototype.divide=Le,n.prototype.remainder=ke,n.prototype.divideAndRemainder=De,n.prototype.modPow=Qa,n.prototype.modInverse=Wa,n.prototype.pow=Va,n.prototype.gcd=za,n.prototype.isProbablePrime=ja,$t}var Jt={exports:{}},Zt={exports:{}},Gr;function pt(){if(Gr)return Zt.exports;Gr=1;var r=ue();rt(),de();var e=Zt.exports=r.sha1=r.sha1||{};r.md.sha1=r.md.algorithms.sha1=e,e.create=function(){p||b();var c=null,t=r.util.createBuffer(),y=new Array(80),f={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return f.start=function(){f.messageLength=0,f.fullMessageLength=f.messageLength64=[];for(var S=f.messageLengthSize/4,k=0;k<S;++k)f.fullMessageLength.push(0);return t=r.util.createBuffer(),c={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},f},f.start(),f.update=function(S,k){k==="utf8"&&(S=r.util.encodeUtf8(S));var E=S.length;f.messageLength+=E,E=[E/4294967296>>>0,E>>>0];for(var u=f.fullMessageLength.length-1;u>=0;--u)f.fullMessageLength[u]+=E[1],E[1]=E[0]+(f.fullMessageLength[u]/4294967296>>>0),f.fullMessageLength[u]=f.fullMessageLength[u]>>>0,E[0]=E[1]/4294967296>>>0;return t.putBytes(S),x(c,y,t),(t.read>2048||t.length()===0)&&t.compact(),f},f.digest=function(){var S=r.util.createBuffer();S.putBytes(t.bytes());var k=f.fullMessageLength[f.fullMessageLength.length-1]+f.messageLengthSize,E=k&f.blockLength-1;S.putBytes(n.substr(0,f.blockLength-E));for(var u,g,C=f.fullMessageLength[0]*8,m=0;m<f.fullMessageLength.length-1;++m)u=f.fullMessageLength[m+1]*8,g=u/4294967296>>>0,C+=g,S.putInt32(C>>>0),C=u>>>0;S.putInt32(C);var s={h0:c.h0,h1:c.h1,h2:c.h2,h3:c.h3,h4:c.h4};x(s,y,S);var d=r.util.createBuffer();return d.putInt32(s.h0),d.putInt32(s.h1),d.putInt32(s.h2),d.putInt32(s.h3),d.putInt32(s.h4),d},f};var n=null,p=!1;function b(){n="",n+=r.util.fillString("\0",64),p=!0}function x(c,t,y){for(var f,S,k,E,u,g,C,m,s=y.length();s>=64;){for(S=c.h0,k=c.h1,E=c.h2,u=c.h3,g=c.h4,m=0;m<16;++m)f=y.getInt32(),t[m]=f,C=u^k&(E^u),f=(S<<5|S>>>27)+C+g+1518500249+f,g=u,u=E,E=(k<<30|k>>>2)>>>0,k=S,S=f;for(;m<20;++m)f=t[m-3]^t[m-8]^t[m-14]^t[m-16],f=f<<1|f>>>31,t[m]=f,C=u^k&(E^u),f=(S<<5|S>>>27)+C+g+1518500249+f,g=u,u=E,E=(k<<30|k>>>2)>>>0,k=S,S=f;for(;m<32;++m)f=t[m-3]^t[m-8]^t[m-14]^t[m-16],f=f<<1|f>>>31,t[m]=f,C=k^E^u,f=(S<<5|S>>>27)+C+g+1859775393+f,g=u,u=E,E=(k<<30|k>>>2)>>>0,k=S,S=f;for(;m<40;++m)f=t[m-6]^t[m-16]^t[m-28]^t[m-32],f=f<<2|f>>>30,t[m]=f,C=k^E^u,f=(S<<5|S>>>27)+C+g+1859775393+f,g=u,u=E,E=(k<<30|k>>>2)>>>0,k=S,S=f;for(;m<60;++m)f=t[m-6]^t[m-16]^t[m-28]^t[m-32],f=f<<2|f>>>30,t[m]=f,C=k&E|u&(k^E),f=(S<<5|S>>>27)+C+g+2400959708+f,g=u,u=E,E=(k<<30|k>>>2)>>>0,k=S,S=f;for(;m<80;++m)f=t[m-6]^t[m-16]^t[m-28]^t[m-32],f=f<<2|f>>>30,t[m]=f,C=k^E^u,f=(S<<5|S>>>27)+C+g+3395469782+f,g=u,u=E,E=(k<<30|k>>>2)>>>0,k=S,S=f;c.h0=c.h0+S|0,c.h1=c.h1+k|0,c.h2=c.h2+E|0,c.h3=c.h3+u|0,c.h4=c.h4+g|0,s-=64}}return Zt.exports}var Qr;function zr(){if(Qr)return Jt.exports;Qr=1;var r=ue();de(),Xe(),pt();var e=Jt.exports=r.pkcs1=r.pkcs1||{};e.encode_rsa_oaep=function(p,b,x){var c,t,y,f;typeof x=="string"?(c=x,t=arguments[3]||void 0,y=arguments[4]||void 0):x&&(c=x.label||void 0,t=x.seed||void 0,y=x.md||void 0,x.mgf1&&x.mgf1.md&&(f=x.mgf1.md)),y?y.start():y=r.md.sha1.create(),f||(f=y);var S=Math.ceil(p.n.bitLength()/8),k=S-2*y.digestLength-2;if(b.length>k){var E=new Error("RSAES-OAEP input message length is too long.");throw E.length=b.length,E.maxLength=k,E}c||(c=""),y.update(c,"raw");for(var u=y.digest(),g="",C=k-b.length,m=0;m<C;m++)g+="\0";var s=u.getBytes()+g+""+b;if(!t)t=r.random.getBytes(y.digestLength);else if(t.length!==y.digestLength){var E=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw E.seedLength=t.length,E.digestLength=y.digestLength,E}var d=n(t,S-y.digestLength-1,f),v=r.util.xorBytes(s,d,s.length),I=n(v,y.digestLength,f),R=r.util.xorBytes(t,I,t.length);return"\0"+R+v},e.decode_rsa_oaep=function(p,b,x){var c,t,y;typeof x=="string"?(c=x,t=arguments[3]||void 0):x&&(c=x.label||void 0,t=x.md||void 0,x.mgf1&&x.mgf1.md&&(y=x.mgf1.md));var f=Math.ceil(p.n.bitLength()/8);if(b.length!==f){var v=new Error("RSAES-OAEP encoded message length is invalid.");throw v.length=b.length,v.expectedLength=f,v}if(t===void 0?t=r.md.sha1.create():t.start(),y||(y=t),f<2*t.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");c||(c=""),t.update(c,"raw");for(var S=t.digest().getBytes(),k=b.charAt(0),E=b.substring(1,t.digestLength+1),u=b.substring(1+t.digestLength),g=n(u,t.digestLength,y),C=r.util.xorBytes(E,g,E.length),m=n(C,f-t.digestLength-1,y),s=r.util.xorBytes(u,m,u.length),d=s.substring(0,t.digestLength),v=k!=="\0",I=0;I<t.digestLength;++I)v|=S.charAt(I)!==d.charAt(I);for(var R=1,h=t.digestLength,i=t.digestLength;i<s.length;i++){var a=s.charCodeAt(i),B=a&1^1,D=R?65534:0;v|=a&D,R=R&B,h+=R}if(v||s.charCodeAt(h)!==1)throw new Error("Invalid RSAES-OAEP padding.");return s.substring(h+1)};function n(p,b,x){x||(x=r.md.sha1.create());for(var c="",t=Math.ceil(b/x.digestLength),y=0;y<t;++y){var f=String.fromCharCode(y>>24&255,y>>16&255,y>>8&255,y&255);x.start(),x.update(p+f),c+=x.digest().getBytes()}return c.substring(0,b)}return Jt.exports}var Et={exports:{}},Yr;function Wr(){if(Yr)return Et.exports;Yr=1;var r=ue();return de(),Ct(),Xe(),function(){if(r.prime){Et.exports=r.prime;return}var e=Et.exports=r.prime=r.prime||{},n=r.jsbn.BigInteger,p=[6,4,2,4,2,4,6,2],b=new n(null);b.fromInt(30);var x=function(E,u){return E|u};e.generateProbablePrime=function(E,u,g){typeof u=="function"&&(g=u,u={}),u=u||{};var C=u.algorithm||"PRIMEINC";typeof C=="string"&&(C={name:C}),C.options=C.options||{};var m=u.prng||r.random,s={nextBytes:function(d){for(var v=m.getBytesSync(d.length),I=0;I<d.length;++I)d[I]=v.charCodeAt(I)}};if(C.name==="PRIMEINC")return c(E,s,C.options,g);throw new Error("Invalid prime generation algorithm: "+C.name)};function c(E,u,g,C){return"workers"in g?f(E,u,g,C):t(E,u,g,C)}function t(E,u,g,C){var m=S(E,u),s=0,d=k(m.bitLength());"millerRabinTests"in g&&(d=g.millerRabinTests);var v=10;"maxBlockTime"in g&&(v=g.maxBlockTime),y(m,E,u,s,d,v,C)}function y(E,u,g,C,m,s,d){var v=+new Date;do{if(E.bitLength()>u&&(E=S(u,g)),E.isProbablePrime(m))return d(null,E);E.dAddOffset(p[C++%8],0)}while(s<0||+new Date-v<s);r.util.setImmediate(function(){y(E,u,g,C,m,s,d)})}function f(E,u,g,C){if(typeof Worker>"u")return t(E,u,g,C);var m=S(E,u),s=g.workers,d=g.workLoad||100,v=d*30/8,I=g.workerScript||"forge/prime.worker.js";if(s===-1)return r.util.estimateCores(function(h,i){h&&(i=2),s=i-1,R()});R();function R(){s=Math.max(1,s);for(var h=[],i=0;i<s;++i)h[i]=new Worker(I);for(var i=0;i<s;++i)h[i].addEventListener("message",B);var a=!1;function B(D){if(!a){var V=D.data;if(V.found){for(var L=0;L<h.length;++L)h[L].terminate();return a=!0,C(null,new n(V.prime,16))}m.bitLength()>E&&(m=S(E,u));var O=m.toString(16);D.target.postMessage({hex:O,workLoad:d}),m.dAddOffset(v,0)}}}}function S(E,u){var g=new n(E,u),C=E-1;return g.testBit(C)||g.bitwiseTo(n.ONE.shiftLeft(C),x,g),g.dAddOffset(31-g.mod(b).byteValue(),0),g}function k(E){return E<=100?27:E<=150?18:E<=200?15:E<=250?12:E<=300?9:E<=350?8:E<=400?7:E<=500?6:E<=600?5:E<=800?4:E<=1250?3:2}}(),Et.exports}var er,Xr;function xt(){if(Xr)return er;Xr=1;var r=ue();if(et(),Ct(),ut(),zr(),Wr(),Xe(),de(),typeof e>"u")var e=r.jsbn.BigInteger;var n=r.util.isNodejs?Qt:null,p=r.asn1,b=r.util;r.pki=r.pki||{},er=r.pki.rsa=r.rsa=r.rsa||{};var x=r.pki,c=[6,4,2,4,2,4,6,2],t={name:"PrivateKeyInfo",tagClass:p.Class.UNIVERSAL,type:p.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:p.Class.UNIVERSAL,type:p.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:p.Class.UNIVERSAL,type:p.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:p.Class.UNIVERSAL,type:p.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:p.Class.UNIVERSAL,type:p.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},y={name:"RSAPrivateKey",tagClass:p.Class.UNIVERSAL,type:p.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:p.Class.UNIVERSAL,type:p.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:p.Class.UNIVERSAL,type:p.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:p.Class.UNIVERSAL,type:p.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:p.Class.UNIVERSAL,type:p.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:p.Class.UNIVERSAL,type:p.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:p.Class.UNIVERSAL,type:p.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:p.Class.UNIVERSAL,type:p.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:p.Class.UNIVERSAL,type:p.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:p.Class.UNIVERSAL,type:p.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},f={name:"RSAPublicKey",tagClass:p.Class.UNIVERSAL,type:p.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:p.Class.UNIVERSAL,type:p.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:p.Class.UNIVERSAL,type:p.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},S=r.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:p.Class.UNIVERSAL,type:p.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:p.Class.UNIVERSAL,type:p.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:p.Class.UNIVERSAL,type:p.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:p.Class.UNIVERSAL,type:p.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:p.Class.UNIVERSAL,type:p.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},k={name:"DigestInfo",tagClass:p.Class.UNIVERSAL,type:p.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:p.Class.UNIVERSAL,type:p.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:p.Class.UNIVERSAL,type:p.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:p.Class.UNIVERSAL,type:p.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:p.Class.UNIVERSAL,type:p.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},E=function(i){var a;if(i.algorithm in x.oids)a=x.oids[i.algorithm];else{var B=new Error("Unknown message digest algorithm.");throw B.algorithm=i.algorithm,B}var D=p.oidToDer(a).getBytes(),V=p.create(p.Class.UNIVERSAL,p.Type.SEQUENCE,!0,[]),L=p.create(p.Class.UNIVERSAL,p.Type.SEQUENCE,!0,[]);L.value.push(p.create(p.Class.UNIVERSAL,p.Type.OID,!1,D)),L.value.push(p.create(p.Class.UNIVERSAL,p.Type.NULL,!1,""));var O=p.create(p.Class.UNIVERSAL,p.Type.OCTETSTRING,!1,i.digest().getBytes());return V.value.push(L),V.value.push(O),p.toDer(V).getBytes()},u=function(i,a,B){if(B)return i.modPow(a.e,a.n);if(!a.p||!a.q)return i.modPow(a.d,a.n);a.dP||(a.dP=a.d.mod(a.p.subtract(e.ONE))),a.dQ||(a.dQ=a.d.mod(a.q.subtract(e.ONE))),a.qInv||(a.qInv=a.q.modInverse(a.p));var D;do D=new e(r.util.bytesToHex(r.random.getBytes(a.n.bitLength()/8)),16);while(D.compareTo(a.n)>=0||!D.gcd(a.n).equals(e.ONE));i=i.multiply(D.modPow(a.e,a.n)).mod(a.n);for(var V=i.mod(a.p).modPow(a.dP,a.p),L=i.mod(a.q).modPow(a.dQ,a.q);V.compareTo(L)<0;)V=V.add(a.p);var O=V.subtract(L).multiply(a.qInv).mod(a.p).multiply(a.q).add(L);return O=O.multiply(D.modInverse(a.n)).mod(a.n),O};x.rsa.encrypt=function(i,a,B){var D=B,V,L=Math.ceil(a.n.bitLength()/8);B!==!1&&B!==!0?(D=B===2,V=g(i,a,B)):(V=r.util.createBuffer(),V.putBytes(i));for(var O=new e(V.toHex(),16),q=u(O,a,D),M=q.toString(16),H=r.util.createBuffer(),Y=L-Math.ceil(M.length/2);Y>0;)H.putByte(0),--Y;return H.putBytes(r.util.hexToBytes(M)),H.getBytes()},x.rsa.decrypt=function(i,a,B,D){var V=Math.ceil(a.n.bitLength()/8);if(i.length!==V){var L=new Error("Encrypted message length is invalid.");throw L.length=i.length,L.expected=V,L}var O=new e(r.util.createBuffer(i).toHex(),16);if(O.compareTo(a.n)>=0)throw new Error("Encrypted message is invalid.");for(var q=u(O,a,B),M=q.toString(16),H=r.util.createBuffer(),Y=V-Math.ceil(M.length/2);Y>0;)H.putByte(0),--Y;return H.putBytes(r.util.hexToBytes(M)),D!==!1?C(H.getBytes(),a,B):H.getBytes()},x.rsa.createKeyPairGenerationState=function(i,a,B){typeof i=="string"&&(i=parseInt(i,10)),i=i||2048,B=B||{};var D=B.prng||r.random,V={nextBytes:function(q){for(var M=D.getBytesSync(q.length),H=0;H<q.length;++H)q[H]=M.charCodeAt(H)}},L=B.algorithm||"PRIMEINC",O;if(L==="PRIMEINC")O={algorithm:L,state:0,bits:i,rng:V,eInt:a||65537,e:new e(null),p:null,q:null,qBits:i>>1,pBits:i-(i>>1),pqState:0,num:null,keys:null},O.e.fromInt(O.eInt);else throw new Error("Invalid key generation algorithm: "+L);return O},x.rsa.stepKeyPairGenerationState=function(i,a){"algorithm"in i||(i.algorithm="PRIMEINC");var B=new e(null);B.fromInt(30);for(var D=0,V=function(X,J){return X|J},L=+new Date,O,q=0;i.keys===null&&(a<=0||q<a);){if(i.state===0){var M=i.p===null?i.pBits:i.qBits,H=M-1;i.pqState===0?(i.num=new e(M,i.rng),i.num.testBit(H)||i.num.bitwiseTo(e.ONE.shiftLeft(H),V,i.num),i.num.dAddOffset(31-i.num.mod(B).byteValue(),0),D=0,++i.pqState):i.pqState===1?i.num.bitLength()>M?i.pqState=0:i.num.isProbablePrime(d(i.num.bitLength()))?++i.pqState:i.num.dAddOffset(c[D++%8],0):i.pqState===2?i.pqState=i.num.subtract(e.ONE).gcd(i.e).compareTo(e.ONE)===0?3:0:i.pqState===3&&(i.pqState=0,i.p===null?i.p=i.num:i.q=i.num,i.p!==null&&i.q!==null&&++i.state,i.num=null)}else if(i.state===1)i.p.compareTo(i.q)<0&&(i.num=i.p,i.p=i.q,i.q=i.num),++i.state;else if(i.state===2)i.p1=i.p.subtract(e.ONE),i.q1=i.q.subtract(e.ONE),i.phi=i.p1.multiply(i.q1),++i.state;else if(i.state===3)i.phi.gcd(i.e).compareTo(e.ONE)===0?++i.state:(i.p=null,i.q=null,i.state=0);else if(i.state===4)i.n=i.p.multiply(i.q),i.n.bitLength()===i.bits?++i.state:(i.q=null,i.state=0);else if(i.state===5){var Y=i.e.modInverse(i.phi);i.keys={privateKey:x.rsa.setPrivateKey(i.n,i.e,Y,i.p,i.q,Y.mod(i.p1),Y.mod(i.q1),i.q.modInverse(i.p)),publicKey:x.rsa.setPublicKey(i.n,i.e)}}O=+new Date,q+=O-L,L=O}return i.keys!==null},x.rsa.generateKeyPair=function(i,a,B,D){if(arguments.length===1?typeof i=="object"?(B=i,i=void 0):typeof i=="function"&&(D=i,i=void 0):arguments.length===2?typeof i=="number"?typeof a=="function"?(D=a,a=void 0):typeof a!="number"&&(B=a,a=void 0):(B=i,D=a,i=void 0,a=void 0):arguments.length===3&&(typeof a=="number"?typeof B=="function"&&(D=B,B=void 0):(D=B,B=a,a=void 0)),B=B||{},i===void 0&&(i=B.bits||2048),a===void 0&&(a=B.e||65537),!r.options.usePureJavaScript&&!B.prng&&i>=256&&i<=16384&&(a===65537||a===3)){if(D){if(v("generateKeyPair"))return n.generateKeyPair("rsa",{modulusLength:i,publicExponent:a,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(q,M,H){if(q)return D(q);D(null,{privateKey:x.privateKeyFromPem(H),publicKey:x.publicKeyFromPem(M)})});if(I("generateKey")&&I("exportKey"))return b.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:i,publicExponent:h(a),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(q){return b.globalScope.crypto.subtle.exportKey("pkcs8",q.privateKey)}).then(void 0,function(q){D(q)}).then(function(q){if(q){var M=x.privateKeyFromAsn1(p.fromDer(r.util.createBuffer(q)));D(null,{privateKey:M,publicKey:x.setRsaPublicKey(M.n,M.e)})}});if(R("generateKey")&&R("exportKey")){var V=b.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:i,publicExponent:h(a),hash:{name:"SHA-256"}},!0,["sign","verify"]);V.oncomplete=function(q){var M=q.target.result,H=b.globalScope.msCrypto.subtle.exportKey("pkcs8",M.privateKey);H.oncomplete=function(Y){var X=Y.target.result,J=x.privateKeyFromAsn1(p.fromDer(r.util.createBuffer(X)));D(null,{privateKey:J,publicKey:x.setRsaPublicKey(J.n,J.e)})},H.onerror=function(Y){D(Y)}},V.onerror=function(q){D(q)};return}}else if(v("generateKeyPairSync")){var L=n.generateKeyPairSync("rsa",{modulusLength:i,publicExponent:a,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:x.privateKeyFromPem(L.privateKey),publicKey:x.publicKeyFromPem(L.publicKey)}}}var O=x.rsa.createKeyPairGenerationState(i,a,B);if(!D)return x.rsa.stepKeyPairGenerationState(O,0),O.keys;m(O,B,D)},x.setRsaPublicKey=x.rsa.setPublicKey=function(i,a){var B={n:i,e:a};return B.encrypt=function(D,V,L){if(typeof V=="string"?V=V.toUpperCase():V===void 0&&(V="RSAES-PKCS1-V1_5"),V==="RSAES-PKCS1-V1_5")V={encode:function(q,M,H){return g(q,M,2).getBytes()}};else if(V==="RSA-OAEP"||V==="RSAES-OAEP")V={encode:function(q,M){return r.pkcs1.encode_rsa_oaep(M,q,L)}};else if(["RAW","NONE","NULL",null].indexOf(V)!==-1)V={encode:function(q){return q}};else if(typeof V=="string")throw new Error('Unsupported encryption scheme: "'+V+'".');var O=V.encode(D,B,!0);return x.rsa.encrypt(O,B,!0)},B.verify=function(D,V,L,O){typeof L=="string"?L=L.toUpperCase():L===void 0&&(L="RSASSA-PKCS1-V1_5"),O===void 0&&(O={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in O||(O._parseAllDigestBytes=!0),L==="RSASSA-PKCS1-V1_5"?L={verify:function(M,H){H=C(H,B,!0);var Y=p.fromDer(H,{parseAllBytes:O._parseAllDigestBytes}),X={},J=[];if(!p.validate(Y,k,X,J)){var ne=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.");throw ne.errors=J,ne}var se=p.derToOid(X.algorithmIdentifier);if(!(se===r.oids.md2||se===r.oids.md5||se===r.oids.sha1||se===r.oids.sha224||se===r.oids.sha256||se===r.oids.sha384||se===r.oids.sha512||se===r.oids["sha512-224"]||se===r.oids["sha512-256"])){var ne=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");throw ne.oid=se,ne}if((se===r.oids.md2||se===r.oids.md5)&&!("parameters"in X))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return M===X.digest}}:(L==="NONE"||L==="NULL"||L===null)&&(L={verify:function(M,H){return H=C(H,B,!0),M===H}});var q=x.rsa.decrypt(V,B,!0,!1);return L.verify(D,q,B.n.bitLength())},B},x.setRsaPrivateKey=x.rsa.setPrivateKey=function(i,a,B,D,V,L,O,q){var M={n:i,e:a,d:B,p:D,q:V,dP:L,dQ:O,qInv:q};return M.decrypt=function(H,Y,X){typeof Y=="string"?Y=Y.toUpperCase():Y===void 0&&(Y="RSAES-PKCS1-V1_5");var J=x.rsa.decrypt(H,M,!1,!1);if(Y==="RSAES-PKCS1-V1_5")Y={decode:C};else if(Y==="RSA-OAEP"||Y==="RSAES-OAEP")Y={decode:function(ne,se){return r.pkcs1.decode_rsa_oaep(se,ne,X)}};else if(["RAW","NONE","NULL",null].indexOf(Y)!==-1)Y={decode:function(ne){return ne}};else throw new Error('Unsupported encryption scheme: "'+Y+'".');return Y.decode(J,M,!1)},M.sign=function(H,Y){var X=!1;typeof Y=="string"&&(Y=Y.toUpperCase()),Y===void 0||Y==="RSASSA-PKCS1-V1_5"?(Y={encode:E},X=1):(Y==="NONE"||Y==="NULL"||Y===null)&&(Y={encode:function(){return H}},X=1);var J=Y.encode(H,M.n.bitLength());return x.rsa.encrypt(J,M,X)},M},x.wrapRsaPrivateKey=function(i){return p.create(p.Class.UNIVERSAL,p.Type.SEQUENCE,!0,[p.create(p.Class.UNIVERSAL,p.Type.INTEGER,!1,p.integerToDer(0).getBytes()),p.create(p.Class.UNIVERSAL,p.Type.SEQUENCE,!0,[p.create(p.Class.UNIVERSAL,p.Type.OID,!1,p.oidToDer(x.oids.rsaEncryption).getBytes()),p.create(p.Class.UNIVERSAL,p.Type.NULL,!1,"")]),p.create(p.Class.UNIVERSAL,p.Type.OCTETSTRING,!1,p.toDer(i).getBytes())])},x.privateKeyFromAsn1=function(i){var a={},B=[];if(p.validate(i,t,a,B)&&(i=p.fromDer(r.util.createBuffer(a.privateKey))),a={},B=[],!p.validate(i,y,a,B)){var D=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw D.errors=B,D}var V,L,O,q,M,H,Y,X;return V=r.util.createBuffer(a.privateKeyModulus).toHex(),L=r.util.createBuffer(a.privateKeyPublicExponent).toHex(),O=r.util.createBuffer(a.privateKeyPrivateExponent).toHex(),q=r.util.createBuffer(a.privateKeyPrime1).toHex(),M=r.util.createBuffer(a.privateKeyPrime2).toHex(),H=r.util.createBuffer(a.privateKeyExponent1).toHex(),Y=r.util.createBuffer(a.privateKeyExponent2).toHex(),X=r.util.createBuffer(a.privateKeyCoefficient).toHex(),x.setRsaPrivateKey(new e(V,16),new e(L,16),new e(O,16),new e(q,16),new e(M,16),new e(H,16),new e(Y,16),new e(X,16))},x.privateKeyToAsn1=x.privateKeyToRSAPrivateKey=function(i){return p.create(p.Class.UNIVERSAL,p.Type.SEQUENCE,!0,[p.create(p.Class.UNIVERSAL,p.Type.INTEGER,!1,p.integerToDer(0).getBytes()),p.create(p.Class.UNIVERSAL,p.Type.INTEGER,!1,s(i.n)),p.create(p.Class.UNIVERSAL,p.Type.INTEGER,!1,s(i.e)),p.create(p.Class.UNIVERSAL,p.Type.INTEGER,!1,s(i.d)),p.create(p.Class.UNIVERSAL,p.Type.INTEGER,!1,s(i.p)),p.create(p.Class.UNIVERSAL,p.Type.INTEGER,!1,s(i.q)),p.create(p.Class.UNIVERSAL,p.Type.INTEGER,!1,s(i.dP)),p.create(p.Class.UNIVERSAL,p.Type.INTEGER,!1,s(i.dQ)),p.create(p.Class.UNIVERSAL,p.Type.INTEGER,!1,s(i.qInv))])},x.publicKeyFromAsn1=function(i){var a={},B=[];if(p.validate(i,S,a,B)){var D=p.derToOid(a.publicKeyOid);if(D!==x.oids.rsaEncryption){var V=new Error("Cannot read public key. Unknown OID.");throw V.oid=D,V}i=a.rsaPublicKey}if(B=[],!p.validate(i,f,a,B)){var V=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw V.errors=B,V}var L=r.util.createBuffer(a.publicKeyModulus).toHex(),O=r.util.createBuffer(a.publicKeyExponent).toHex();return x.setRsaPublicKey(new e(L,16),new e(O,16))},x.publicKeyToAsn1=x.publicKeyToSubjectPublicKeyInfo=function(i){return p.create(p.Class.UNIVERSAL,p.Type.SEQUENCE,!0,[p.create(p.Class.UNIVERSAL,p.Type.SEQUENCE,!0,[p.create(p.Class.UNIVERSAL,p.Type.OID,!1,p.oidToDer(x.oids.rsaEncryption).getBytes()),p.create(p.Class.UNIVERSAL,p.Type.NULL,!1,"")]),p.create(p.Class.UNIVERSAL,p.Type.BITSTRING,!1,[x.publicKeyToRSAPublicKey(i)])])},x.publicKeyToRSAPublicKey=function(i){return p.create(p.Class.UNIVERSAL,p.Type.SEQUENCE,!0,[p.create(p.Class.UNIVERSAL,p.Type.INTEGER,!1,s(i.n)),p.create(p.Class.UNIVERSAL,p.Type.INTEGER,!1,s(i.e))])};function g(i,a,B){var D=r.util.createBuffer(),V=Math.ceil(a.n.bitLength()/8);if(i.length>V-11){var L=new Error("Message is too long for PKCS#1 v1.5 padding.");throw L.length=i.length,L.max=V-11,L}D.putByte(0),D.putByte(B);var O=V-3-i.length,q;if(B===0||B===1){q=B===0?0:255;for(var M=0;M<O;++M)D.putByte(q)}else for(;O>0;){for(var H=0,Y=r.random.getBytes(O),M=0;M<O;++M)q=Y.charCodeAt(M),q===0?++H:D.putByte(q);O=H}return D.putByte(0),D.putBytes(i),D}function C(i,a,B,D){var V=Math.ceil(a.n.bitLength()/8),L=r.util.createBuffer(i),O=L.getByte(),q=L.getByte();if(O!==0||B&&q!==0&&q!==1||!B&&q!=2||B&&q===0&&typeof D>"u")throw new Error("Encryption block is invalid.");var M=0;if(q===0){M=V-3-D;for(var H=0;H<M;++H)if(L.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(q===1)for(M=0;L.length()>1;){if(L.getByte()!==255){--L.read;break}++M}else if(q===2)for(M=0;L.length()>1;){if(L.getByte()===0){--L.read;break}++M}var Y=L.getByte();if(Y!==0||M!==V-3-L.length())throw new Error("Encryption block is invalid.");return L.getBytes()}function m(i,a,B){typeof a=="function"&&(B=a,a={}),a=a||{};var D={algorithm:{name:a.algorithm||"PRIMEINC",options:{workers:a.workers||2,workLoad:a.workLoad||100,workerScript:a.workerScript}}};"prng"in a&&(D.prng=a.prng),V();function V(){L(i.pBits,function(q,M){if(q)return B(q);if(i.p=M,i.q!==null)return O(q,i.q);L(i.qBits,O)})}function L(q,M){r.prime.generateProbablePrime(q,D,M)}function O(q,M){if(q)return B(q);if(i.q=M,i.p.compareTo(i.q)<0){var H=i.p;i.p=i.q,i.q=H}if(i.p.subtract(e.ONE).gcd(i.e).compareTo(e.ONE)!==0){i.p=null,V();return}if(i.q.subtract(e.ONE).gcd(i.e).compareTo(e.ONE)!==0){i.q=null,L(i.qBits,O);return}if(i.p1=i.p.subtract(e.ONE),i.q1=i.q.subtract(e.ONE),i.phi=i.p1.multiply(i.q1),i.phi.gcd(i.e).compareTo(e.ONE)!==0){i.p=i.q=null,V();return}if(i.n=i.p.multiply(i.q),i.n.bitLength()!==i.bits){i.q=null,L(i.qBits,O);return}var Y=i.e.modInverse(i.phi);i.keys={privateKey:x.rsa.setPrivateKey(i.n,i.e,Y,i.p,i.q,Y.mod(i.p1),Y.mod(i.q1),i.q.modInverse(i.p)),publicKey:x.rsa.setPublicKey(i.n,i.e)},B(null,i.keys)}}function s(i){var a=i.toString(16);a[0]>="8"&&(a="00"+a);var B=r.util.hexToBytes(a);return B.length>1&&(B.charCodeAt(0)===0&&(B.charCodeAt(1)&128)===0||B.charCodeAt(0)===255&&(B.charCodeAt(1)&128)===128)?B.substr(1):B}function d(i){return i<=100?27:i<=150?18:i<=200?15:i<=250?12:i<=300?9:i<=350?8:i<=400?7:i<=500?6:i<=600?5:i<=800?4:i<=1250?3:2}function v(i){return r.util.isNodejs&&typeof n[i]=="function"}function I(i){return typeof b.globalScope<"u"&&typeof b.globalScope.crypto=="object"&&typeof b.globalScope.crypto.subtle=="object"&&typeof b.globalScope.crypto.subtle[i]=="function"}function R(i){return typeof b.globalScope<"u"&&typeof b.globalScope.msCrypto=="object"&&typeof b.globalScope.msCrypto.subtle=="object"&&typeof b.globalScope.msCrypto.subtle[i]=="function"}function h(i){for(var a=r.util.hexToBytes(i.toString(16)),B=new Uint8Array(a.length),D=0;D<a.length;++D)B[D]=a.charCodeAt(D);return B}return er}var tr,jr;function $r(){if(jr)return tr;jr=1;var r=ue();if(ot(),et(),yt(),rt(),ut(),Yt(),ft(),Xe(),qr(),xt(),de(),typeof e>"u")var e=r.jsbn.BigInteger;var n=r.asn1,p=r.pki=r.pki||{};tr=p.pbe=r.pbe=r.pbe||{};var b=p.oids,x={name:"EncryptedPrivateKeyInfo",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:n.Class.UNIVERSAL,type:n.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},c={name:"PBES2Algorithms",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:n.Class.UNIVERSAL,type:n.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:n.Class.UNIVERSAL,type:n.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},t={name:"pkcs-12PbeParams",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:n.Class.UNIVERSAL,type:n.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,capture:"iterations"}]};p.encryptPrivateKeyInfo=function(E,u,g){g=g||{},g.saltSize=g.saltSize||8,g.count=g.count||2048,g.algorithm=g.algorithm||"aes128",g.prfAlgorithm=g.prfAlgorithm||"sha1";var C=r.random.getBytesSync(g.saltSize),m=g.count,s=n.integerToDer(m),d,v,I;if(g.algorithm.indexOf("aes")===0||g.algorithm==="des"){var R,h,i;switch(g.algorithm){case"aes128":d=16,R=16,h=b["aes128-CBC"],i=r.aes.createEncryptionCipher;break;case"aes192":d=24,R=16,h=b["aes192-CBC"],i=r.aes.createEncryptionCipher;break;case"aes256":d=32,R=16,h=b["aes256-CBC"],i=r.aes.createEncryptionCipher;break;case"des":d=8,R=8,h=b.desCBC,i=r.des.createEncryptionCipher;break;default:var a=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw a.algorithm=g.algorithm,a}var B="hmacWith"+g.prfAlgorithm.toUpperCase(),D=S(B),V=r.pkcs5.pbkdf2(u,C,m,d,D),L=r.random.getBytesSync(R),O=i(V);O.start(L),O.update(n.toDer(E)),O.finish(),I=O.output.getBytes();var q=k(C,s,d,B);v=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(b.pkcs5PBES2).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(b.pkcs5PBKDF2).getBytes()),q]),n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(h).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,!1,L)])])])}else if(g.algorithm==="3des"){d=24;var M=new r.util.ByteBuffer(C),V=p.pbe.generatePkcs12Key(u,M,1,m,d),L=p.pbe.generatePkcs12Key(u,M,2,m,d),O=r.des.createEncryptionCipher(V);O.start(L),O.update(n.toDer(E)),O.finish(),I=O.output.getBytes(),v=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(b["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,!1,C),n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,s.getBytes())])])}else{var a=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw a.algorithm=g.algorithm,a}var H=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[v,n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,!1,I)]);return H},p.decryptPrivateKeyInfo=function(E,u){var g=null,C={},m=[];if(!n.validate(E,x,C,m)){var s=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=m,s}var d=n.derToOid(C.encryptionOid),v=p.pbe.getCipher(d,C.encryptionParams,u),I=r.util.createBuffer(C.encryptedData);return v.update(I),v.finish()&&(g=n.fromDer(v.output)),g},p.encryptedPrivateKeyToPem=function(E,u){var g={type:"ENCRYPTED PRIVATE KEY",body:n.toDer(E).getBytes()};return r.pem.encode(g,{maxline:u})},p.encryptedPrivateKeyFromPem=function(E){var u=r.pem.decode(E)[0];if(u.type!=="ENCRYPTED PRIVATE KEY"){var g=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw g.headerType=u.type,g}if(u.procType&&u.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return n.fromDer(u.body)},p.encryptRsaPrivateKey=function(E,u,g){if(g=g||{},!g.legacy){var C=p.wrapRsaPrivateKey(p.privateKeyToAsn1(E));return C=p.encryptPrivateKeyInfo(C,u,g),p.encryptedPrivateKeyToPem(C)}var m,s,d,v;switch(g.algorithm){case"aes128":m="AES-128-CBC",d=16,s=r.random.getBytesSync(16),v=r.aes.createEncryptionCipher;break;case"aes192":m="AES-192-CBC",d=24,s=r.random.getBytesSync(16),v=r.aes.createEncryptionCipher;break;case"aes256":m="AES-256-CBC",d=32,s=r.random.getBytesSync(16),v=r.aes.createEncryptionCipher;break;case"3des":m="DES-EDE3-CBC",d=24,s=r.random.getBytesSync(8),v=r.des.createEncryptionCipher;break;case"des":m="DES-CBC",d=8,s=r.random.getBytesSync(8),v=r.des.createEncryptionCipher;break;default:var I=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+g.algorithm+'".');throw I.algorithm=g.algorithm,I}var R=r.pbe.opensslDeriveBytes(u,s.substr(0,8),d),h=v(R);h.start(s),h.update(n.toDer(p.privateKeyToAsn1(E))),h.finish();var i={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:m,parameters:r.util.bytesToHex(s).toUpperCase()},body:h.output.getBytes()};return r.pem.encode(i)},p.decryptRsaPrivateKey=function(E,u){var g=null,C=r.pem.decode(E)[0];if(C.type!=="ENCRYPTED PRIVATE KEY"&&C.type!=="PRIVATE KEY"&&C.type!=="RSA PRIVATE KEY"){var m=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw m.headerType=m,m}if(C.procType&&C.procType.type==="ENCRYPTED"){var s,d;switch(C.dekInfo.algorithm){case"DES-CBC":s=8,d=r.des.createDecryptionCipher;break;case"DES-EDE3-CBC":s=24,d=r.des.createDecryptionCipher;break;case"AES-128-CBC":s=16,d=r.aes.createDecryptionCipher;break;case"AES-192-CBC":s=24,d=r.aes.createDecryptionCipher;break;case"AES-256-CBC":s=32,d=r.aes.createDecryptionCipher;break;case"RC2-40-CBC":s=5,d=function(i){return r.rc2.createDecryptionCipher(i,40)};break;case"RC2-64-CBC":s=8,d=function(i){return r.rc2.createDecryptionCipher(i,64)};break;case"RC2-128-CBC":s=16,d=function(i){return r.rc2.createDecryptionCipher(i,128)};break;default:var m=new Error('Could not decrypt private key; unsupported encryption algorithm "'+C.dekInfo.algorithm+'".');throw m.algorithm=C.dekInfo.algorithm,m}var v=r.util.hexToBytes(C.dekInfo.parameters),I=r.pbe.opensslDeriveBytes(u,v.substr(0,8),s),R=d(I);if(R.start(v),R.update(r.util.createBuffer(C.body)),R.finish())g=R.output.getBytes();else return g}else g=C.body;return C.type==="ENCRYPTED PRIVATE KEY"?g=p.decryptPrivateKeyInfo(n.fromDer(g),u):g=n.fromDer(g),g!==null&&(g=p.privateKeyFromAsn1(g)),g},p.pbe.generatePkcs12Key=function(E,u,g,C,m,s){var d,v;if(typeof s>"u"||s===null){if(!("sha1"in r.md))throw new Error('"sha1" hash algorithm unavailable.');s=r.md.sha1.create()}var I=s.digestLength,R=s.blockLength,h=new r.util.ByteBuffer,i=new r.util.ByteBuffer;if(E!=null){for(v=0;v<E.length;v++)i.putInt16(E.charCodeAt(v));i.putInt16(0)}var a=i.length(),B=u.length(),D=new r.util.ByteBuffer;D.fillWithByte(g,R);var V=R*Math.ceil(B/R),L=new r.util.ByteBuffer;for(v=0;v<V;v++)L.putByte(u.at(v%B));var O=R*Math.ceil(a/R),q=new r.util.ByteBuffer;for(v=0;v<O;v++)q.putByte(i.at(v%a));var M=L;M.putBuffer(q);for(var H=Math.ceil(m/I),Y=1;Y<=H;Y++){var X=new r.util.ByteBuffer;X.putBytes(D.bytes()),X.putBytes(M.bytes());for(var J=0;J<C;J++)s.start(),s.update(X.getBytes()),X=s.digest();var ne=new r.util.ByteBuffer;for(v=0;v<R;v++)ne.putByte(X.at(v%I));var se=Math.ceil(B/R)+Math.ceil(a/R),he=new r.util.ByteBuffer;for(d=0;d<se;d++){var ye=new r.util.ByteBuffer(M.getBytes(R)),j=511;for(v=ne.length()-1;v>=0;v--)j=j>>8,j+=ne.at(v)+ye.at(v),ye.setAt(v,j&255);he.putBuffer(ye)}M=he,h.putBuffer(X)}return h.truncate(h.length()-m),h},p.pbe.getCipher=function(E,u,g){switch(E){case p.oids.pkcs5PBES2:return p.pbe.getCipherForPBES2(E,u,g);case p.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case p.oids["pbewithSHAAnd40BitRC2-CBC"]:return p.pbe.getCipherForPKCS12PBE(E,u,g);default:var C=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw C.oid=E,C.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],C}},p.pbe.getCipherForPBES2=function(E,u,g){var C={},m=[];if(!n.validate(u,c,C,m)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=m,s}if(E=n.derToOid(C.kdfOid),E!==p.oids.pkcs5PBKDF2){var s=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw s.oid=E,s.supportedOids=["pkcs5PBKDF2"],s}if(E=n.derToOid(C.encOid),E!==p.oids["aes128-CBC"]&&E!==p.oids["aes192-CBC"]&&E!==p.oids["aes256-CBC"]&&E!==p.oids["des-EDE3-CBC"]&&E!==p.oids.desCBC){var s=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw s.oid=E,s.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],s}var d=C.kdfSalt,v=r.util.createBuffer(C.kdfIterationCount);v=v.getInt(v.length()<<3);var I,R;switch(p.oids[E]){case"aes128-CBC":I=16,R=r.aes.createDecryptionCipher;break;case"aes192-CBC":I=24,R=r.aes.createDecryptionCipher;break;case"aes256-CBC":I=32,R=r.aes.createDecryptionCipher;break;case"des-EDE3-CBC":I=24,R=r.des.createDecryptionCipher;break;case"desCBC":I=8,R=r.des.createDecryptionCipher;break}var h=f(C.prfOid),i=r.pkcs5.pbkdf2(g,d,v,I,h),a=C.encIv,B=R(i);return B.start(a),B},p.pbe.getCipherForPKCS12PBE=function(E,u,g){var C={},m=[];if(!n.validate(u,t,C,m)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=m,s}var d=r.util.createBuffer(C.salt),v=r.util.createBuffer(C.iterations);v=v.getInt(v.length()<<3);var I,R,h;switch(E){case p.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:I=24,R=8,h=r.des.startDecrypting;break;case p.oids["pbewithSHAAnd40BitRC2-CBC"]:I=5,R=8,h=function(V,L){var O=r.rc2.createDecryptionCipher(V,40);return O.start(L,null),O};break;default:var s=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw s.oid=E,s}var i=f(C.prfOid),a=p.pbe.generatePkcs12Key(g,d,1,v,I,i);i.start();var B=p.pbe.generatePkcs12Key(g,d,2,v,R,i);return h(a,B)},p.pbe.opensslDeriveBytes=function(E,u,g,C){if(typeof C>"u"||C===null){if(!("md5"in r.md))throw new Error('"md5" hash algorithm unavailable.');C=r.md.md5.create()}u===null&&(u="");for(var m=[y(C,E+u)],s=16,d=1;s<g;++d,s+=16)m.push(y(C,m[d-1]+E+u));return m.join("").substr(0,g)};function y(E,u){return E.start().update(u).digest().getBytes()}function f(E){var u;if(!E)u="hmacWithSHA1";else if(u=p.oids[n.derToOid(E)],!u){var g=new Error("Unsupported PRF OID.");throw g.oid=E,g.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],g}return S(u)}function S(E){var u=r.md;switch(E){case"hmacWithSHA224":u=r.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":E=E.substr(8).toLowerCase();break;default:var g=new Error("Unsupported PRF algorithm.");throw g.algorithm=E,g.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],g}if(!u||!(E in u))throw new Error("Unknown hash algorithm: "+E);return u[E].create()}function k(E,u,g,C){var m=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,!1,E),n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,u.getBytes())]);return C!=="hmacWithSHA1"&&m.value.push(n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,r.util.hexToBytes(g.toString(16))),n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(p.oids[C]).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.NULL,!1,"")])),m}return tr}var rr={exports:{}},ar={exports:{}},Jr;function Zr(){if(Jr)return ar.exports;Jr=1;var r=ue();et(),de();var e=r.asn1,n=ar.exports=r.pkcs7asn1=r.pkcs7asn1||{};r.pkcs7=r.pkcs7||{},r.pkcs7.asn1=n;var p={name:"ContentInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};n.contentInfoValidator=p;var b={name:"EncryptedContentInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:e.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};n.envelopedDataValidator={name:"EnvelopedData",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(b)},n.encryptedDataValidator={name:"EncryptedData",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"}].concat(b)};var x={name:"SignerInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1},{name:"SignerInfo.issuerAndSerialNumber",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:e.Class.UNIVERSAL,constructed:!1,captureAsn1:"digestParameter",optional:!0}]},{name:"SignerInfo.authenticatedAttributes",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:e.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,capture:"unauthenticatedAttributes"}]};return n.signedDataValidator={name:"SignedData",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},p,{name:"SignedData.Certificates",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:e.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,capture:"signerInfos",optional:!0,value:[x]}]},n.recipientInfoValidator={name:"RecipientInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:e.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter",optional:!0}]},{name:"RecipientInfo.encryptedKey",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]},ar.exports}var nr={exports:{}},ir={exports:{}},ea;function ta(){if(ea)return ir.exports;ea=1;var r=ue();de(),r.mgf=r.mgf||{};var e=ir.exports=r.mgf.mgf1=r.mgf1=r.mgf1||{};return e.create=function(n){var p={generate:function(b,x){for(var c=new r.util.ByteBuffer,t=Math.ceil(x/n.digestLength),y=0;y<t;y++){var f=new r.util.ByteBuffer;f.putInt32(y),n.start(),n.update(b+f.getBytes()),c.putBuffer(n.digest())}return c.truncate(c.length()-x),c.getBytes()}};return p},ir.exports}var sr,ra;function Ba(){if(ra)return sr;ra=1;var r=ue();return ta(),sr=r.mgf=r.mgf||{},r.mgf.mgf1=r.mgf1,sr}var or={exports:{}},aa;function ur(){if(aa)return or.exports;aa=1;var r=ue();Xe(),de();var e=or.exports=r.pss=r.pss||{};return e.create=function(n){arguments.length===3&&(n={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]});var p=n.md,b=n.mgf,x=p.digestLength,c=n.salt||null;typeof c=="string"&&(c=r.util.createBuffer(c));var t;if("saltLength"in n)t=n.saltLength;else if(c!==null)t=c.length();else throw new Error("Salt length not specified or specific salt not given.");if(c!==null&&c.length()!==t)throw new Error("Given salt length does not match length of given salt.");var y=n.prng||r.random,f={};return f.encode=function(S,k){var E,u=k-1,g=Math.ceil(u/8),C=S.digest().getBytes();if(g<x+t+2)throw new Error("Message is too long to encrypt.");var m;c===null?m=y.getBytesSync(t):m=c.bytes();var s=new r.util.ByteBuffer;s.fillWithByte(0,8),s.putBytes(C),s.putBytes(m),p.start(),p.update(s.getBytes());var d=p.digest().getBytes(),v=new r.util.ByteBuffer;v.fillWithByte(0,g-t-x-2),v.putByte(1),v.putBytes(m);var I=v.getBytes(),R=g-x-1,h=b.generate(d,R),i="";for(E=0;E<R;E++)i+=String.fromCharCode(I.charCodeAt(E)^h.charCodeAt(E));var a=65280>>8*g-u&255;return i=String.fromCharCode(i.charCodeAt(0)&~a)+i.substr(1),i+d+""},f.verify=function(S,k,E){var u,g=E-1,C=Math.ceil(g/8);if(k=k.substr(-C),C<x+t+2)throw new Error("Inconsistent parameters to PSS signature verification.");if(k.charCodeAt(C-1)!==188)throw new Error("Encoded message does not end in 0xBC.");var m=C-x-1,s=k.substr(0,m),d=k.substr(m,x),v=65280>>8*C-g&255;if((s.charCodeAt(0)&v)!==0)throw new Error("Bits beyond keysize not zero as expected.");var I=b.generate(d,m),R="";for(u=0;u<m;u++)R+=String.fromCharCode(s.charCodeAt(u)^I.charCodeAt(u));R=String.fromCharCode(R.charCodeAt(0)&~v)+R.substr(1);var h=C-x-t-2;for(u=0;u<h;u++)if(R.charCodeAt(u)!==0)throw new Error("Leftmost octets not zero as expected");if(R.charCodeAt(h)!==1)throw new Error("Inconsistent PSS signature, 0x01 marker not found");var i=R.substr(-t),a=new r.util.ByteBuffer;a.fillWithByte(0,8),a.putBytes(S),a.putBytes(i),p.start(),p.update(a.getBytes());var B=p.digest().getBytes();return d===B},f},or.exports}var na;function lr(){if(na)return nr.exports;na=1;var r=ue();ot(),et(),yt(),rt(),Ba(),ut(),ft(),ur(),xt(),de();var e=r.asn1,n=nr.exports=r.pki=r.pki||{},p=n.oids,b={};b.CN=p.commonName,b.commonName="CN",b.C=p.countryName,b.countryName="C",b.L=p.localityName,b.localityName="L",b.ST=p.stateOrProvinceName,b.stateOrProvinceName="ST",b.O=p.organizationName,b.organizationName="O",b.OU=p.organizationalUnitName,b.organizationalUnitName="OU",b.E=p.emailAddress,b.emailAddress="E";var x=r.pki.rsa.publicKeyValidator,c={name:"Certificate",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:e.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:e.Class.UNIVERSAL,type:e.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:e.Class.UNIVERSAL,type:e.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:e.Class.UNIVERSAL,type:e.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:e.Class.UNIVERSAL,type:e.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},x,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:e.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:e.Class.UNIVERSAL,type:e.Type.BITSTRING,constructed:!1,captureBitStringValue:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:e.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:e.Class.UNIVERSAL,type:e.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:e.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:e.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:e.Class.UNIVERSAL,type:e.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSignature"}]},t={name:"rsapss",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:e.Class.UNIVERSAL,type:e.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:e.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:e.Class.UNIVERSAL,type:e.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:e.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:e.Class.UNIVERSAL,type:e.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:e.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:e.Class.UNIVERSAL,type:e.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},y={name:"CertificationRequestInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},x,{name:"CertificationRequestInfo.attributes",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0}]}]}]},f={name:"CertificationRequest",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[y,{name:"CertificationRequest.signatureAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:e.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:e.Class.UNIVERSAL,type:e.Type.BITSTRING,constructed:!1,captureBitStringValue:"csrSignature"}]};n.RDNAttributesAsArray=function(h,i){for(var a=[],B,D,V,L=0;L<h.value.length;++L){B=h.value[L];for(var O=0;O<B.value.length;++O)V={},D=B.value[O],V.type=e.derToOid(D.value[0].value),V.value=D.value[1].value,V.valueTagClass=D.value[1].type,V.type in p&&(V.name=p[V.type],V.name in b&&(V.shortName=b[V.name])),i&&(i.update(V.type),i.update(V.value)),a.push(V)}return a},n.CRIAttributesAsArray=function(h){for(var i=[],a=0;a<h.length;++a)for(var B=h[a],D=e.derToOid(B.value[0].value),V=B.value[1].value,L=0;L<V.length;++L){var O={};if(O.type=D,O.value=V[L].value,O.valueTagClass=V[L].type,O.type in p&&(O.name=p[O.type],O.name in b&&(O.shortName=b[O.name])),O.type===p.extensionRequest){O.extensions=[];for(var q=0;q<O.value.length;++q)O.extensions.push(n.certificateExtensionFromAsn1(O.value[q]))}i.push(O)}return i};function S(h,i){typeof i=="string"&&(i={shortName:i});for(var a=null,B,D=0;a===null&&D<h.attributes.length;++D)B=h.attributes[D],(i.type&&i.type===B.type||i.name&&i.name===B.name||i.shortName&&i.shortName===B.shortName)&&(a=B);return a}var k=function(h,i,a){var B={};if(h!==p["RSASSA-PSS"])return B;a&&(B={hash:{algorithmOid:p.sha1},mgf:{algorithmOid:p.mgf1,hash:{algorithmOid:p.sha1}},saltLength:20});var D={},V=[];if(!e.validate(i,t,D,V)){var L=new Error("Cannot read RSASSA-PSS parameter block.");throw L.errors=V,L}return D.hashOid!==void 0&&(B.hash=B.hash||{},B.hash.algorithmOid=e.derToOid(D.hashOid)),D.maskGenOid!==void 0&&(B.mgf=B.mgf||{},B.mgf.algorithmOid=e.derToOid(D.maskGenOid),B.mgf.hash=B.mgf.hash||{},B.mgf.hash.algorithmOid=e.derToOid(D.maskGenHashOid)),D.saltLength!==void 0&&(B.saltLength=D.saltLength.charCodeAt(0)),B},E=function(h){switch(p[h.signatureOid]){case"sha1WithRSAEncryption":case"sha1WithRSASignature":return r.md.sha1.create();case"md5WithRSAEncryption":return r.md.md5.create();case"sha256WithRSAEncryption":return r.md.sha256.create();case"sha384WithRSAEncryption":return r.md.sha384.create();case"sha512WithRSAEncryption":return r.md.sha512.create();case"RSASSA-PSS":return r.md.sha256.create();default:var i=new Error("Could not compute "+h.type+" digest. Unknown signature OID.");throw i.signatureOid=h.signatureOid,i}},u=function(h){var i=h.certificate,a;switch(i.signatureOid){case p.sha1WithRSAEncryption:case p.sha1WithRSASignature:break;case p["RSASSA-PSS"]:var B,D;if(B=p[i.signatureParameters.mgf.hash.algorithmOid],B===void 0||r.md[B]===void 0){var V=new Error("Unsupported MGF hash function.");throw V.oid=i.signatureParameters.mgf.hash.algorithmOid,V.name=B,V}if(D=p[i.signatureParameters.mgf.algorithmOid],D===void 0||r.mgf[D]===void 0){var V=new Error("Unsupported MGF function.");throw V.oid=i.signatureParameters.mgf.algorithmOid,V.name=D,V}if(D=r.mgf[D].create(r.md[B].create()),B=p[i.signatureParameters.hash.algorithmOid],B===void 0||r.md[B]===void 0){var V=new Error("Unsupported RSASSA-PSS hash function.");throw V.oid=i.signatureParameters.hash.algorithmOid,V.name=B,V}a=r.pss.create(r.md[B].create(),D,i.signatureParameters.saltLength);break}return i.publicKey.verify(h.md.digest().getBytes(),h.signature,a)};n.certificateFromPem=function(h,i,a){var B=r.pem.decode(h)[0];if(B.type!=="CERTIFICATE"&&B.type!=="X509 CERTIFICATE"&&B.type!=="TRUSTED CERTIFICATE"){var D=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw D.headerType=B.type,D}if(B.procType&&B.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var V=e.fromDer(B.body,a);return n.certificateFromAsn1(V,i)},n.certificateToPem=function(h,i){var a={type:"CERTIFICATE",body:e.toDer(n.certificateToAsn1(h)).getBytes()};return r.pem.encode(a,{maxline:i})},n.publicKeyFromPem=function(h){var i=r.pem.decode(h)[0];if(i.type!=="PUBLIC KEY"&&i.type!=="RSA PUBLIC KEY"){var a=new Error('Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');throw a.headerType=i.type,a}if(i.procType&&i.procType.type==="ENCRYPTED")throw new Error("Could not convert public key from PEM; PEM is encrypted.");var B=e.fromDer(i.body);return n.publicKeyFromAsn1(B)},n.publicKeyToPem=function(h,i){var a={type:"PUBLIC KEY",body:e.toDer(n.publicKeyToAsn1(h)).getBytes()};return r.pem.encode(a,{maxline:i})},n.publicKeyToRSAPublicKeyPem=function(h,i){var a={type:"RSA PUBLIC KEY",body:e.toDer(n.publicKeyToRSAPublicKey(h)).getBytes()};return r.pem.encode(a,{maxline:i})},n.getPublicKeyFingerprint=function(h,i){i=i||{};var a=i.md||r.md.sha1.create(),B=i.type||"RSAPublicKey",D;switch(B){case"RSAPublicKey":D=e.toDer(n.publicKeyToRSAPublicKey(h)).getBytes();break;case"SubjectPublicKeyInfo":D=e.toDer(n.publicKeyToAsn1(h)).getBytes();break;default:throw new Error('Unknown fingerprint type "'+i.type+'".')}a.start(),a.update(D);var V=a.digest();if(i.encoding==="hex"){var L=V.toHex();return i.delimiter?L.match(/.{2}/g).join(i.delimiter):L}else{if(i.encoding==="binary")return V.getBytes();if(i.encoding)throw new Error('Unknown encoding "'+i.encoding+'".')}return V},n.certificationRequestFromPem=function(h,i,a){var B=r.pem.decode(h)[0];if(B.type!=="CERTIFICATE REQUEST"){var D=new Error('Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".');throw D.headerType=B.type,D}if(B.procType&&B.procType.type==="ENCRYPTED")throw new Error("Could not convert certification request from PEM; PEM is encrypted.");var V=e.fromDer(B.body,a);return n.certificationRequestFromAsn1(V,i)},n.certificationRequestToPem=function(h,i){var a={type:"CERTIFICATE REQUEST",body:e.toDer(n.certificationRequestToAsn1(h)).getBytes()};return r.pem.encode(a,{maxline:i})},n.createCertificate=function(){var h={};return h.version=2,h.serialNumber="00",h.signatureOid=null,h.signature=null,h.siginfo={},h.siginfo.algorithmOid=null,h.validity={},h.validity.notBefore=new Date,h.validity.notAfter=new Date,h.issuer={},h.issuer.getField=function(i){return S(h.issuer,i)},h.issuer.addField=function(i){C([i]),h.issuer.attributes.push(i)},h.issuer.attributes=[],h.issuer.hash=null,h.subject={},h.subject.getField=function(i){return S(h.subject,i)},h.subject.addField=function(i){C([i]),h.subject.attributes.push(i)},h.subject.attributes=[],h.subject.hash=null,h.extensions=[],h.publicKey=null,h.md=null,h.setSubject=function(i,a){C(i),h.subject.attributes=i,delete h.subject.uniqueId,a&&(h.subject.uniqueId=a),h.subject.hash=null},h.setIssuer=function(i,a){C(i),h.issuer.attributes=i,delete h.issuer.uniqueId,a&&(h.issuer.uniqueId=a),h.issuer.hash=null},h.setExtensions=function(i){for(var a=0;a<i.length;++a)m(i[a],{cert:h});h.extensions=i},h.getExtension=function(i){typeof i=="string"&&(i={name:i});for(var a=null,B,D=0;a===null&&D<h.extensions.length;++D)B=h.extensions[D],(i.id&&B.id===i.id||i.name&&B.name===i.name)&&(a=B);return a},h.sign=function(i,a){h.md=a||r.md.sha1.create();var B=p[h.md.algorithm+"WithRSAEncryption"];if(!B){var D=new Error("Could not compute certificate digest. Unknown message digest algorithm OID.");throw D.algorithm=h.md.algorithm,D}h.signatureOid=h.siginfo.algorithmOid=B,h.tbsCertificate=n.getTBSCertificate(h);var V=e.toDer(h.tbsCertificate);h.md.update(V.getBytes()),h.signature=i.sign(h.md)},h.verify=function(i){var a=!1;if(!h.issued(i)){var B=i.issuer,D=h.subject,V=new Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.");throw V.expectedIssuer=D.attributes,V.actualIssuer=B.attributes,V}var L=i.md;if(L===null){L=E({signatureOid:i.signatureOid,type:"certificate"});var O=i.tbsCertificate||n.getTBSCertificate(i),q=e.toDer(O);L.update(q.getBytes())}return L!==null&&(a=u({certificate:h,md:L,signature:i.signature})),a},h.isIssuer=function(i){var a=!1,B=h.issuer,D=i.subject;if(B.hash&&D.hash)a=B.hash===D.hash;else if(B.attributes.length===D.attributes.length){a=!0;for(var V,L,O=0;a&&O<B.attributes.length;++O)V=B.attributes[O],L=D.attributes[O],(V.type!==L.type||V.value!==L.value)&&(a=!1)}return a},h.issued=function(i){return i.isIssuer(h)},h.generateSubjectKeyIdentifier=function(){return n.getPublicKeyFingerprint(h.publicKey,{type:"RSAPublicKey"})},h.verifySubjectKeyIdentifier=function(){for(var i=p.subjectKeyIdentifier,a=0;a<h.extensions.length;++a){var B=h.extensions[a];if(B.id===i){var D=h.generateSubjectKeyIdentifier().getBytes();return r.util.hexToBytes(B.subjectKeyIdentifier)===D}}return!1},h},n.certificateFromAsn1=function(h,i){var a={},B=[];if(!e.validate(h,c,a,B)){var D=new Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.");throw D.errors=B,D}var V=e.derToOid(a.publicKeyOid);if(V!==n.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var L=n.createCertificate();L.version=a.certVersion?a.certVersion.charCodeAt(0):0;var O=r.util.createBuffer(a.certSerialNumber);L.serialNumber=O.toHex(),L.signatureOid=r.asn1.derToOid(a.certSignatureOid),L.signatureParameters=k(L.signatureOid,a.certSignatureParams,!0),L.siginfo.algorithmOid=r.asn1.derToOid(a.certinfoSignatureOid),L.siginfo.parameters=k(L.siginfo.algorithmOid,a.certinfoSignatureParams,!1),L.signature=a.certSignature;var q=[];if(a.certValidity1UTCTime!==void 0&&q.push(e.utcTimeToDate(a.certValidity1UTCTime)),a.certValidity2GeneralizedTime!==void 0&&q.push(e.generalizedTimeToDate(a.certValidity2GeneralizedTime)),a.certValidity3UTCTime!==void 0&&q.push(e.utcTimeToDate(a.certValidity3UTCTime)),a.certValidity4GeneralizedTime!==void 0&&q.push(e.generalizedTimeToDate(a.certValidity4GeneralizedTime)),q.length>2)throw new Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.");if(q.length<2)throw new Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.");if(L.validity.notBefore=q[0],L.validity.notAfter=q[1],L.tbsCertificate=a.tbsCertificate,i){L.md=E({signatureOid:L.signatureOid,type:"certificate"});var M=e.toDer(L.tbsCertificate);L.md.update(M.getBytes())}var H=r.md.sha1.create(),Y=e.toDer(a.certIssuer);H.update(Y.getBytes()),L.issuer.getField=function(ne){return S(L.issuer,ne)},L.issuer.addField=function(ne){C([ne]),L.issuer.attributes.push(ne)},L.issuer.attributes=n.RDNAttributesAsArray(a.certIssuer),a.certIssuerUniqueId&&(L.issuer.uniqueId=a.certIssuerUniqueId),L.issuer.hash=H.digest().toHex();var X=r.md.sha1.create(),J=e.toDer(a.certSubject);return X.update(J.getBytes()),L.subject.getField=function(ne){return S(L.subject,ne)},L.subject.addField=function(ne){C([ne]),L.subject.attributes.push(ne)},L.subject.attributes=n.RDNAttributesAsArray(a.certSubject),a.certSubjectUniqueId&&(L.subject.uniqueId=a.certSubjectUniqueId),L.subject.hash=X.digest().toHex(),a.certExtensions?L.extensions=n.certificateExtensionsFromAsn1(a.certExtensions):L.extensions=[],L.publicKey=n.publicKeyFromAsn1(a.subjectPublicKeyInfo),L},n.certificateExtensionsFromAsn1=function(h){for(var i=[],a=0;a<h.value.length;++a)for(var B=h.value[a],D=0;D<B.value.length;++D)i.push(n.certificateExtensionFromAsn1(B.value[D]));return i},n.certificateExtensionFromAsn1=function(h){var i={};if(i.id=e.derToOid(h.value[0].value),i.critical=!1,h.value[1].type===e.Type.BOOLEAN?(i.critical=h.value[1].value.charCodeAt(0)!==0,i.value=h.value[2].value):i.value=h.value[1].value,i.id in p){if(i.name=p[i.id],i.name==="keyUsage"){var a=e.fromDer(i.value),B=0,D=0;a.value.length>1&&(B=a.value.charCodeAt(1),D=a.value.length>2?a.value.charCodeAt(2):0),i.digitalSignature=(B&128)===128,i.nonRepudiation=(B&64)===64,i.keyEncipherment=(B&32)===32,i.dataEncipherment=(B&16)===16,i.keyAgreement=(B&8)===8,i.keyCertSign=(B&4)===4,i.cRLSign=(B&2)===2,i.encipherOnly=(B&1)===1,i.decipherOnly=(D&128)===128}else if(i.name==="basicConstraints"){var a=e.fromDer(i.value);a.value.length>0&&a.value[0].type===e.Type.BOOLEAN?i.cA=a.value[0].value.charCodeAt(0)!==0:i.cA=!1;var V=null;a.value.length>0&&a.value[0].type===e.Type.INTEGER?V=a.value[0].value:a.value.length>1&&(V=a.value[1].value),V!==null&&(i.pathLenConstraint=e.derToInteger(V))}else if(i.name==="extKeyUsage")for(var a=e.fromDer(i.value),L=0;L<a.value.length;++L){var O=e.derToOid(a.value[L].value);O in p?i[p[O]]=!0:i[O]=!0}else if(i.name==="nsCertType"){var a=e.fromDer(i.value),B=0;a.value.length>1&&(B=a.value.charCodeAt(1)),i.client=(B&128)===128,i.server=(B&64)===64,i.email=(B&32)===32,i.objsign=(B&16)===16,i.reserved=(B&8)===8,i.sslCA=(B&4)===4,i.emailCA=(B&2)===2,i.objCA=(B&1)===1}else if(i.name==="subjectAltName"||i.name==="issuerAltName"){i.altNames=[];for(var q,a=e.fromDer(i.value),M=0;M<a.value.length;++M){q=a.value[M];var H={type:q.type,value:q.value};switch(i.altNames.push(H),q.type){case 1:case 2:case 6:break;case 7:H.ip=r.util.bytesToIP(q.value);break;case 8:H.oid=e.derToOid(q.value);break}}}else if(i.name==="subjectKeyIdentifier"){var a=e.fromDer(i.value);i.subjectKeyIdentifier=r.util.bytesToHex(a.value)}}return i},n.certificationRequestFromAsn1=function(h,i){var a={},B=[];if(!e.validate(h,f,a,B)){var D=new Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.");throw D.errors=B,D}var V=e.derToOid(a.publicKeyOid);if(V!==n.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var L=n.createCertificationRequest();if(L.version=a.csrVersion?a.csrVersion.charCodeAt(0):0,L.signatureOid=r.asn1.derToOid(a.csrSignatureOid),L.signatureParameters=k(L.signatureOid,a.csrSignatureParams,!0),L.siginfo.algorithmOid=r.asn1.derToOid(a.csrSignatureOid),L.siginfo.parameters=k(L.siginfo.algorithmOid,a.csrSignatureParams,!1),L.signature=a.csrSignature,L.certificationRequestInfo=a.certificationRequestInfo,i){L.md=E({signatureOid:L.signatureOid,type:"certification request"});var O=e.toDer(L.certificationRequestInfo);L.md.update(O.getBytes())}var q=r.md.sha1.create();return L.subject.getField=function(M){return S(L.subject,M)},L.subject.addField=function(M){C([M]),L.subject.attributes.push(M)},L.subject.attributes=n.RDNAttributesAsArray(a.certificationRequestInfoSubject,q),L.subject.hash=q.digest().toHex(),L.publicKey=n.publicKeyFromAsn1(a.subjectPublicKeyInfo),L.getAttribute=function(M){return S(L,M)},L.addAttribute=function(M){C([M]),L.attributes.push(M)},L.attributes=n.CRIAttributesAsArray(a.certificationRequestInfoAttributes||[]),L},n.createCertificationRequest=function(){var h={};return h.version=0,h.signatureOid=null,h.signature=null,h.siginfo={},h.siginfo.algorithmOid=null,h.subject={},h.subject.getField=function(i){return S(h.subject,i)},h.subject.addField=function(i){C([i]),h.subject.attributes.push(i)},h.subject.attributes=[],h.subject.hash=null,h.publicKey=null,h.attributes=[],h.getAttribute=function(i){return S(h,i)},h.addAttribute=function(i){C([i]),h.attributes.push(i)},h.md=null,h.setSubject=function(i){C(i),h.subject.attributes=i,h.subject.hash=null},h.setAttributes=function(i){C(i),h.attributes=i},h.sign=function(i,a){h.md=a||r.md.sha1.create();var B=p[h.md.algorithm+"WithRSAEncryption"];if(!B){var D=new Error("Could not compute certification request digest. Unknown message digest algorithm OID.");throw D.algorithm=h.md.algorithm,D}h.signatureOid=h.siginfo.algorithmOid=B,h.certificationRequestInfo=n.getCertificationRequestInfo(h);var V=e.toDer(h.certificationRequestInfo);h.md.update(V.getBytes()),h.signature=i.sign(h.md)},h.verify=function(){var i=!1,a=h.md;if(a===null){a=E({signatureOid:h.signatureOid,type:"certification request"});var B=h.certificationRequestInfo||n.getCertificationRequestInfo(h),D=e.toDer(B);a.update(D.getBytes())}return a!==null&&(i=u({certificate:h,md:a,signature:h.signature})),i},h};function g(h){for(var i=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]),a,B,D=h.attributes,V=0;V<D.length;++V){a=D[V];var L=a.value,O=e.Type.PRINTABLESTRING;"valueTagClass"in a&&(O=a.valueTagClass,O===e.Type.UTF8&&(L=r.util.encodeUtf8(L))),B=e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(a.type).getBytes()),e.create(e.Class.UNIVERSAL,O,!1,L)])]),i.value.push(B)}return i}function C(h){for(var i,a=0;a<h.length;++a){if(i=h[a],typeof i.name>"u"&&(i.type&&i.type in n.oids?i.name=n.oids[i.type]:i.shortName&&i.shortName in b&&(i.name=n.oids[b[i.shortName]])),typeof i.type>"u")if(i.name&&i.name in n.oids)i.type=n.oids[i.name];else{var B=new Error("Attribute type not specified.");throw B.attribute=i,B}if(typeof i.shortName>"u"&&i.name&&i.name in b&&(i.shortName=b[i.name]),i.type===p.extensionRequest&&(i.valueConstructed=!0,i.valueTagClass=e.Type.SEQUENCE,!i.value&&i.extensions)){i.value=[];for(var D=0;D<i.extensions.length;++D)i.value.push(n.certificateExtensionToAsn1(m(i.extensions[D])))}if(typeof i.value>"u"){var B=new Error("Attribute value not specified.");throw B.attribute=i,B}}}function m(h,i){if(i=i||{},typeof h.name>"u"&&h.id&&h.id in n.oids&&(h.name=n.oids[h.id]),typeof h.id>"u")if(h.name&&h.name in n.oids)h.id=n.oids[h.name];else{var a=new Error("Extension ID not specified.");throw a.extension=h,a}if(typeof h.value<"u")return h;if(h.name==="keyUsage"){var B=0,D=0,V=0;h.digitalSignature&&(D|=128,B=7),h.nonRepudiation&&(D|=64,B=6),h.keyEncipherment&&(D|=32,B=5),h.dataEncipherment&&(D|=16,B=4),h.keyAgreement&&(D|=8,B=3),h.keyCertSign&&(D|=4,B=2),h.cRLSign&&(D|=2,B=1),h.encipherOnly&&(D|=1,B=0),h.decipherOnly&&(V|=128,B=7);var L=String.fromCharCode(B);V!==0?L+=String.fromCharCode(D)+String.fromCharCode(V):D!==0&&(L+=String.fromCharCode(D)),h.value=e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,L)}else if(h.name==="basicConstraints")h.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]),h.cA&&h.value.value.push(e.create(e.Class.UNIVERSAL,e.Type.BOOLEAN,!1,"")),"pathLenConstraint"in h&&h.value.value.push(e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(h.pathLenConstraint).getBytes()));else if(h.name==="extKeyUsage"){h.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);var O=h.value.value;for(var q in h)h[q]===!0&&(q in p?O.push(e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(p[q]).getBytes())):q.indexOf(".")!==-1&&O.push(e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(q).getBytes())))}else if(h.name==="nsCertType"){var B=0,D=0;h.client&&(D|=128,B=7),h.server&&(D|=64,B=6),h.email&&(D|=32,B=5),h.objsign&&(D|=16,B=4),h.reserved&&(D|=8,B=3),h.sslCA&&(D|=4,B=2),h.emailCA&&(D|=2,B=1),h.objCA&&(D|=1,B=0);var L=String.fromCharCode(B);D!==0&&(L+=String.fromCharCode(D)),h.value=e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,L)}else if(h.name==="subjectAltName"||h.name==="issuerAltName"){h.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);for(var M,H=0;H<h.altNames.length;++H){M=h.altNames[H];var L=M.value;if(M.type===7&&M.ip){if(L=r.util.bytesFromIP(M.ip),L===null){var a=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw a.extension=h,a}}else M.type===8&&(M.oid?L=e.oidToDer(e.oidToDer(M.oid)):L=e.oidToDer(L));h.value.value.push(e.create(e.Class.CONTEXT_SPECIFIC,M.type,!1,L))}}else if(h.name==="nsComment"&&i.cert){if(!/^[\x00-\x7F]*$/.test(h.comment)||h.comment.length<1||h.comment.length>128)throw new Error('Invalid "nsComment" content.');h.value=e.create(e.Class.UNIVERSAL,e.Type.IA5STRING,!1,h.comment)}else if(h.name==="subjectKeyIdentifier"&&i.cert){var Y=i.cert.generateSubjectKeyIdentifier();h.subjectKeyIdentifier=Y.toHex(),h.value=e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,Y.getBytes())}else if(h.name==="authorityKeyIdentifier"&&i.cert){h.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);var O=h.value.value;if(h.keyIdentifier){var X=h.keyIdentifier===!0?i.cert.generateSubjectKeyIdentifier().getBytes():h.keyIdentifier;O.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!1,X))}if(h.authorityCertIssuer){var J=[e.create(e.Class.CONTEXT_SPECIFIC,4,!0,[g(h.authorityCertIssuer===!0?i.cert.issuer:h.authorityCertIssuer)])];O.push(e.create(e.Class.CONTEXT_SPECIFIC,1,!0,J))}if(h.serialNumber){var ne=r.util.hexToBytes(h.serialNumber===!0?i.cert.serialNumber:h.serialNumber);O.push(e.create(e.Class.CONTEXT_SPECIFIC,2,!1,ne))}}else if(h.name==="cRLDistributionPoints"){h.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);for(var O=h.value.value,se=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]),he=e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[]),M,H=0;H<h.altNames.length;++H){M=h.altNames[H];var L=M.value;if(M.type===7&&M.ip){if(L=r.util.bytesFromIP(M.ip),L===null){var a=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw a.extension=h,a}}else M.type===8&&(M.oid?L=e.oidToDer(e.oidToDer(M.oid)):L=e.oidToDer(L));he.value.push(e.create(e.Class.CONTEXT_SPECIFIC,M.type,!1,L))}se.value.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[he])),O.push(se)}if(typeof h.value>"u"){var a=new Error("Extension value not specified.");throw a.extension=h,a}return h}function s(h,i){switch(h){case p["RSASSA-PSS"]:var a=[];return i.hash.algorithmOid!==void 0&&a.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(i.hash.algorithmOid).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")])])),i.mgf.algorithmOid!==void 0&&a.push(e.create(e.Class.CONTEXT_SPECIFIC,1,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(i.mgf.algorithmOid).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(i.mgf.hash.algorithmOid).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")])])])),i.saltLength!==void 0&&a.push(e.create(e.Class.CONTEXT_SPECIFIC,2,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(i.saltLength).getBytes())])),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,a);default:return e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")}}function d(h){var i=e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[]);if(h.attributes.length===0)return i;for(var a=h.attributes,B=0;B<a.length;++B){var D=a[B],V=D.value,L=e.Type.UTF8;"valueTagClass"in D&&(L=D.valueTagClass),L===e.Type.UTF8&&(V=r.util.encodeUtf8(V));var O=!1;"valueConstructed"in D&&(O=D.valueConstructed);var q=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(D.type).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[e.create(e.Class.UNIVERSAL,L,O,V)])]);i.value.push(q)}return i}var v=new Date("1950-01-01T00:00:00Z"),I=new Date("2050-01-01T00:00:00Z");function R(h){return h>=v&&h<I?e.create(e.Class.UNIVERSAL,e.Type.UTCTIME,!1,e.dateToUtcTime(h)):e.create(e.Class.UNIVERSAL,e.Type.GENERALIZEDTIME,!1,e.dateToGeneralizedTime(h))}return n.getTBSCertificate=function(h){var i=R(h.validity.notBefore),a=R(h.validity.notAfter),B=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(h.version).getBytes())]),e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,r.util.hexToBytes(h.serialNumber)),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(h.siginfo.algorithmOid).getBytes()),s(h.siginfo.algorithmOid,h.siginfo.parameters)]),g(h.issuer),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[i,a]),g(h.subject),n.publicKeyToAsn1(h.publicKey)]);return h.issuer.uniqueId&&B.value.push(e.create(e.Class.CONTEXT_SPECIFIC,1,!0,[e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,"\0"+h.issuer.uniqueId)])),h.subject.uniqueId&&B.value.push(e.create(e.Class.CONTEXT_SPECIFIC,2,!0,[e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,"\0"+h.subject.uniqueId)])),h.extensions.length>0&&B.value.push(n.certificateExtensionsToAsn1(h.extensions)),B},n.getCertificationRequestInfo=function(h){var i=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(h.version).getBytes()),g(h.subject),n.publicKeyToAsn1(h.publicKey),d(h)]);return i},n.distinguishedNameToAsn1=function(h){return g(h)},n.certificateToAsn1=function(h){var i=h.tbsCertificate||n.getTBSCertificate(h);return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[i,e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(h.signatureOid).getBytes()),s(h.signatureOid,h.signatureParameters)]),e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,"\0"+h.signature)])},n.certificateExtensionsToAsn1=function(h){var i=e.create(e.Class.CONTEXT_SPECIFIC,3,!0,[]),a=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);i.value.push(a);for(var B=0;B<h.length;++B)a.value.push(n.certificateExtensionToAsn1(h[B]));return i},n.certificateExtensionToAsn1=function(h){var i=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);i.value.push(e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(h.id).getBytes())),h.critical&&i.value.push(e.create(e.Class.UNIVERSAL,e.Type.BOOLEAN,!1,""));var a=h.value;return typeof h.value!="string"&&(a=e.toDer(a).getBytes()),i.value.push(e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,a)),i},n.certificationRequestToAsn1=function(h){var i=h.certificationRequestInfo||n.getCertificationRequestInfo(h);return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[i,e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(h.signatureOid).getBytes()),s(h.signatureOid,h.signatureParameters)]),e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,"\0"+h.signature)])},n.createCaStore=function(h){var i={certs:{}};i.getIssuer=function(L){var O=a(L.issuer);return O},i.addCertificate=function(L){if(typeof L=="string"&&(L=r.pki.certificateFromPem(L)),B(L.subject),!i.hasCertificate(L))if(L.subject.hash in i.certs){var O=i.certs[L.subject.hash];r.util.isArray(O)||(O=[O]),O.push(L),i.certs[L.subject.hash]=O}else i.certs[L.subject.hash]=L},i.hasCertificate=function(L){typeof L=="string"&&(L=r.pki.certificateFromPem(L));var O=a(L.subject);if(!O)return!1;r.util.isArray(O)||(O=[O]);for(var q=e.toDer(n.certificateToAsn1(L)).getBytes(),M=0;M<O.length;++M){var H=e.toDer(n.certificateToAsn1(O[M])).getBytes();if(q===H)return!0}return!1},i.listAllCertificates=function(){var L=[];for(var O in i.certs)if(i.certs.hasOwnProperty(O)){var q=i.certs[O];if(!r.util.isArray(q))L.push(q);else for(var M=0;M<q.length;++M)L.push(q[M])}return L},i.removeCertificate=function(L){var O;if(typeof L=="string"&&(L=r.pki.certificateFromPem(L)),B(L.subject),!i.hasCertificate(L))return null;var q=a(L.subject);if(!r.util.isArray(q))return O=i.certs[L.subject.hash],delete i.certs[L.subject.hash],O;for(var M=e.toDer(n.certificateToAsn1(L)).getBytes(),H=0;H<q.length;++H){var Y=e.toDer(n.certificateToAsn1(q[H])).getBytes();M===Y&&(O=q[H],q.splice(H,1))}return q.length===0&&delete i.certs[L.subject.hash],O};function a(L){return B(L),i.certs[L.hash]||null}function B(L){if(!L.hash){var O=r.md.sha1.create();L.attributes=n.RDNAttributesAsArray(g(L),O),L.hash=O.digest().toHex()}}if(h)for(var D=0;D<h.length;++D){var V=h[D];i.addCertificate(V)}return i},n.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"},n.verifyCertificateChain=function(h,i,a){typeof a=="function"&&(a={verify:a}),a=a||{},i=i.slice(0);var B=i.slice(0),D=a.validityCheckDate;typeof D>"u"&&(D=new Date);var V=!0,L=null,O=0;do{var q=i.shift(),M=null,H=!1;if(D&&(D<q.validity.notBefore||D>q.validity.notAfter)&&(L={message:"Certificate is not valid yet or has expired.",error:n.certificateError.certificate_expired,notBefore:q.validity.notBefore,notAfter:q.validity.notAfter,now:D}),L===null){if(M=i[0]||h.getIssuer(q),M===null&&q.isIssuer(q)&&(H=!0,M=q),M){var Y=M;r.util.isArray(Y)||(Y=[Y]);for(var X=!1;!X&&Y.length>0;){M=Y.shift();try{X=M.verify(q)}catch{}}X||(L={message:"Certificate signature is invalid.",error:n.certificateError.bad_certificate})}L===null&&(!M||H)&&!h.hasCertificate(q)&&(L={message:"Certificate is not trusted.",error:n.certificateError.unknown_ca})}if(L===null&&M&&!q.isIssuer(M)&&(L={message:"Certificate issuer is invalid.",error:n.certificateError.bad_certificate}),L===null)for(var J={keyUsage:!0,basicConstraints:!0},ne=0;L===null&&ne<q.extensions.length;++ne){var se=q.extensions[ne];se.critical&&!(se.name in J)&&(L={message:"Certificate has an unsupported critical extension.",error:n.certificateError.unsupported_certificate})}if(L===null&&(!V||i.length===0&&(!M||H))){var he=q.getExtension("basicConstraints"),ye=q.getExtension("keyUsage");if(ye!==null&&(!ye.keyCertSign||he===null)&&(L={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:n.certificateError.bad_certificate}),L===null&&he!==null&&!he.cA&&(L={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:n.certificateError.bad_certificate}),L===null&&ye!==null&&"pathLenConstraint"in he){var j=O-1;j>he.pathLenConstraint&&(L={message:"Certificate basicConstraints pathLenConstraint violated.",error:n.certificateError.bad_certificate})}}var le=L===null?!0:L.error,$=a.verify?a.verify(le,O,B):le;if($===!0)L=null;else throw le===!0&&(L={message:"The application rejected the certificate.",error:n.certificateError.bad_certificate}),($||$===0)&&(typeof $=="object"&&!r.util.isArray($)?($.message&&(L.message=$.message),$.error&&(L.error=$.error)):typeof $=="string"&&(L.error=$)),L;V=!1,++O}while(i.length>0);return!0},nr.exports}var ia;function sa(){if(ia)return rr.exports;ia=1;var r=ue();et(),dt(),ut(),Zr(),$r(),Xe(),xt(),pt(),de(),lr();var e=r.asn1,n=r.pki,p=rr.exports=r.pkcs12=r.pkcs12||{},b={name:"ContentInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.contentType",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:e.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"content"}]},x={name:"PFX",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"},b,{name:"PFX.macData",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"mac",value:[{name:"PFX.macData.mac",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"macAlgorithm"},{name:"PFX.macData.mac.digestAlgorithm.parameters",tagClass:e.Class.UNIVERSAL,captureAsn1:"macAlgorithmParameters"}]},{name:"PFX.macData.mac.digest",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"macDigest"}]},{name:"PFX.macData.macSalt",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"macSalt"},{name:"PFX.macData.iterations",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,optional:!0,capture:"macIterations"}]}]},c={name:"SafeBag",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SafeBag.bagId",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"bagId"},{name:"SafeBag.bagValue",tagClass:e.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"bagValue"},{name:"SafeBag.bagAttributes",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0,optional:!0,capture:"bagAttributes"}]},t={name:"Attribute",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"Attribute.attrId",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"oid"},{name:"Attribute.attrValues",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0,capture:"values"}]},y={name:"CertBag",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"CertBag.certId",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"certId"},{name:"CertBag.certValue",tagClass:e.Class.CONTEXT_SPECIFIC,constructed:!0,value:[{name:"CertBag.certValue[0]",tagClass:e.Class.UNIVERSAL,type:e.Class.OCTETSTRING,constructed:!1,capture:"cert"}]}]};function f(C,m,s,d){for(var v=[],I=0;I<C.length;I++)for(var R=0;R<C[I].safeBags.length;R++){var h=C[I].safeBags[R];if(!(d!==void 0&&h.type!==d)){if(m===null){v.push(h);continue}h.attributes[m]!==void 0&&h.attributes[m].indexOf(s)>=0&&v.push(h)}}return v}p.pkcs12FromAsn1=function(C,m,s){typeof m=="string"?(s=m,m=!0):m===void 0&&(m=!0);var d={},v=[];if(!e.validate(C,x,d,v)){var I=new Error("Cannot read PKCS#12 PFX. ASN.1 object is not an PKCS#12 PFX.");throw I.errors=I,I}var R={version:d.version.charCodeAt(0),safeContents:[],getBags:function(M){var H={},Y;return"localKeyId"in M?Y=M.localKeyId:"localKeyIdHex"in M&&(Y=r.util.hexToBytes(M.localKeyIdHex)),Y===void 0&&!("friendlyName"in M)&&"bagType"in M&&(H[M.bagType]=f(R.safeContents,null,null,M.bagType)),Y!==void 0&&(H.localKeyId=f(R.safeContents,"localKeyId",Y,M.bagType)),"friendlyName"in M&&(H.friendlyName=f(R.safeContents,"friendlyName",M.friendlyName,M.bagType)),H},getBagsByFriendlyName:function(M,H){return f(R.safeContents,"friendlyName",M,H)},getBagsByLocalKeyId:function(M,H){return f(R.safeContents,"localKeyId",M,H)}};if(d.version.charCodeAt(0)!==3){var I=new Error("PKCS#12 PFX of version other than 3 not supported.");throw I.version=d.version.charCodeAt(0),I}if(e.derToOid(d.contentType)!==n.oids.data){var I=new Error("Only PKCS#12 PFX in password integrity mode supported.");throw I.oid=e.derToOid(d.contentType),I}var h=d.content.value[0];if(h.tagClass!==e.Class.UNIVERSAL||h.type!==e.Type.OCTETSTRING)throw new Error("PKCS#12 authSafe content data is not an OCTET STRING.");if(h=S(h),d.mac){var i=null,a=0,B=e.derToOid(d.macAlgorithm);switch(B){case n.oids.sha1:i=r.md.sha1.create(),a=20;break;case n.oids.sha256:i=r.md.sha256.create(),a=32;break;case n.oids.sha384:i=r.md.sha384.create(),a=48;break;case n.oids.sha512:i=r.md.sha512.create(),a=64;break;case n.oids.md5:i=r.md.md5.create(),a=16;break}if(i===null)throw new Error("PKCS#12 uses unsupported MAC algorithm: "+B);var D=new r.util.ByteBuffer(d.macSalt),V="macIterations"in d?parseInt(r.util.bytesToHex(d.macIterations),16):1,L=p.generateKey(s,D,3,V,a,i),O=r.hmac.create();O.start(i,L),O.update(h.value);var q=O.getMac();if(q.getBytes()!==d.macDigest)throw new Error("PKCS#12 MAC could not be verified. Invalid password?")}return k(R,h.value,m,s),R};function S(C){if(C.composed||C.constructed){for(var m=r.util.createBuffer(),s=0;s<C.value.length;++s)m.putBytes(C.value[s].value);C.composed=C.constructed=!1,C.value=m.getBytes()}return C}function k(C,m,s,d){if(m=e.fromDer(m,s),m.tagClass!==e.Class.UNIVERSAL||m.type!==e.Type.SEQUENCE||m.constructed!==!0)throw new Error("PKCS#12 AuthenticatedSafe expected to be a SEQUENCE OF ContentInfo");for(var v=0;v<m.value.length;v++){var I=m.value[v],R={},h=[];if(!e.validate(I,b,R,h)){var i=new Error("Cannot read ContentInfo.");throw i.errors=h,i}var a={encrypted:!1},B=null,D=R.content.value[0];switch(e.derToOid(R.contentType)){case n.oids.data:if(D.tagClass!==e.Class.UNIVERSAL||D.type!==e.Type.OCTETSTRING)throw new Error("PKCS#12 SafeContents Data is not an OCTET STRING.");B=S(D).value;break;case n.oids.encryptedData:B=E(D,d),a.encrypted=!0;break;default:var i=new Error("Unsupported PKCS#12 contentType.");throw i.contentType=e.derToOid(R.contentType),i}a.safeBags=u(B,s,d),C.safeContents.push(a)}}function E(C,m){var s={},d=[];if(!e.validate(C,r.pkcs7.asn1.encryptedDataValidator,s,d)){var v=new Error("Cannot read EncryptedContentInfo.");throw v.errors=d,v}var I=e.derToOid(s.contentType);if(I!==n.oids.data){var v=new Error("PKCS#12 EncryptedContentInfo ContentType is not Data.");throw v.oid=I,v}I=e.derToOid(s.encAlgorithm);var R=n.pbe.getCipher(I,s.encParameter,m),h=S(s.encryptedContentAsn1),i=r.util.createBuffer(h.value);if(R.update(i),!R.finish())throw new Error("Failed to decrypt PKCS#12 SafeContents.");return R.output.getBytes()}function u(C,m,s){if(!m&&C.length===0)return[];if(C=e.fromDer(C,m),C.tagClass!==e.Class.UNIVERSAL||C.type!==e.Type.SEQUENCE||C.constructed!==!0)throw new Error("PKCS#12 SafeContents expected to be a SEQUENCE OF SafeBag.");for(var d=[],v=0;v<C.value.length;v++){var I=C.value[v],R={},h=[];if(!e.validate(I,c,R,h)){var i=new Error("Cannot read SafeBag.");throw i.errors=h,i}var a={type:e.derToOid(R.bagId),attributes:g(R.bagAttributes)};d.push(a);var B,D,V=R.bagValue.value[0];switch(a.type){case n.oids.pkcs8ShroudedKeyBag:if(V=n.decryptPrivateKeyInfo(V,s),V===null)throw new Error("Unable to decrypt PKCS#8 ShroudedKeyBag, wrong password?");case n.oids.keyBag:try{a.key=n.privateKeyFromAsn1(V)}catch{a.key=null,a.asn1=V}continue;case n.oids.certBag:B=y,D=function(){if(e.derToOid(R.certId)!==n.oids.x509Certificate){var O=new Error("Unsupported certificate type, only X.509 supported.");throw O.oid=e.derToOid(R.certId),O}var q=e.fromDer(R.cert,m);try{a.cert=n.certificateFromAsn1(q,!0)}catch{a.cert=null,a.asn1=q}};break;default:var i=new Error("Unsupported PKCS#12 SafeBag type.");throw i.oid=a.type,i}if(B!==void 0&&!e.validate(V,B,R,h)){var i=new Error("Cannot read PKCS#12 "+B.name);throw i.errors=h,i}D()}return d}function g(C){var m={};if(C!==void 0)for(var s=0;s<C.length;++s){var d={},v=[];if(!e.validate(C[s],t,d,v)){var I=new Error("Cannot read PKCS#12 BagAttribute.");throw I.errors=v,I}var R=e.derToOid(d.oid);if(n.oids[R]!==void 0){m[n.oids[R]]=[];for(var h=0;h<d.values.length;++h)m[n.oids[R]].push(d.values[h].value)}}return m}return p.toPkcs12Asn1=function(C,m,s,d){d=d||{},d.saltSize=d.saltSize||8,d.count=d.count||2048,d.algorithm=d.algorithm||d.encAlgorithm||"aes128","useMac"in d||(d.useMac=!0),"localKeyId"in d||(d.localKeyId=null),"generateLocalKeyId"in d||(d.generateLocalKeyId=!0);var v=d.localKeyId,I;if(v!==null)v=r.util.hexToBytes(v);else if(d.generateLocalKeyId)if(m){var R=r.util.isArray(m)?m[0]:m;typeof R=="string"&&(R=n.certificateFromPem(R));var h=r.md.sha1.create();h.update(e.toDer(n.certificateToAsn1(R)).getBytes()),v=h.digest().getBytes()}else v=r.random.getBytes(20);var i=[];v!==null&&i.push(e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(n.oids.localKeyId).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,v)])])),"friendlyName"in d&&i.push(e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(n.oids.friendlyName).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[e.create(e.Class.UNIVERSAL,e.Type.BMPSTRING,!1,d.friendlyName)])])),i.length>0&&(I=e.create(e.Class.UNIVERSAL,e.Type.SET,!0,i));var a=[],B=[];m!==null&&(r.util.isArray(m)?B=m:B=[m]);for(var D=[],V=0;V<B.length;++V){m=B[V],typeof m=="string"&&(m=n.certificateFromPem(m));var L=V===0?I:void 0,O=n.certificateToAsn1(m),q=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(n.oids.certBag).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(n.oids.x509Certificate).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,e.toDer(O).getBytes())])])]),L]);D.push(q)}if(D.length>0){var M=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,D),H=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(n.oids.data).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,e.toDer(M).getBytes())])]);a.push(H)}var Y=null;if(C!==null){var X=n.wrapRsaPrivateKey(n.privateKeyToAsn1(C));s===null?Y=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(n.oids.keyBag).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[X]),I]):Y=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(n.oids.pkcs8ShroudedKeyBag).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[n.encryptPrivateKeyInfo(X,s,d)]),I]);var J=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[Y]),ne=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(n.oids.data).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,e.toDer(J).getBytes())])]);a.push(ne)}var se=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,a),he;if(d.useMac){var h=r.md.sha1.create(),ye=new r.util.ByteBuffer(r.random.getBytes(d.saltSize)),j=d.count,C=p.generateKey(s,ye,3,j,20),le=r.hmac.create();le.start(h,C),le.update(e.toDer(se).getBytes());var $=le.getMac();he=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(n.oids.sha1).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")]),e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,$.getBytes())]),e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,ye.getBytes()),e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(j).getBytes())])}return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(3).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(n.oids.data).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,e.toDer(se).getBytes())])]),he])},p.generateKey=r.pbe.generatePkcs12Key,rr.exports}var oa;function ua(){if(oa)return Ht.exports;oa=1;var r=ue();et(),ut(),$r(),ft(),Yt(),sa(),ur(),xt(),de(),lr();var e=r.asn1,n=Ht.exports=r.pki=r.pki||{};return n.pemToDer=function(p){var b=r.pem.decode(p)[0];if(b.procType&&b.procType.type==="ENCRYPTED")throw new Error("Could not convert PEM to DER; PEM is encrypted.");return r.util.createBuffer(b.body)},n.privateKeyFromPem=function(p){var b=r.pem.decode(p)[0];if(b.type!=="PRIVATE KEY"&&b.type!=="RSA PRIVATE KEY"){var x=new Error('Could not convert private key from PEM; PEM header type is not "PRIVATE KEY" or "RSA PRIVATE KEY".');throw x.headerType=b.type,x}if(b.procType&&b.procType.type==="ENCRYPTED")throw new Error("Could not convert private key from PEM; PEM is encrypted.");var c=e.fromDer(b.body);return n.privateKeyFromAsn1(c)},n.privateKeyToPem=function(p,b){var x={type:"RSA PRIVATE KEY",body:e.toDer(n.privateKeyToAsn1(p)).getBytes()};return r.pem.encode(x,{maxline:b})},n.privateKeyInfoToPem=function(p,b){var x={type:"PRIVATE KEY",body:e.toDer(p).getBytes()};return r.pem.encode(x,{maxline:b})},Ht.exports}var fr,la;function fa(){if(la)return fr;la=1;var r=ue();et(),dt(),Mt(),ft(),ua(),Xe(),pt(),de();var e=function(l,w,N,o){var A=r.util.createBuffer(),K=l.length>>1,P=K+(l.length&1),z=l.substr(0,P),ee=l.substr(K,P),ae=r.util.createBuffer(),G=r.hmac.create();N=w+N;var te=Math.ceil(o/16),ie=Math.ceil(o/20);G.start("MD5",z);var ce=r.util.createBuffer();ae.putBytes(N);for(var oe=0;oe<te;++oe)G.start(null,null),G.update(ae.getBytes()),ae.putBuffer(G.digest()),G.start(null,null),G.update(ae.bytes()+N),ce.putBuffer(G.digest());G.start("SHA1",ee);var me=r.util.createBuffer();ae.clear(),ae.putBytes(N);for(var oe=0;oe<ie;++oe)G.start(null,null),G.update(ae.getBytes()),ae.putBuffer(G.digest()),G.start(null,null),G.update(ae.bytes()+N),me.putBuffer(G.digest());return A.putBytes(r.util.xorBytes(ce.getBytes(),me.getBytes(),o)),A},n=function(l,w,N){var o=r.hmac.create();o.start("SHA1",l);var A=r.util.createBuffer();return A.putInt32(w[0]),A.putInt32(w[1]),A.putByte(N.type),A.putByte(N.version.major),A.putByte(N.version.minor),A.putInt16(N.length),A.putBytes(N.fragment.bytes()),o.update(A.getBytes()),o.digest().getBytes()},p=function(l,w,N){var o=!1;try{var A=l.deflate(w.fragment.getBytes());w.fragment=r.util.createBuffer(A),w.length=A.length,o=!0}catch{}return o},b=function(l,w,N){var o=!1;try{var A=l.inflate(w.fragment.getBytes());w.fragment=r.util.createBuffer(A),w.length=A.length,o=!0}catch{}return o},x=function(l,w){var N=0;switch(w){case 1:N=l.getByte();break;case 2:N=l.getInt16();break;case 3:N=l.getInt24();break;case 4:N=l.getInt32();break}return r.util.createBuffer(l.getBytes(N))},c=function(l,w,N){l.putInt(N.length(),w<<3),l.putBuffer(N)},t={};t.Versions={TLS_1_0:{major:3,minor:1},TLS_1_1:{major:3,minor:2},TLS_1_2:{major:3,minor:3}},t.SupportedVersions=[t.Versions.TLS_1_1,t.Versions.TLS_1_0],t.Version=t.SupportedVersions[0],t.MaxFragment=15360,t.ConnectionEnd={server:0,client:1},t.PRFAlgorithm={tls_prf_sha256:0},t.BulkCipherAlgorithm={none:null,rc4:0,des3:1,aes:2},t.CipherType={stream:0,block:1,aead:2},t.MACAlgorithm={none:null,hmac_md5:0,hmac_sha1:1,hmac_sha256:2,hmac_sha384:3,hmac_sha512:4},t.CompressionMethod={none:0,deflate:1},t.ContentType={change_cipher_spec:20,alert:21,handshake:22,application_data:23,heartbeat:24},t.HandshakeType={hello_request:0,client_hello:1,server_hello:2,certificate:11,server_key_exchange:12,certificate_request:13,server_hello_done:14,certificate_verify:15,client_key_exchange:16,finished:20},t.Alert={},t.Alert.Level={warning:1,fatal:2},t.Alert.Description={close_notify:0,unexpected_message:10,bad_record_mac:20,decryption_failed:21,record_overflow:22,decompression_failure:30,handshake_failure:40,bad_certificate:42,unsupported_certificate:43,certificate_revoked:44,certificate_expired:45,certificate_unknown:46,illegal_parameter:47,unknown_ca:48,access_denied:49,decode_error:50,decrypt_error:51,export_restriction:60,protocol_version:70,insufficient_security:71,internal_error:80,user_canceled:90,no_renegotiation:100},t.HeartbeatMessageType={heartbeat_request:1,heartbeat_response:2},t.CipherSuites={},t.getCipherSuite=function(l){var w=null;for(var N in t.CipherSuites){var o=t.CipherSuites[N];if(o.id[0]===l.charCodeAt(0)&&o.id[1]===l.charCodeAt(1)){w=o;break}}return w},t.handleUnexpected=function(l,w){var N=!l.open&&l.entity===t.ConnectionEnd.client;N||l.error(l,{message:"Unexpected message. Received TLS record out of order.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.unexpected_message}})},t.handleHelloRequest=function(l,w,N){!l.handshaking&&l.handshakes>0&&(t.queue(l,t.createAlert(l,{level:t.Alert.Level.warning,description:t.Alert.Description.no_renegotiation})),t.flush(l)),l.process()},t.parseHelloMessage=function(l,w,N){var o=null,A=l.entity===t.ConnectionEnd.client;if(N<38)l.error(l,{message:A?"Invalid ServerHello message. Message too short.":"Invalid ClientHello message. Message too short.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.illegal_parameter}});else{var K=w.fragment,P=K.length();if(o={version:{major:K.getByte(),minor:K.getByte()},random:r.util.createBuffer(K.getBytes(32)),session_id:x(K,1),extensions:[]},A?(o.cipher_suite=K.getBytes(2),o.compression_method=K.getByte()):(o.cipher_suites=x(K,2),o.compression_methods=x(K,1)),P=N-(P-K.length()),P>0){for(var z=x(K,2);z.length()>0;)o.extensions.push({type:[z.getByte(),z.getByte()],data:x(z,2)});if(!A)for(var ee=0;ee<o.extensions.length;++ee){var ae=o.extensions[ee];if(ae.type[0]===0&&ae.type[1]===0)for(var G=x(ae.data,2);G.length()>0;){var te=G.getByte();if(te!==0)break;l.session.extensions.server_name.serverNameList.push(x(G,2).getBytes())}}}if(l.session.version&&(o.version.major!==l.session.version.major||o.version.minor!==l.session.version.minor))return l.error(l,{message:"TLS version change is disallowed during renegotiation.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.protocol_version}});if(A)l.session.cipherSuite=t.getCipherSuite(o.cipher_suite);else for(var ie=r.util.createBuffer(o.cipher_suites.bytes());ie.length()>0&&(l.session.cipherSuite=t.getCipherSuite(ie.getBytes(2)),l.session.cipherSuite===null););if(l.session.cipherSuite===null)return l.error(l,{message:"No cipher suites in common.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.handshake_failure},cipherSuite:r.util.bytesToHex(o.cipher_suite)});A?l.session.compressionMethod=o.compression_method:l.session.compressionMethod=t.CompressionMethod.none}return o},t.createSecurityParameters=function(l,w){var N=l.entity===t.ConnectionEnd.client,o=w.random.bytes(),A=N?l.session.sp.client_random:o,K=N?o:t.createRandom().getBytes();l.session.sp={entity:l.entity,prf_algorithm:t.PRFAlgorithm.tls_prf_sha256,bulk_cipher_algorithm:null,cipher_type:null,enc_key_length:null,block_length:null,fixed_iv_length:null,record_iv_length:null,mac_algorithm:null,mac_length:null,mac_key_length:null,compression_algorithm:l.session.compressionMethod,pre_master_secret:null,master_secret:null,client_random:A,server_random:K}},t.handleServerHello=function(l,w,N){var o=t.parseHelloMessage(l,w,N);if(!l.fail){if(o.version.minor<=l.version.minor)l.version.minor=o.version.minor;else return l.error(l,{message:"Incompatible TLS version.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.protocol_version}});l.session.version=l.version;var A=o.session_id.bytes();A.length>0&&A===l.session.id?(l.expect=u,l.session.resuming=!0,l.session.sp.server_random=o.random.bytes()):(l.expect=f,l.session.resuming=!1,t.createSecurityParameters(l,o)),l.session.id=A,l.process()}},t.handleClientHello=function(l,w,N){var o=t.parseHelloMessage(l,w,N);if(!l.fail){var A=o.session_id.bytes(),K=null;if(l.sessionCache&&(K=l.sessionCache.getSession(A),K===null?A="":(K.version.major!==o.version.major||K.version.minor>o.version.minor)&&(K=null,A="")),A.length===0&&(A=r.random.getBytes(32)),l.session.id=A,l.session.clientHelloVersion=o.version,l.session.sp={},K)l.version=l.session.version=K.version,l.session.sp=K.sp;else{for(var P,z=1;z<t.SupportedVersions.length&&(P=t.SupportedVersions[z],!(P.minor<=o.version.minor));++z);l.version={major:P.major,minor:P.minor},l.session.version=l.version}K!==null?(l.expect=R,l.session.resuming=!0,l.session.sp.client_random=o.random.bytes()):(l.expect=l.verifyClient!==!1?d:v,l.session.resuming=!1,t.createSecurityParameters(l,o)),l.open=!0,t.queue(l,t.createRecord(l,{type:t.ContentType.handshake,data:t.createServerHello(l)})),l.session.resuming?(t.queue(l,t.createRecord(l,{type:t.ContentType.change_cipher_spec,data:t.createChangeCipherSpec()})),l.state.pending=t.createConnectionState(l),l.state.current.write=l.state.pending.write,t.queue(l,t.createRecord(l,{type:t.ContentType.handshake,data:t.createFinished(l)}))):(t.queue(l,t.createRecord(l,{type:t.ContentType.handshake,data:t.createCertificate(l)})),l.fail||(t.queue(l,t.createRecord(l,{type:t.ContentType.handshake,data:t.createServerKeyExchange(l)})),l.verifyClient!==!1&&t.queue(l,t.createRecord(l,{type:t.ContentType.handshake,data:t.createCertificateRequest(l)})),t.queue(l,t.createRecord(l,{type:t.ContentType.handshake,data:t.createServerHelloDone(l)})))),t.flush(l),l.process()}},t.handleCertificate=function(l,w,N){if(N<3)return l.error(l,{message:"Invalid Certificate message. Message too short.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.illegal_parameter}});var o=w.fragment,A={certificate_list:x(o,3)},K,P,z=[];try{for(;A.certificate_list.length()>0;)K=x(A.certificate_list,3),P=r.asn1.fromDer(K),K=r.pki.certificateFromAsn1(P,!0),z.push(K)}catch(ae){return l.error(l,{message:"Could not parse certificate list.",cause:ae,send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.bad_certificate}})}var ee=l.entity===t.ConnectionEnd.client;(ee||l.verifyClient===!0)&&z.length===0?l.error(l,{message:ee?"No server certificate provided.":"No client certificate provided.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.illegal_parameter}}):z.length===0?l.expect=ee?S:v:(ee?l.session.serverCertificate=z[0]:l.session.clientCertificate=z[0],t.verifyCertificateChain(l,z)&&(l.expect=ee?S:v)),l.process()},t.handleServerKeyExchange=function(l,w,N){if(N>0)return l.error(l,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.unsupported_certificate}});l.expect=k,l.process()},t.handleClientKeyExchange=function(l,w,N){if(N<48)return l.error(l,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.unsupported_certificate}});var o=w.fragment,A={enc_pre_master_secret:x(o,2).getBytes()},K=null;if(l.getPrivateKey)try{K=l.getPrivateKey(l,l.session.serverCertificate),K=r.pki.privateKeyFromPem(K)}catch(ee){l.error(l,{message:"Could not get private key.",cause:ee,send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.internal_error}})}if(K===null)return l.error(l,{message:"No private key set.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.internal_error}});try{var P=l.session.sp;P.pre_master_secret=K.decrypt(A.enc_pre_master_secret);var z=l.session.clientHelloVersion;if(z.major!==P.pre_master_secret.charCodeAt(0)||z.minor!==P.pre_master_secret.charCodeAt(1))throw new Error("TLS version rollback attack detected.")}catch{P.pre_master_secret=r.random.getBytes(48)}l.expect=R,l.session.clientCertificate!==null&&(l.expect=I),l.process()},t.handleCertificateRequest=function(l,w,N){if(N<3)return l.error(l,{message:"Invalid CertificateRequest. Message too short.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.illegal_parameter}});var o=w.fragment,A={certificate_types:x(o,1),certificate_authorities:x(o,2)};l.session.certificateRequest=A,l.expect=E,l.process()},t.handleCertificateVerify=function(l,w,N){if(N<2)return l.error(l,{message:"Invalid CertificateVerify. Message too short.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.illegal_parameter}});var o=w.fragment;o.read-=4;var A=o.bytes();o.read+=4;var K={signature:x(o,2).getBytes()},P=r.util.createBuffer();P.putBuffer(l.session.md5.digest()),P.putBuffer(l.session.sha1.digest()),P=P.getBytes();try{var z=l.session.clientCertificate;if(!z.publicKey.verify(P,K.signature,"NONE"))throw new Error("CertificateVerify signature does not match.");l.session.md5.update(A),l.session.sha1.update(A)}catch{return l.error(l,{message:"Bad signature in CertificateVerify.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.handshake_failure}})}l.expect=R,l.process()},t.handleServerHelloDone=function(l,w,N){if(N>0)return l.error(l,{message:"Invalid ServerHelloDone message. Invalid length.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.record_overflow}});if(l.serverCertificate===null){var o={message:"No server certificate provided. Not enough security.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.insufficient_security}},A=0,K=l.verify(l,o.alert.description,A,[]);if(K!==!0)return(K||K===0)&&(typeof K=="object"&&!r.util.isArray(K)?(K.message&&(o.message=K.message),K.alert&&(o.alert.description=K.alert)):typeof K=="number"&&(o.alert.description=K)),l.error(l,o)}l.session.certificateRequest!==null&&(w=t.createRecord(l,{type:t.ContentType.handshake,data:t.createCertificate(l)}),t.queue(l,w)),w=t.createRecord(l,{type:t.ContentType.handshake,data:t.createClientKeyExchange(l)}),t.queue(l,w),l.expect=m;var P=function(z,ee){z.session.certificateRequest!==null&&z.session.clientCertificate!==null&&t.queue(z,t.createRecord(z,{type:t.ContentType.handshake,data:t.createCertificateVerify(z,ee)})),t.queue(z,t.createRecord(z,{type:t.ContentType.change_cipher_spec,data:t.createChangeCipherSpec()})),z.state.pending=t.createConnectionState(z),z.state.current.write=z.state.pending.write,t.queue(z,t.createRecord(z,{type:t.ContentType.handshake,data:t.createFinished(z)})),z.expect=u,t.flush(z),z.process()};if(l.session.certificateRequest===null||l.session.clientCertificate===null)return P(l,null);t.getClientSignature(l,P)},t.handleChangeCipherSpec=function(l,w){if(w.fragment.getByte()!==1)return l.error(l,{message:"Invalid ChangeCipherSpec message received.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.illegal_parameter}});var N=l.entity===t.ConnectionEnd.client;(l.session.resuming&&N||!l.session.resuming&&!N)&&(l.state.pending=t.createConnectionState(l)),l.state.current.read=l.state.pending.read,(!l.session.resuming&&N||l.session.resuming&&!N)&&(l.state.pending=null),l.expect=N?g:h,l.process()},t.handleFinished=function(l,w,N){var o=w.fragment;o.read-=4;var A=o.bytes();o.read+=4;var K=w.fragment.getBytes();o=r.util.createBuffer(),o.putBuffer(l.session.md5.digest()),o.putBuffer(l.session.sha1.digest());var P=l.entity===t.ConnectionEnd.client,z=P?"server finished":"client finished",ee=l.session.sp,ae=12,G=e;if(o=G(ee.master_secret,z,o.getBytes(),ae),o.getBytes()!==K)return l.error(l,{message:"Invalid verify_data in Finished message.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.decrypt_error}});l.session.md5.update(A),l.session.sha1.update(A),(l.session.resuming&&P||!l.session.resuming&&!P)&&(t.queue(l,t.createRecord(l,{type:t.ContentType.change_cipher_spec,data:t.createChangeCipherSpec()})),l.state.current.write=l.state.pending.write,l.state.pending=null,t.queue(l,t.createRecord(l,{type:t.ContentType.handshake,data:t.createFinished(l)}))),l.expect=P?C:i,l.handshaking=!1,++l.handshakes,l.peerCertificate=P?l.session.serverCertificate:l.session.clientCertificate,t.flush(l),l.isConnected=!0,l.connected(l),l.process()},t.handleAlert=function(l,w){var N=w.fragment,o={level:N.getByte(),description:N.getByte()},A;switch(o.description){case t.Alert.Description.close_notify:A="Connection closed.";break;case t.Alert.Description.unexpected_message:A="Unexpected message.";break;case t.Alert.Description.bad_record_mac:A="Bad record MAC.";break;case t.Alert.Description.decryption_failed:A="Decryption failed.";break;case t.Alert.Description.record_overflow:A="Record overflow.";break;case t.Alert.Description.decompression_failure:A="Decompression failed.";break;case t.Alert.Description.handshake_failure:A="Handshake failure.";break;case t.Alert.Description.bad_certificate:A="Bad certificate.";break;case t.Alert.Description.unsupported_certificate:A="Unsupported certificate.";break;case t.Alert.Description.certificate_revoked:A="Certificate revoked.";break;case t.Alert.Description.certificate_expired:A="Certificate expired.";break;case t.Alert.Description.certificate_unknown:A="Certificate unknown.";break;case t.Alert.Description.illegal_parameter:A="Illegal parameter.";break;case t.Alert.Description.unknown_ca:A="Unknown certificate authority.";break;case t.Alert.Description.access_denied:A="Access denied.";break;case t.Alert.Description.decode_error:A="Decode error.";break;case t.Alert.Description.decrypt_error:A="Decrypt error.";break;case t.Alert.Description.export_restriction:A="Export restriction.";break;case t.Alert.Description.protocol_version:A="Unsupported protocol version.";break;case t.Alert.Description.insufficient_security:A="Insufficient security.";break;case t.Alert.Description.internal_error:A="Internal error.";break;case t.Alert.Description.user_canceled:A="User canceled.";break;case t.Alert.Description.no_renegotiation:A="Renegotiation not supported.";break;default:A="Unknown error.";break}if(o.description===t.Alert.Description.close_notify)return l.close();l.error(l,{message:A,send:!1,origin:l.entity===t.ConnectionEnd.client?"server":"client",alert:o}),l.process()},t.handleHandshake=function(l,w){var N=w.fragment,o=N.getByte(),A=N.getInt24();if(A>N.length())return l.fragmented=w,w.fragment=r.util.createBuffer(),N.read-=4,l.process();l.fragmented=null,N.read-=4;var K=N.bytes(A+4);N.read+=4,o in he[l.entity][l.expect]?(l.entity===t.ConnectionEnd.server&&!l.open&&!l.fail&&(l.handshaking=!0,l.session={version:null,extensions:{server_name:{serverNameList:[]}},cipherSuite:null,compressionMethod:null,serverCertificate:null,clientCertificate:null,md5:r.md.md5.create(),sha1:r.md.sha1.create()}),o!==t.HandshakeType.hello_request&&o!==t.HandshakeType.certificate_verify&&o!==t.HandshakeType.finished&&(l.session.md5.update(K),l.session.sha1.update(K)),he[l.entity][l.expect][o](l,w,A)):t.handleUnexpected(l,w)},t.handleApplicationData=function(l,w){l.data.putBuffer(w.fragment),l.dataReady(l),l.process()},t.handleHeartbeat=function(l,w){var N=w.fragment,o=N.getByte(),A=N.getInt16(),K=N.getBytes(A);if(o===t.HeartbeatMessageType.heartbeat_request){if(l.handshaking||A>K.length)return l.process();t.queue(l,t.createRecord(l,{type:t.ContentType.heartbeat,data:t.createHeartbeat(t.HeartbeatMessageType.heartbeat_response,K)})),t.flush(l)}else if(o===t.HeartbeatMessageType.heartbeat_response){if(K!==l.expectedHeartbeatPayload)return l.process();l.heartbeatReceived&&l.heartbeatReceived(l,r.util.createBuffer(K))}l.process()};var y=0,f=1,S=2,k=3,E=4,u=5,g=6,C=7,m=8,s=0,d=1,v=2,I=3,R=4,h=5,i=6,a=t.handleUnexpected,B=t.handleChangeCipherSpec,D=t.handleAlert,V=t.handleHandshake,L=t.handleApplicationData,O=t.handleHeartbeat,q=[];q[t.ConnectionEnd.client]=[[a,D,V,a,O],[a,D,V,a,O],[a,D,V,a,O],[a,D,V,a,O],[a,D,V,a,O],[B,D,a,a,O],[a,D,V,a,O],[a,D,V,L,O],[a,D,V,a,O]],q[t.ConnectionEnd.server]=[[a,D,V,a,O],[a,D,V,a,O],[a,D,V,a,O],[a,D,V,a,O],[B,D,a,a,O],[a,D,V,a,O],[a,D,V,L,O],[a,D,V,a,O]];var M=t.handleHelloRequest,H=t.handleServerHello,Y=t.handleCertificate,X=t.handleServerKeyExchange,J=t.handleCertificateRequest,ne=t.handleServerHelloDone,se=t.handleFinished,he=[];he[t.ConnectionEnd.client]=[[a,a,H,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a],[M,a,a,a,a,a,a,a,a,a,a,Y,X,J,ne,a,a,a,a,a,a],[M,a,a,a,a,a,a,a,a,a,a,a,X,J,ne,a,a,a,a,a,a],[M,a,a,a,a,a,a,a,a,a,a,a,a,J,ne,a,a,a,a,a,a],[M,a,a,a,a,a,a,a,a,a,a,a,a,a,ne,a,a,a,a,a,a],[M,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a],[M,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,se],[M,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a],[M,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a]];var ye=t.handleClientHello,j=t.handleClientKeyExchange,le=t.handleCertificateVerify;he[t.ConnectionEnd.server]=[[a,ye,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a],[a,a,a,a,a,a,a,a,a,a,a,Y,a,a,a,a,a,a,a,a,a],[a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,j,a,a,a,a],[a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,le,a,a,a,a,a],[a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a],[a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,se],[a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a],[a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a]],t.generateKeys=function(l,w){var N=e,o=w.client_random+w.server_random;l.session.resuming||(w.master_secret=N(w.pre_master_secret,"master secret",o,48).bytes(),w.pre_master_secret=null),o=w.server_random+w.client_random;var A=2*w.mac_key_length+2*w.enc_key_length,K=l.version.major===t.Versions.TLS_1_0.major&&l.version.minor===t.Versions.TLS_1_0.minor;K&&(A+=2*w.fixed_iv_length);var P=N(w.master_secret,"key expansion",o,A),z={client_write_MAC_key:P.getBytes(w.mac_key_length),server_write_MAC_key:P.getBytes(w.mac_key_length),client_write_key:P.getBytes(w.enc_key_length),server_write_key:P.getBytes(w.enc_key_length)};return K&&(z.client_write_IV=P.getBytes(w.fixed_iv_length),z.server_write_IV=P.getBytes(w.fixed_iv_length)),z},t.createConnectionState=function(l){var w=l.entity===t.ConnectionEnd.client,N=function(){var K={sequenceNumber:[0,0],macKey:null,macLength:0,macFunction:null,cipherState:null,cipherFunction:function(P){return!0},compressionState:null,compressFunction:function(P){return!0},updateSequenceNumber:function(){K.sequenceNumber[1]===4294967295?(K.sequenceNumber[1]=0,++K.sequenceNumber[0]):++K.sequenceNumber[1]}};return K},o={read:N(),write:N()};if(o.read.update=function(K,P){return o.read.cipherFunction(P,o.read)?o.read.compressFunction(K,P,o.read)||K.error(K,{message:"Could not decompress record.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.decompression_failure}}):K.error(K,{message:"Could not decrypt record or bad MAC.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.bad_record_mac}}),!K.fail},o.write.update=function(K,P){return o.write.compressFunction(K,P,o.write)?o.write.cipherFunction(P,o.write)||K.error(K,{message:"Could not encrypt record.",send:!1,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.internal_error}}):K.error(K,{message:"Could not compress record.",send:!1,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.internal_error}}),!K.fail},l.session){var A=l.session.sp;switch(l.session.cipherSuite.initSecurityParameters(A),A.keys=t.generateKeys(l,A),o.read.macKey=w?A.keys.server_write_MAC_key:A.keys.client_write_MAC_key,o.write.macKey=w?A.keys.client_write_MAC_key:A.keys.server_write_MAC_key,l.session.cipherSuite.initConnectionState(o,l,A),A.compression_algorithm){case t.CompressionMethod.none:break;case t.CompressionMethod.deflate:o.read.compressFunction=b,o.write.compressFunction=p;break;default:throw new Error("Unsupported compression algorithm.")}}return o},t.createRandom=function(){var l=new Date,w=+l+l.getTimezoneOffset()*6e4,N=r.util.createBuffer();return N.putInt32(w),N.putBytes(r.random.getBytes(28)),N},t.createRecord=function(l,w){if(!w.data)return null;var N={type:w.type,version:{major:l.version.major,minor:l.version.minor},length:w.data.length(),fragment:w.data};return N},t.createAlert=function(l,w){var N=r.util.createBuffer();return N.putByte(w.level),N.putByte(w.description),t.createRecord(l,{type:t.ContentType.alert,data:N})},t.createClientHello=function(l){l.session.clientHelloVersion={major:l.version.major,minor:l.version.minor};for(var w=r.util.createBuffer(),N=0;N<l.cipherSuites.length;++N){var o=l.cipherSuites[N];w.putByte(o.id[0]),w.putByte(o.id[1])}var A=w.length(),K=r.util.createBuffer();K.putByte(t.CompressionMethod.none);var P=K.length(),z=r.util.createBuffer();if(l.virtualHost){var ee=r.util.createBuffer();ee.putByte(0),ee.putByte(0);var ae=r.util.createBuffer();ae.putByte(0),c(ae,2,r.util.createBuffer(l.virtualHost));var G=r.util.createBuffer();c(G,2,ae),c(ee,2,G),z.putBuffer(ee)}var te=z.length();te>0&&(te+=2);var ie=l.session.id,ce=ie.length+1+2+4+28+2+A+1+P+te,oe=r.util.createBuffer();return oe.putByte(t.HandshakeType.client_hello),oe.putInt24(ce),oe.putByte(l.version.major),oe.putByte(l.version.minor),oe.putBytes(l.session.sp.client_random),c(oe,1,r.util.createBuffer(ie)),c(oe,2,w),c(oe,1,K),te>0&&c(oe,2,z),oe},t.createServerHello=function(l){var w=l.session.id,N=w.length+1+2+4+28+2+1,o=r.util.createBuffer();return o.putByte(t.HandshakeType.server_hello),o.putInt24(N),o.putByte(l.version.major),o.putByte(l.version.minor),o.putBytes(l.session.sp.server_random),c(o,1,r.util.createBuffer(w)),o.putByte(l.session.cipherSuite.id[0]),o.putByte(l.session.cipherSuite.id[1]),o.putByte(l.session.compressionMethod),o},t.createCertificate=function(l){var w=l.entity===t.ConnectionEnd.client,N=null;if(l.getCertificate){var o;w?o=l.session.certificateRequest:o=l.session.extensions.server_name.serverNameList,N=l.getCertificate(l,o)}var A=r.util.createBuffer();if(N!==null)try{r.util.isArray(N)||(N=[N]);for(var K=null,P=0;P<N.length;++P){var z=r.pem.decode(N[P])[0];if(z.type!=="CERTIFICATE"&&z.type!=="X509 CERTIFICATE"&&z.type!=="TRUSTED CERTIFICATE"){var ee=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw ee.headerType=z.type,ee}if(z.procType&&z.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var ae=r.util.createBuffer(z.body);K===null&&(K=r.asn1.fromDer(ae.bytes(),!1));var G=r.util.createBuffer();c(G,3,ae),A.putBuffer(G)}N=r.pki.certificateFromAsn1(K),w?l.session.clientCertificate=N:l.session.serverCertificate=N}catch(ce){return l.error(l,{message:"Could not send certificate list.",cause:ce,send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.bad_certificate}})}var te=3+A.length(),ie=r.util.createBuffer();return ie.putByte(t.HandshakeType.certificate),ie.putInt24(te),c(ie,3,A),ie},t.createClientKeyExchange=function(l){var w=r.util.createBuffer();w.putByte(l.session.clientHelloVersion.major),w.putByte(l.session.clientHelloVersion.minor),w.putBytes(r.random.getBytes(46));var N=l.session.sp;N.pre_master_secret=w.getBytes();var o=l.session.serverCertificate.publicKey;w=o.encrypt(N.pre_master_secret);var A=w.length+2,K=r.util.createBuffer();return K.putByte(t.HandshakeType.client_key_exchange),K.putInt24(A),K.putInt16(w.length),K.putBytes(w),K},t.createServerKeyExchange=function(l){var w=r.util.createBuffer();return w},t.getClientSignature=function(l,w){var N=r.util.createBuffer();N.putBuffer(l.session.md5.digest()),N.putBuffer(l.session.sha1.digest()),N=N.getBytes(),l.getSignature=l.getSignature||function(o,A,K){var P=null;if(o.getPrivateKey)try{P=o.getPrivateKey(o,o.session.clientCertificate),P=r.pki.privateKeyFromPem(P)}catch(z){o.error(o,{message:"Could not get private key.",cause:z,send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.internal_error}})}P===null?o.error(o,{message:"No private key set.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.internal_error}}):A=P.sign(A,null),K(o,A)},l.getSignature(l,N,w)},t.createCertificateVerify=function(l,w){var N=w.length+2,o=r.util.createBuffer();return o.putByte(t.HandshakeType.certificate_verify),o.putInt24(N),o.putInt16(w.length),o.putBytes(w),o},t.createCertificateRequest=function(l){var w=r.util.createBuffer();w.putByte(1);var N=r.util.createBuffer();for(var o in l.caStore.certs){var A=l.caStore.certs[o],K=r.pki.distinguishedNameToAsn1(A.subject),P=r.asn1.toDer(K);N.putInt16(P.length()),N.putBuffer(P)}var z=1+w.length()+2+N.length(),ee=r.util.createBuffer();return ee.putByte(t.HandshakeType.certificate_request),ee.putInt24(z),c(ee,1,w),c(ee,2,N),ee},t.createServerHelloDone=function(l){var w=r.util.createBuffer();return w.putByte(t.HandshakeType.server_hello_done),w.putInt24(0),w},t.createChangeCipherSpec=function(){var l=r.util.createBuffer();return l.putByte(1),l},t.createFinished=function(l){var w=r.util.createBuffer();w.putBuffer(l.session.md5.digest()),w.putBuffer(l.session.sha1.digest());var N=l.entity===t.ConnectionEnd.client,o=l.session.sp,A=12,K=e,P=N?"client finished":"server finished";w=K(o.master_secret,P,w.getBytes(),A);var z=r.util.createBuffer();return z.putByte(t.HandshakeType.finished),z.putInt24(w.length()),z.putBuffer(w),z},t.createHeartbeat=function(l,w,N){typeof N>"u"&&(N=w.length);var o=r.util.createBuffer();o.putByte(l),o.putInt16(N),o.putBytes(w);var A=o.length(),K=Math.max(16,A-N-3);return o.putBytes(r.random.getBytes(K)),o},t.queue=function(l,w){if(w&&!(w.fragment.length()===0&&(w.type===t.ContentType.handshake||w.type===t.ContentType.alert||w.type===t.ContentType.change_cipher_spec))){if(w.type===t.ContentType.handshake){var N=w.fragment.bytes();l.session.md5.update(N),l.session.sha1.update(N),N=null}var o;if(w.fragment.length()<=t.MaxFragment)o=[w];else{o=[];for(var A=w.fragment.bytes();A.length>t.MaxFragment;)o.push(t.createRecord(l,{type:w.type,data:r.util.createBuffer(A.slice(0,t.MaxFragment))})),A=A.slice(t.MaxFragment);A.length>0&&o.push(t.createRecord(l,{type:w.type,data:r.util.createBuffer(A)}))}for(var K=0;K<o.length&&!l.fail;++K){var P=o[K],z=l.state.current.write;z.update(l,P)&&l.records.push(P)}}},t.flush=function(l){for(var w=0;w<l.records.length;++w){var N=l.records[w];l.tlsData.putByte(N.type),l.tlsData.putByte(N.version.major),l.tlsData.putByte(N.version.minor),l.tlsData.putInt16(N.fragment.length()),l.tlsData.putBuffer(l.records[w].fragment)}return l.records=[],l.tlsDataReady(l)};var $=function(l){switch(l){case!0:return!0;case r.pki.certificateError.bad_certificate:return t.Alert.Description.bad_certificate;case r.pki.certificateError.unsupported_certificate:return t.Alert.Description.unsupported_certificate;case r.pki.certificateError.certificate_revoked:return t.Alert.Description.certificate_revoked;case r.pki.certificateError.certificate_expired:return t.Alert.Description.certificate_expired;case r.pki.certificateError.certificate_unknown:return t.Alert.Description.certificate_unknown;case r.pki.certificateError.unknown_ca:return t.Alert.Description.unknown_ca;default:return t.Alert.Description.bad_certificate}},qe=function(l){switch(l){case!0:return!0;case t.Alert.Description.bad_certificate:return r.pki.certificateError.bad_certificate;case t.Alert.Description.unsupported_certificate:return r.pki.certificateError.unsupported_certificate;case t.Alert.Description.certificate_revoked:return r.pki.certificateError.certificate_revoked;case t.Alert.Description.certificate_expired:return r.pki.certificateError.certificate_expired;case t.Alert.Description.certificate_unknown:return r.pki.certificateError.certificate_unknown;case t.Alert.Description.unknown_ca:return r.pki.certificateError.unknown_ca;default:return r.pki.certificateError.bad_certificate}};t.verifyCertificateChain=function(l,w){try{var N={};for(var o in l.verifyOptions)N[o]=l.verifyOptions[o];N.verify=function(K,P,z){var ee=$(K),ae=l.verify(l,K,P,z);if(ae!==!0){if(typeof ae=="object"&&!r.util.isArray(ae)){var G=new Error("The application rejected the certificate.");throw G.send=!0,G.alert={level:t.Alert.Level.fatal,description:t.Alert.Description.bad_certificate},ae.message&&(G.message=ae.message),ae.alert&&(G.alert.description=ae.alert),G}ae!==K&&(ae=qe(ae))}return ae},r.pki.verifyCertificateChain(l.caStore,w,N)}catch(K){var A=K;(typeof A!="object"||r.util.isArray(A))&&(A={send:!0,alert:{level:t.Alert.Level.fatal,description:$(K)}}),"send"in A||(A.send=!0),"alert"in A||(A.alert={level:t.Alert.Level.fatal,description:$(A.error)}),l.error(l,A)}return!l.fail},t.createSessionCache=function(l,w){var N=null;if(l&&l.getSession&&l.setSession&&l.order)N=l;else{N={},N.cache=l||{},N.capacity=Math.max(w||100,1),N.order=[];for(var o in l)N.order.length<=w?N.order.push(o):delete l[o];N.getSession=function(A){var K=null,P=null;if(A?P=r.util.bytesToHex(A):N.order.length>0&&(P=N.order[0]),P!==null&&P in N.cache){K=N.cache[P],delete N.cache[P];for(var z in N.order)if(N.order[z]===P){N.order.splice(z,1);break}}return K},N.setSession=function(A,K){if(N.order.length===N.capacity){var P=N.order.shift();delete N.cache[P]}var P=r.util.bytesToHex(A);N.order.push(P),N.cache[P]=K}}return N},t.createConnection=function(l){var w=null;l.caStore?r.util.isArray(l.caStore)?w=r.pki.createCaStore(l.caStore):w=l.caStore:w=r.pki.createCaStore();var N=l.cipherSuites||null;if(N===null){N=[];for(var o in t.CipherSuites)N.push(t.CipherSuites[o])}var A=l.server?t.ConnectionEnd.server:t.ConnectionEnd.client,K=l.sessionCache?t.createSessionCache(l.sessionCache):null,P={version:{major:t.Version.major,minor:t.Version.minor},entity:A,sessionId:l.sessionId,caStore:w,sessionCache:K,cipherSuites:N,connected:l.connected,virtualHost:l.virtualHost||null,verifyClient:l.verifyClient||!1,verify:l.verify||function(G,te,ie,ce){return te},verifyOptions:l.verifyOptions||{},getCertificate:l.getCertificate||null,getPrivateKey:l.getPrivateKey||null,getSignature:l.getSignature||null,input:r.util.createBuffer(),tlsData:r.util.createBuffer(),data:r.util.createBuffer(),tlsDataReady:l.tlsDataReady,dataReady:l.dataReady,heartbeatReceived:l.heartbeatReceived,closed:l.closed,error:function(G,te){te.origin=te.origin||(G.entity===t.ConnectionEnd.client?"client":"server"),te.send&&(t.queue(G,t.createAlert(G,te.alert)),t.flush(G));var ie=te.fatal!==!1;ie&&(G.fail=!0),l.error(G,te),ie&&G.close(!1)},deflate:l.deflate||null,inflate:l.inflate||null};P.reset=function(G){P.version={major:t.Version.major,minor:t.Version.minor},P.record=null,P.session=null,P.peerCertificate=null,P.state={pending:null,current:null},P.expect=P.entity===t.ConnectionEnd.client?y:s,P.fragmented=null,P.records=[],P.open=!1,P.handshakes=0,P.handshaking=!1,P.isConnected=!1,P.fail=!(G||typeof G>"u"),P.input.clear(),P.tlsData.clear(),P.data.clear(),P.state.current=t.createConnectionState(P)},P.reset();var z=function(G,te){var ie=te.type-t.ContentType.change_cipher_spec,ce=q[G.entity][G.expect];ie in ce?ce[ie](G,te):t.handleUnexpected(G,te)},ee=function(G){var te=0,ie=G.input,ce=ie.length();if(ce<5)te=5-ce;else{G.record={type:ie.getByte(),version:{major:ie.getByte(),minor:ie.getByte()},length:ie.getInt16(),fragment:r.util.createBuffer(),ready:!1};var oe=G.record.version.major===G.version.major;oe&&G.session&&G.session.version&&(oe=G.record.version.minor===G.version.minor),oe||G.error(G,{message:"Incompatible TLS version.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.protocol_version}})}return te},ae=function(G){var te=0,ie=G.input,ce=ie.length();if(ce<G.record.length)te=G.record.length-ce;else{G.record.fragment.putBytes(ie.getBytes(G.record.length)),ie.compact();var oe=G.state.current.read;oe.update(G,G.record)&&(G.fragmented!==null&&(G.fragmented.type===G.record.type?(G.fragmented.fragment.putBuffer(G.record.fragment),G.record=G.fragmented):G.error(G,{message:"Invalid fragmented record.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.unexpected_message}})),G.record.ready=!0)}return te};return P.handshake=function(G){if(P.entity!==t.ConnectionEnd.client)P.error(P,{message:"Cannot initiate handshake as a server.",fatal:!1});else if(P.handshaking)P.error(P,{message:"Handshake already in progress.",fatal:!1});else{P.fail&&!P.open&&P.handshakes===0&&(P.fail=!1),P.handshaking=!0,G=G||"";var te=null;G.length>0&&(P.sessionCache&&(te=P.sessionCache.getSession(G)),te===null&&(G="")),G.length===0&&P.sessionCache&&(te=P.sessionCache.getSession(),te!==null&&(G=te.id)),P.session={id:G,version:null,cipherSuite:null,compressionMethod:null,serverCertificate:null,certificateRequest:null,clientCertificate:null,sp:{},md5:r.md.md5.create(),sha1:r.md.sha1.create()},te&&(P.version=te.version,P.session.sp=te.sp),P.session.sp.client_random=t.createRandom().getBytes(),P.open=!0,t.queue(P,t.createRecord(P,{type:t.ContentType.handshake,data:t.createClientHello(P)})),t.flush(P)}},P.process=function(G){var te=0;return G&&P.input.putBytes(G),P.fail||(P.record!==null&&P.record.ready&&P.record.fragment.isEmpty()&&(P.record=null),P.record===null&&(te=ee(P)),!P.fail&&P.record!==null&&!P.record.ready&&(te=ae(P)),!P.fail&&P.record!==null&&P.record.ready&&z(P,P.record)),te},P.prepare=function(G){return t.queue(P,t.createRecord(P,{type:t.ContentType.application_data,data:r.util.createBuffer(G)})),t.flush(P)},P.prepareHeartbeatRequest=function(G,te){return G instanceof r.util.ByteBuffer&&(G=G.bytes()),typeof te>"u"&&(te=G.length),P.expectedHeartbeatPayload=G,t.queue(P,t.createRecord(P,{type:t.ContentType.heartbeat,data:t.createHeartbeat(t.HeartbeatMessageType.heartbeat_request,G,te)})),t.flush(P)},P.close=function(G){if(!P.fail&&P.sessionCache&&P.session){var te={id:P.session.id,version:P.session.version,sp:P.session.sp};te.sp.keys=null,P.sessionCache.setSession(te.id,te)}P.open&&(P.open=!1,P.input.clear(),(P.isConnected||P.handshaking)&&(P.isConnected=P.handshaking=!1,t.queue(P,t.createAlert(P,{level:t.Alert.Level.warning,description:t.Alert.Description.close_notify})),t.flush(P)),P.closed(P)),P.reset(G)},P},fr=r.tls=r.tls||{};for(var fe in t)typeof t[fe]!="function"&&(r.tls[fe]=t[fe]);return r.tls.prf_tls1=e,r.tls.hmac_sha1=n,r.tls.createSessionCache=t.createSessionCache,r.tls.createConnection=t.createConnection,fr}var ca;function ba(){if(ca)return Ut.exports;ca=1;var r=ue();ot(),fa();var e=Ut.exports=r.tls;e.CipherSuites.TLS_RSA_WITH_AES_128_CBC_SHA={id:[0,47],name:"TLS_RSA_WITH_AES_128_CBC_SHA",initSecurityParameters:function(y){y.bulk_cipher_algorithm=e.BulkCipherAlgorithm.aes,y.cipher_type=e.CipherType.block,y.enc_key_length=16,y.block_length=16,y.fixed_iv_length=16,y.record_iv_length=16,y.mac_algorithm=e.MACAlgorithm.hmac_sha1,y.mac_length=20,y.mac_key_length=20},initConnectionState:n},e.CipherSuites.TLS_RSA_WITH_AES_256_CBC_SHA={id:[0,53],name:"TLS_RSA_WITH_AES_256_CBC_SHA",initSecurityParameters:function(y){y.bulk_cipher_algorithm=e.BulkCipherAlgorithm.aes,y.cipher_type=e.CipherType.block,y.enc_key_length=32,y.block_length=16,y.fixed_iv_length=16,y.record_iv_length=16,y.mac_algorithm=e.MACAlgorithm.hmac_sha1,y.mac_length=20,y.mac_key_length=20},initConnectionState:n};function n(y,f,S){var k=f.entity===r.tls.ConnectionEnd.client;y.read.cipherState={init:!1,cipher:r.cipher.createDecipher("AES-CBC",k?S.keys.server_write_key:S.keys.client_write_key),iv:k?S.keys.server_write_IV:S.keys.client_write_IV},y.write.cipherState={init:!1,cipher:r.cipher.createCipher("AES-CBC",k?S.keys.client_write_key:S.keys.server_write_key),iv:k?S.keys.client_write_IV:S.keys.server_write_IV},y.read.cipherFunction=c,y.write.cipherFunction=p,y.read.macLength=y.write.macLength=S.mac_length,y.read.macFunction=y.write.macFunction=e.hmac_sha1}function p(y,f){var S=!1,k=f.macFunction(f.macKey,f.sequenceNumber,y);y.fragment.putBytes(k),f.updateSequenceNumber();var E;y.version.minor===e.Versions.TLS_1_0.minor?E=f.cipherState.init?null:f.cipherState.iv:E=r.random.getBytesSync(16),f.cipherState.init=!0;var u=f.cipherState.cipher;return u.start({iv:E}),y.version.minor>=e.Versions.TLS_1_1.minor&&u.output.putBytes(E),u.update(y.fragment),u.finish(b)&&(y.fragment=u.output,y.length=y.fragment.length(),S=!0),S}function b(y,f,S){if(!S){var k=y-f.length()%y;f.fillWithByte(k-1,k)}return!0}function x(y,f,S){var k=!0;if(S){for(var E=f.length(),u=f.last(),g=E-1-u;g<E-1;++g)k=k&&f.at(g)==u;k&&f.truncate(u+1)}return k}function c(y,f){var S=!1,k;y.version.minor===e.Versions.TLS_1_0.minor?k=f.cipherState.init?null:f.cipherState.iv:k=y.fragment.getBytes(16),f.cipherState.init=!0;var E=f.cipherState.cipher;E.start({iv:k}),E.update(y.fragment),S=E.finish(x);var u=f.macLength,g=r.random.getBytesSync(u),C=E.output.length();C>=u?(y.fragment=E.output.getBytes(C-u),g=E.output.getBytes(u)):y.fragment=E.output.getBytes(),y.fragment=r.util.createBuffer(y.fragment),y.length=y.fragment.length();var m=f.macFunction(f.macKey,f.sequenceNumber,y);return f.updateSequenceNumber(),S=t(f.macKey,g,m)&&S,S}function t(y,f,S){var k=r.hmac.create();return k.start("SHA1",y),k.update(f),f=k.digest().getBytes(),k.start(null,null),k.update(S),S=k.digest().getBytes(),f===S}return Ut.exports}var cr={exports:{}},ha;function da(){if(ha)return cr.exports;ha=1;var r=ue();rt(),de();var e=cr.exports=r.sha512=r.sha512||{};r.md.sha512=r.md.algorithms.sha512=e;var n=r.sha384=r.sha512.sha384=r.sha512.sha384||{};n.create=function(){return e.create("SHA-384")},r.md.sha384=r.md.algorithms.sha384=n,r.sha512.sha256=r.sha512.sha256||{create:function(){return e.create("SHA-512/256")}},r.md["sha512/256"]=r.md.algorithms["sha512/256"]=r.sha512.sha256,r.sha512.sha224=r.sha512.sha224||{create:function(){return e.create("SHA-512/224")}},r.md["sha512/224"]=r.md.algorithms["sha512/224"]=r.sha512.sha224,e.create=function(f){if(b||t(),typeof f>"u"&&(f="SHA-512"),!(f in c))throw new Error("Invalid SHA-512 algorithm: "+f);for(var S=c[f],k=null,E=r.util.createBuffer(),u=new Array(80),g=0;g<80;++g)u[g]=new Array(2);var C=64;switch(f){case"SHA-384":C=48;break;case"SHA-512/256":C=32;break;case"SHA-512/224":C=28;break}var m={algorithm:f.replace("-","").toLowerCase(),blockLength:128,digestLength:C,messageLength:0,fullMessageLength:null,messageLengthSize:16};return m.start=function(){m.messageLength=0,m.fullMessageLength=m.messageLength128=[];for(var s=m.messageLengthSize/4,d=0;d<s;++d)m.fullMessageLength.push(0);E=r.util.createBuffer(),k=new Array(S.length);for(var d=0;d<S.length;++d)k[d]=S[d].slice(0);return m},m.start(),m.update=function(s,d){d==="utf8"&&(s=r.util.encodeUtf8(s));var v=s.length;m.messageLength+=v,v=[v/4294967296>>>0,v>>>0];for(var I=m.fullMessageLength.length-1;I>=0;--I)m.fullMessageLength[I]+=v[1],v[1]=v[0]+(m.fullMessageLength[I]/4294967296>>>0),m.fullMessageLength[I]=m.fullMessageLength[I]>>>0,v[0]=v[1]/4294967296>>>0;return E.putBytes(s),y(k,u,E),(E.read>2048||E.length()===0)&&E.compact(),m},m.digest=function(){var s=r.util.createBuffer();s.putBytes(E.bytes());var d=m.fullMessageLength[m.fullMessageLength.length-1]+m.messageLengthSize,v=d&m.blockLength-1;s.putBytes(p.substr(0,m.blockLength-v));for(var I,R,h=m.fullMessageLength[0]*8,i=0;i<m.fullMessageLength.length-1;++i)I=m.fullMessageLength[i+1]*8,R=I/4294967296>>>0,h+=R,s.putInt32(h>>>0),h=I>>>0;s.putInt32(h);for(var a=new Array(k.length),i=0;i<k.length;++i)a[i]=k[i].slice(0);y(a,u,s);var B=r.util.createBuffer(),D;f==="SHA-512"?D=a.length:f==="SHA-384"?D=a.length-2:D=a.length-4;for(var i=0;i<D;++i)B.putInt32(a[i][0]),(i!==D-1||f!=="SHA-512/224")&&B.putInt32(a[i][1]);return B},m};var p=null,b=!1,x=null,c=null;function t(){p="",p+=r.util.fillString("\0",128),x=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],c={},c["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],c["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],c["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],c["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],b=!0}function y(f,S,k){for(var E,u,g,C,m,s,d,v,I,R,h,i,a,B,D,V,L,O,q,M,H,Y,X,J,ne,se,he,ye,j,le,$,qe,fe,l,w,N=k.length();N>=128;){for(j=0;j<16;++j)S[j][0]=k.getInt32()>>>0,S[j][1]=k.getInt32()>>>0;for(;j<80;++j)qe=S[j-2],le=qe[0],$=qe[1],E=((le>>>19|$<<13)^($>>>29|le<<3)^le>>>6)>>>0,u=((le<<13|$>>>19)^($<<3|le>>>29)^(le<<26|$>>>6))>>>0,l=S[j-15],le=l[0],$=l[1],g=((le>>>1|$<<31)^(le>>>8|$<<24)^le>>>7)>>>0,C=((le<<31|$>>>1)^(le<<24|$>>>8)^(le<<25|$>>>7))>>>0,fe=S[j-7],w=S[j-16],$=u+fe[1]+C+w[1],S[j][0]=E+fe[0]+g+w[0]+($/4294967296>>>0)>>>0,S[j][1]=$>>>0;for(a=f[0][0],B=f[0][1],D=f[1][0],V=f[1][1],L=f[2][0],O=f[2][1],q=f[3][0],M=f[3][1],H=f[4][0],Y=f[4][1],X=f[5][0],J=f[5][1],ne=f[6][0],se=f[6][1],he=f[7][0],ye=f[7][1],j=0;j<80;++j)d=((H>>>14|Y<<18)^(H>>>18|Y<<14)^(Y>>>9|H<<23))>>>0,v=((H<<18|Y>>>14)^(H<<14|Y>>>18)^(Y<<23|H>>>9))>>>0,I=(ne^H&(X^ne))>>>0,R=(se^Y&(J^se))>>>0,m=((a>>>28|B<<4)^(B>>>2|a<<30)^(B>>>7|a<<25))>>>0,s=((a<<4|B>>>28)^(B<<30|a>>>2)^(B<<25|a>>>7))>>>0,h=(a&D|L&(a^D))>>>0,i=(B&V|O&(B^V))>>>0,$=ye+v+R+x[j][1]+S[j][1],E=he+d+I+x[j][0]+S[j][0]+($/4294967296>>>0)>>>0,u=$>>>0,$=s+i,g=m+h+($/4294967296>>>0)>>>0,C=$>>>0,he=ne,ye=se,ne=X,se=J,X=H,J=Y,$=M+u,H=q+E+($/4294967296>>>0)>>>0,Y=$>>>0,q=L,M=O,L=D,O=V,D=a,V=B,$=u+C,a=E+g+($/4294967296>>>0)>>>0,B=$>>>0;$=f[0][1]+B,f[0][0]=f[0][0]+a+($/4294967296>>>0)>>>0,f[0][1]=$>>>0,$=f[1][1]+V,f[1][0]=f[1][0]+D+($/4294967296>>>0)>>>0,f[1][1]=$>>>0,$=f[2][1]+O,f[2][0]=f[2][0]+L+($/4294967296>>>0)>>>0,f[2][1]=$>>>0,$=f[3][1]+M,f[3][0]=f[3][0]+q+($/4294967296>>>0)>>>0,f[3][1]=$>>>0,$=f[4][1]+Y,f[4][0]=f[4][0]+H+($/4294967296>>>0)>>>0,f[4][1]=$>>>0,$=f[5][1]+J,f[5][0]=f[5][0]+X+($/4294967296>>>0)>>>0,f[5][1]=$>>>0,$=f[6][1]+se,f[6][0]=f[6][0]+ne+($/4294967296>>>0)>>>0,f[6][1]=$>>>0,$=f[7][1]+ye,f[7][0]=f[7][0]+he+($/4294967296>>>0)>>>0,f[7][1]=$>>>0,N-=128}}return cr.exports}var St={},pa;function _a(){if(pa)return St;pa=1;var r=ue();et();var e=r.asn1;return St.privateKeyValidator={name:"PrivateKeyInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},St.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{tagClass:e.Class.UNIVERSAL,type:e.Type.BITSTRING,constructed:!1,composed:!0,captureBitStringValue:"ed25519PublicKey"}]},St}var hr,va;function Na(){if(va)return hr;va=1;var r=ue();Ct(),Xe(),da(),de();var e=_a(),n=e.publicKeyValidator,p=e.privateKeyValidator;if(typeof b>"u")var b=r.jsbn.BigInteger;var x=r.util.ByteBuffer,c=typeof Buffer>"u"?Uint8Array:Buffer;r.pki=r.pki||{},hr=r.pki.ed25519=r.ed25519=r.ed25519||{};var t=r.ed25519;t.constants={},t.constants.PUBLIC_KEY_BYTE_LENGTH=32,t.constants.PRIVATE_KEY_BYTE_LENGTH=64,t.constants.SEED_BYTE_LENGTH=32,t.constants.SIGN_BYTE_LENGTH=64,t.constants.HASH_BYTE_LENGTH=64,t.generateKeyPair=function(l){l=l||{};var w=l.seed;if(w===void 0)w=r.random.getBytesSync(t.constants.SEED_BYTE_LENGTH);else if(typeof w=="string"){if(w.length!==t.constants.SEED_BYTE_LENGTH)throw new TypeError('"seed" must be '+t.constants.SEED_BYTE_LENGTH+" bytes in length.")}else if(!(w instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, Uint8Array, or a binary string.');w=y({message:w,encoding:"binary"});for(var N=new c(t.constants.PUBLIC_KEY_BYTE_LENGTH),o=new c(t.constants.PRIVATE_KEY_BYTE_LENGTH),A=0;A<32;++A)o[A]=w[A];return d(N,o),{publicKey:N,privateKey:o}},t.privateKeyFromAsn1=function(l){var w={},N=[],o=r.asn1.validate(l,p,w,N);if(!o){var A=new Error("Invalid Key.");throw A.errors=N,A}var K=r.asn1.derToOid(w.privateKeyOid),P=r.oids.EdDSA25519;if(K!==P)throw new Error('Invalid OID "'+K+'"; OID must be "'+P+'".');var z=w.privateKey,ee=y({message:r.asn1.fromDer(z).value,encoding:"binary"});return{privateKeyBytes:ee}},t.publicKeyFromAsn1=function(l){var w={},N=[],o=r.asn1.validate(l,n,w,N);if(!o){var A=new Error("Invalid Key.");throw A.errors=N,A}var K=r.asn1.derToOid(w.publicKeyOid),P=r.oids.EdDSA25519;if(K!==P)throw new Error('Invalid OID "'+K+'"; OID must be "'+P+'".');var z=w.ed25519PublicKey;if(z.length!==t.constants.PUBLIC_KEY_BYTE_LENGTH)throw new Error("Key length is invalid.");return y({message:z,encoding:"binary"})},t.publicKeyFromPrivateKey=function(l){l=l||{};var w=y({message:l.privateKey,encoding:"binary"});if(w.length!==t.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+t.constants.PRIVATE_KEY_BYTE_LENGTH);for(var N=new c(t.constants.PUBLIC_KEY_BYTE_LENGTH),o=0;o<N.length;++o)N[o]=w[32+o];return N},t.sign=function(l){l=l||{};var w=y(l),N=y({message:l.privateKey,encoding:"binary"});if(N.length===t.constants.SEED_BYTE_LENGTH){var o=t.generateKeyPair({seed:N});N=o.privateKey}else if(N.length!==t.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+t.constants.SEED_BYTE_LENGTH+" or "+t.constants.PRIVATE_KEY_BYTE_LENGTH);var A=new c(t.constants.SIGN_BYTE_LENGTH+w.length);v(A,w,w.length,N);for(var K=new c(t.constants.SIGN_BYTE_LENGTH),P=0;P<K.length;++P)K[P]=A[P];return K},t.verify=function(l){l=l||{};var w=y(l);if(l.signature===void 0)throw new TypeError('"options.signature" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a binary string.');var N=y({message:l.signature,encoding:"binary"});if(N.length!==t.constants.SIGN_BYTE_LENGTH)throw new TypeError('"options.signature" must have a byte length of '+t.constants.SIGN_BYTE_LENGTH);var o=y({message:l.publicKey,encoding:"binary"});if(o.length!==t.constants.PUBLIC_KEY_BYTE_LENGTH)throw new TypeError('"options.publicKey" must have a byte length of '+t.constants.PUBLIC_KEY_BYTE_LENGTH);var A=new c(t.constants.SIGN_BYTE_LENGTH+w.length),K=new c(t.constants.SIGN_BYTE_LENGTH+w.length),P;for(P=0;P<t.constants.SIGN_BYTE_LENGTH;++P)A[P]=N[P];for(P=0;P<w.length;++P)A[P+t.constants.SIGN_BYTE_LENGTH]=w[P];return I(K,A,A.length,o)>=0};function y(l){var w=l.message;if(w instanceof Uint8Array||w instanceof c)return w;var N=l.encoding;if(w===void 0)if(l.md)w=l.md.digest().getBytes(),N="binary";else throw new TypeError('"options.message" or "options.md" not specified.');if(typeof w=="string"&&!N)throw new TypeError('"options.encoding" must be "binary" or "utf8".');if(typeof w=="string"){if(typeof Buffer<"u")return Buffer.from(w,N);w=new x(w,N)}else if(!(w instanceof x))throw new TypeError('"options.message" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a string with "options.encoding" specifying its encoding.');for(var o=new c(w.length()),A=0;A<o.length;++A)o[A]=w.at(A);return o}var f=j(),S=j([1]),k=j([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),E=j([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),u=j([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),g=j([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),C=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]),m=j([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function s(l,w){var N=r.md.sha512.create(),o=new x(l);N.update(o.getBytes(w),"binary");var A=N.digest().getBytes();if(typeof Buffer<"u")return Buffer.from(A,"binary");for(var K=new c(t.constants.HASH_BYTE_LENGTH),P=0;P<64;++P)K[P]=A.charCodeAt(P);return K}function d(l,w){var N=[j(),j(),j(),j()],o,A=s(w,32);for(A[0]&=248,A[31]&=127,A[31]|=64,J(N,A),B(l,N),o=0;o<32;++o)w[o+32]=l[o];return 0}function v(l,w,N,o){var A,K,P=new Float64Array(64),z=[j(),j(),j(),j()],ee=s(o,32);ee[0]&=248,ee[31]&=127,ee[31]|=64;var ae=N+64;for(A=0;A<N;++A)l[64+A]=w[A];for(A=0;A<32;++A)l[32+A]=ee[32+A];var G=s(l.subarray(32),N+32);for(h(G),J(z,G),B(l,z),A=32;A<64;++A)l[A]=o[A];var te=s(l,N+64);for(h(te),A=32;A<64;++A)P[A]=0;for(A=0;A<32;++A)P[A]=G[A];for(A=0;A<32;++A)for(K=0;K<32;K++)P[A+K]+=te[A]*ee[K];return R(l.subarray(32),P),ae}function I(l,w,N,o){var A,K,P=new c(32),z=[j(),j(),j(),j()],ee=[j(),j(),j(),j()];if(K=-1,N<64||V(ee,o))return-1;for(A=0;A<N;++A)l[A]=w[A];for(A=0;A<32;++A)l[A+32]=o[A];var ae=s(l,N);if(h(ae),X(z,ee,ae),J(ee,w.subarray(32)),i(z,ee),B(P,z),N-=64,M(w,0,P,0)){for(A=0;A<N;++A)l[A]=0;return-1}for(A=0;A<N;++A)l[A]=w[A+64];return K=N,K}function R(l,w){var N,o,A,K;for(o=63;o>=32;--o){for(N=0,A=o-32,K=o-12;A<K;++A)w[A]+=N-16*w[o]*C[A-(o-32)],N=w[A]+128>>8,w[A]-=N*256;w[A]+=N,w[o]=0}for(N=0,A=0;A<32;++A)w[A]+=N-(w[31]>>4)*C[A],N=w[A]>>8,w[A]&=255;for(A=0;A<32;++A)w[A]-=N*C[A];for(o=0;o<32;++o)w[o+1]+=w[o]>>8,l[o]=w[o]&255}function h(l){for(var w=new Float64Array(64),N=0;N<64;++N)w[N]=l[N],l[N]=0;R(l,w)}function i(l,w){var N=j(),o=j(),A=j(),K=j(),P=j(),z=j(),ee=j(),ae=j(),G=j();$(N,l[1],l[0]),$(G,w[1],w[0]),fe(N,N,G),le(o,l[0],l[1]),le(G,w[0],w[1]),fe(o,o,G),fe(A,l[3],w[3]),fe(A,A,E),fe(K,l[2],w[2]),le(K,K,K),$(P,o,N),$(z,K,A),le(ee,K,A),le(ae,o,N),fe(l[0],P,z),fe(l[1],ae,ee),fe(l[2],ee,z),fe(l[3],P,ae)}function a(l,w,N){for(var o=0;o<4;++o)ye(l[o],w[o],N)}function B(l,w){var N=j(),o=j(),A=j();se(A,w[2]),fe(N,w[0],A),fe(o,w[1],A),D(l,o),l[31]^=Y(N)<<7}function D(l,w){var N,o,A,K=j(),P=j();for(N=0;N<16;++N)P[N]=w[N];for(he(P),he(P),he(P),o=0;o<2;++o){for(K[0]=P[0]-65517,N=1;N<15;++N)K[N]=P[N]-65535-(K[N-1]>>16&1),K[N-1]&=65535;K[15]=P[15]-32767-(K[14]>>16&1),A=K[15]>>16&1,K[14]&=65535,ye(P,K,1-A)}for(N=0;N<16;N++)l[2*N]=P[N]&255,l[2*N+1]=P[N]>>8}function V(l,w){var N=j(),o=j(),A=j(),K=j(),P=j(),z=j(),ee=j();return ne(l[2],S),L(l[1],w),qe(A,l[1]),fe(K,A,k),$(A,A,l[2]),le(K,l[2],K),qe(P,K),qe(z,P),fe(ee,z,P),fe(N,ee,A),fe(N,N,K),O(N,N),fe(N,N,A),fe(N,N,K),fe(N,N,K),fe(l[0],N,K),qe(o,l[0]),fe(o,o,K),q(o,A)&&fe(l[0],l[0],m),qe(o,l[0]),fe(o,o,K),q(o,A)?-1:(Y(l[0])===w[31]>>7&&$(l[0],f,l[0]),fe(l[3],l[0],l[1]),0)}function L(l,w){var N;for(N=0;N<16;++N)l[N]=w[2*N]+(w[2*N+1]<<8);l[15]&=32767}function O(l,w){var N=j(),o;for(o=0;o<16;++o)N[o]=w[o];for(o=250;o>=0;--o)qe(N,N),o!==1&&fe(N,N,w);for(o=0;o<16;++o)l[o]=N[o]}function q(l,w){var N=new c(32),o=new c(32);return D(N,l),D(o,w),M(N,0,o,0)}function M(l,w,N,o){return H(l,w,N,o,32)}function H(l,w,N,o,A){var K,P=0;for(K=0;K<A;++K)P|=l[w+K]^N[o+K];return(1&P-1>>>8)-1}function Y(l){var w=new c(32);return D(w,l),w[0]&1}function X(l,w,N){var o,A;for(ne(l[0],f),ne(l[1],S),ne(l[2],S),ne(l[3],f),A=255;A>=0;--A)o=N[A/8|0]>>(A&7)&1,a(l,w,o),i(w,l),i(l,l),a(l,w,o)}function J(l,w){var N=[j(),j(),j(),j()];ne(N[0],u),ne(N[1],g),ne(N[2],S),fe(N[3],u,g),X(l,N,w)}function ne(l,w){var N;for(N=0;N<16;N++)l[N]=w[N]|0}function se(l,w){var N=j(),o;for(o=0;o<16;++o)N[o]=w[o];for(o=253;o>=0;--o)qe(N,N),o!==2&&o!==4&&fe(N,N,w);for(o=0;o<16;++o)l[o]=N[o]}function he(l){var w,N,o=1;for(w=0;w<16;++w)N=l[w]+o+65535,o=Math.floor(N/65536),l[w]=N-o*65536;l[0]+=o-1+37*(o-1)}function ye(l,w,N){for(var o,A=~(N-1),K=0;K<16;++K)o=A&(l[K]^w[K]),l[K]^=o,w[K]^=o}function j(l){var w,N=new Float64Array(16);if(l)for(w=0;w<l.length;++w)N[w]=l[w];return N}function le(l,w,N){for(var o=0;o<16;++o)l[o]=w[o]+N[o]}function $(l,w,N){for(var o=0;o<16;++o)l[o]=w[o]-N[o]}function qe(l,w){fe(l,w,w)}function fe(l,w,N){var o,A,K=0,P=0,z=0,ee=0,ae=0,G=0,te=0,ie=0,ce=0,oe=0,me=0,Se=0,xe=0,Ce=0,ve=0,ge=0,Te=0,Fe=0,Me=0,He=0,Ge=0,Qe=0,Ye=0,je=0,tt=0,at=0,it=0,lt=0,ct=0,gt=0,At=0,Ae=N[0],Be=N[1],be=N[2],_e=N[3],Ne=N[4],Re=N[5],we=N[6],Le=N[7],ke=N[8],De=N[9],Ue=N[10],Pe=N[11],Ee=N[12],Ie=N[13],Ve=N[14],Oe=N[15];o=w[0],K+=o*Ae,P+=o*Be,z+=o*be,ee+=o*_e,ae+=o*Ne,G+=o*Re,te+=o*we,ie+=o*Le,ce+=o*ke,oe+=o*De,me+=o*Ue,Se+=o*Pe,xe+=o*Ee,Ce+=o*Ie,ve+=o*Ve,ge+=o*Oe,o=w[1],P+=o*Ae,z+=o*Be,ee+=o*be,ae+=o*_e,G+=o*Ne,te+=o*Re,ie+=o*we,ce+=o*Le,oe+=o*ke,me+=o*De,Se+=o*Ue,xe+=o*Pe,Ce+=o*Ee,ve+=o*Ie,ge+=o*Ve,Te+=o*Oe,o=w[2],z+=o*Ae,ee+=o*Be,ae+=o*be,G+=o*_e,te+=o*Ne,ie+=o*Re,ce+=o*we,oe+=o*Le,me+=o*ke,Se+=o*De,xe+=o*Ue,Ce+=o*Pe,ve+=o*Ee,ge+=o*Ie,Te+=o*Ve,Fe+=o*Oe,o=w[3],ee+=o*Ae,ae+=o*Be,G+=o*be,te+=o*_e,ie+=o*Ne,ce+=o*Re,oe+=o*we,me+=o*Le,Se+=o*ke,xe+=o*De,Ce+=o*Ue,ve+=o*Pe,ge+=o*Ee,Te+=o*Ie,Fe+=o*Ve,Me+=o*Oe,o=w[4],ae+=o*Ae,G+=o*Be,te+=o*be,ie+=o*_e,ce+=o*Ne,oe+=o*Re,me+=o*we,Se+=o*Le,xe+=o*ke,Ce+=o*De,ve+=o*Ue,ge+=o*Pe,Te+=o*Ee,Fe+=o*Ie,Me+=o*Ve,He+=o*Oe,o=w[5],G+=o*Ae,te+=o*Be,ie+=o*be,ce+=o*_e,oe+=o*Ne,me+=o*Re,Se+=o*we,xe+=o*Le,Ce+=o*ke,ve+=o*De,ge+=o*Ue,Te+=o*Pe,Fe+=o*Ee,Me+=o*Ie,He+=o*Ve,Ge+=o*Oe,o=w[6],te+=o*Ae,ie+=o*Be,ce+=o*be,oe+=o*_e,me+=o*Ne,Se+=o*Re,xe+=o*we,Ce+=o*Le,ve+=o*ke,ge+=o*De,Te+=o*Ue,Fe+=o*Pe,Me+=o*Ee,He+=o*Ie,Ge+=o*Ve,Qe+=o*Oe,o=w[7],ie+=o*Ae,ce+=o*Be,oe+=o*be,me+=o*_e,Se+=o*Ne,xe+=o*Re,Ce+=o*we,ve+=o*Le,ge+=o*ke,Te+=o*De,Fe+=o*Ue,Me+=o*Pe,He+=o*Ee,Ge+=o*Ie,Qe+=o*Ve,Ye+=o*Oe,o=w[8],ce+=o*Ae,oe+=o*Be,me+=o*be,Se+=o*_e,xe+=o*Ne,Ce+=o*Re,ve+=o*we,ge+=o*Le,Te+=o*ke,Fe+=o*De,Me+=o*Ue,He+=o*Pe,Ge+=o*Ee,Qe+=o*Ie,Ye+=o*Ve,je+=o*Oe,o=w[9],oe+=o*Ae,me+=o*Be,Se+=o*be,xe+=o*_e,Ce+=o*Ne,ve+=o*Re,ge+=o*we,Te+=o*Le,Fe+=o*ke,Me+=o*De,He+=o*Ue,Ge+=o*Pe,Qe+=o*Ee,Ye+=o*Ie,je+=o*Ve,tt+=o*Oe,o=w[10],me+=o*Ae,Se+=o*Be,xe+=o*be,Ce+=o*_e,ve+=o*Ne,ge+=o*Re,Te+=o*we,Fe+=o*Le,Me+=o*ke,He+=o*De,Ge+=o*Ue,Qe+=o*Pe,Ye+=o*Ee,je+=o*Ie,tt+=o*Ve,at+=o*Oe,o=w[11],Se+=o*Ae,xe+=o*Be,Ce+=o*be,ve+=o*_e,ge+=o*Ne,Te+=o*Re,Fe+=o*we,Me+=o*Le,He+=o*ke,Ge+=o*De,Qe+=o*Ue,Ye+=o*Pe,je+=o*Ee,tt+=o*Ie,at+=o*Ve,it+=o*Oe,o=w[12],xe+=o*Ae,Ce+=o*Be,ve+=o*be,ge+=o*_e,Te+=o*Ne,Fe+=o*Re,Me+=o*we,He+=o*Le,Ge+=o*ke,Qe+=o*De,Ye+=o*Ue,je+=o*Pe,tt+=o*Ee,at+=o*Ie,it+=o*Ve,lt+=o*Oe,o=w[13],Ce+=o*Ae,ve+=o*Be,ge+=o*be,Te+=o*_e,Fe+=o*Ne,Me+=o*Re,He+=o*we,Ge+=o*Le,Qe+=o*ke,Ye+=o*De,je+=o*Ue,tt+=o*Pe,at+=o*Ee,it+=o*Ie,lt+=o*Ve,ct+=o*Oe,o=w[14],ve+=o*Ae,ge+=o*Be,Te+=o*be,Fe+=o*_e,Me+=o*Ne,He+=o*Re,Ge+=o*we,Qe+=o*Le,Ye+=o*ke,je+=o*De,tt+=o*Ue,at+=o*Pe,it+=o*Ee,lt+=o*Ie,ct+=o*Ve,gt+=o*Oe,o=w[15],ge+=o*Ae,Te+=o*Be,Fe+=o*be,Me+=o*_e,He+=o*Ne,Ge+=o*Re,Qe+=o*we,Ye+=o*Le,je+=o*ke,tt+=o*De,at+=o*Ue,it+=o*Pe,lt+=o*Ee,ct+=o*Ie,gt+=o*Ve,At+=o*Oe,K+=38*Te,P+=38*Fe,z+=38*Me,ee+=38*He,ae+=38*Ge,G+=38*Qe,te+=38*Ye,ie+=38*je,ce+=38*tt,oe+=38*at,me+=38*it,Se+=38*lt,xe+=38*ct,Ce+=38*gt,ve+=38*At,A=1,o=K+A+65535,A=Math.floor(o/65536),K=o-A*65536,o=P+A+65535,A=Math.floor(o/65536),P=o-A*65536,o=z+A+65535,A=Math.floor(o/65536),z=o-A*65536,o=ee+A+65535,A=Math.floor(o/65536),ee=o-A*65536,o=ae+A+65535,A=Math.floor(o/65536),ae=o-A*65536,o=G+A+65535,A=Math.floor(o/65536),G=o-A*65536,o=te+A+65535,A=Math.floor(o/65536),te=o-A*65536,o=ie+A+65535,A=Math.floor(o/65536),ie=o-A*65536,o=ce+A+65535,A=Math.floor(o/65536),ce=o-A*65536,o=oe+A+65535,A=Math.floor(o/65536),oe=o-A*65536,o=me+A+65535,A=Math.floor(o/65536),me=o-A*65536,o=Se+A+65535,A=Math.floor(o/65536),Se=o-A*65536,o=xe+A+65535,A=Math.floor(o/65536),xe=o-A*65536,o=Ce+A+65535,A=Math.floor(o/65536),Ce=o-A*65536,o=ve+A+65535,A=Math.floor(o/65536),ve=o-A*65536,o=ge+A+65535,A=Math.floor(o/65536),ge=o-A*65536,K+=A-1+37*(A-1),A=1,o=K+A+65535,A=Math.floor(o/65536),K=o-A*65536,o=P+A+65535,A=Math.floor(o/65536),P=o-A*65536,o=z+A+65535,A=Math.floor(o/65536),z=o-A*65536,o=ee+A+65535,A=Math.floor(o/65536),ee=o-A*65536,o=ae+A+65535,A=Math.floor(o/65536),ae=o-A*65536,o=G+A+65535,A=Math.floor(o/65536),G=o-A*65536,o=te+A+65535,A=Math.floor(o/65536),te=o-A*65536,o=ie+A+65535,A=Math.floor(o/65536),ie=o-A*65536,o=ce+A+65535,A=Math.floor(o/65536),ce=o-A*65536,o=oe+A+65535,A=Math.floor(o/65536),oe=o-A*65536,o=me+A+65535,A=Math.floor(o/65536),me=o-A*65536,o=Se+A+65535,A=Math.floor(o/65536),Se=o-A*65536,o=xe+A+65535,A=Math.floor(o/65536),xe=o-A*65536,o=Ce+A+65535,A=Math.floor(o/65536),Ce=o-A*65536,o=ve+A+65535,A=Math.floor(o/65536),ve=o-A*65536,o=ge+A+65535,A=Math.floor(o/65536),ge=o-A*65536,K+=A-1+37*(A-1),l[0]=K,l[1]=P,l[2]=z,l[3]=ee,l[4]=ae,l[5]=G,l[6]=te,l[7]=ie,l[8]=ce,l[9]=oe,l[10]=me,l[11]=Se,l[12]=xe,l[13]=Ce,l[14]=ve,l[15]=ge}return hr}var dr,ga;function Ra(){if(ga)return dr;ga=1;var r=ue();de(),Xe(),Ct(),dr=r.kem=r.kem||{};var e=r.jsbn.BigInteger;r.kem.rsa={},r.kem.rsa.create=function(p,b){b=b||{};var x=b.prng||r.random,c={};return c.encrypt=function(t,y){var f=Math.ceil(t.n.bitLength()/8),S;do S=new e(r.util.bytesToHex(x.getBytesSync(f)),16).mod(t.n);while(S.compareTo(e.ONE)<=0);S=r.util.hexToBytes(S.toString(16));var k=f-S.length;k>0&&(S=r.util.fillString("\0",k)+S);var E=t.encrypt(S,"NONE"),u=p.generate(S,y);return{encapsulation:E,key:u}},c.decrypt=function(t,y,f){var S=t.decrypt(y,"NONE");return p.generate(S,f)},c},r.kem.kdf1=function(p,b){n(this,p,0,b||p.digestLength)},r.kem.kdf2=function(p,b){n(this,p,1,b||p.digestLength)};function n(p,b,x,c){p.generate=function(t,y){for(var f=new r.util.ByteBuffer,S=Math.ceil(y/c)+x,k=new r.util.ByteBuffer,E=x;E<S;++E){k.putInt32(E),b.start(),b.update(t+k.getBytes());var u=b.digest();f.putBytes(u.getBytes(c))}return f.truncate(f.length()-y),f.getBytes()}}return dr}var pr,ya;function wa(){if(ya)return pr;ya=1;var r=ue();de(),pr=r.log=r.log||{},r.log.levels=["none","error","warning","info","debug","verbose","max"];var e={},n=[],p=null;r.log.LEVEL_LOCKED=2,r.log.NO_LEVEL_CHECK=4,r.log.INTERPOLATE=8;for(var b=0;b<r.log.levels.length;++b){var x=r.log.levels[b];e[x]={index:b,name:x.toUpperCase()}}r.log.logMessage=function(E){for(var u=e[E.level].index,g=0;g<n.length;++g){var C=n[g];if(C.flags&r.log.NO_LEVEL_CHECK)C.f(E);else{var m=e[C.level].index;u<=m&&C.f(C,E)}}},r.log.prepareStandard=function(E){"standard"in E||(E.standard=e[E.level].name+" ["+E.category+"] "+E.message)},r.log.prepareFull=function(E){if(!("full"in E)){var u=[E.message];u=u.concat([]),E.full=r.util.format.apply(this,u)}},r.log.prepareStandardFull=function(E){"standardFull"in E||(r.log.prepareStandard(E),E.standardFull=E.standard)};for(var c=["error","warning","info","debug","verbose"],b=0;b<c.length;++b)(function(u){r.log[u]=function(g,C){var m=Array.prototype.slice.call(arguments).slice(2),s={timestamp:new Date,level:u,category:g,message:C,arguments:m};r.log.logMessage(s)}})(c[b]);if(r.log.makeLogger=function(E){var u={flags:0,f:E};return r.log.setLevel(u,"none"),u},r.log.setLevel=function(E,u){var g=!1;if(E&&!(E.flags&r.log.LEVEL_LOCKED))for(var C=0;C<r.log.levels.length;++C){var m=r.log.levels[C];if(u==m){E.level=u,g=!0;break}}return g},r.log.lock=function(E,u){typeof u>"u"||u?E.flags|=r.log.LEVEL_LOCKED:E.flags&=~r.log.LEVEL_LOCKED},r.log.addLogger=function(E){n.push(E)},typeof console<"u"&&"log"in console){var t;if(console.error&&console.warn&&console.info&&console.debug){var y={error:console.error,warning:console.warn,info:console.info,debug:console.debug,verbose:console.debug},f=function(E,u){r.log.prepareStandard(u);var g=y[u.level],C=[u.standard];C=C.concat(u.arguments.slice()),g.apply(console,C)};t=r.log.makeLogger(f)}else{var f=function(u,g){r.log.prepareStandardFull(g),console.log(g.standardFull)};t=r.log.makeLogger(f)}r.log.setLevel(t,"debug"),r.log.addLogger(t),p=t}else console={log:function(){}};if(p!==null&&typeof window<"u"&&window.location){var S=new URL(window.location.href).searchParams;if(S.has("console.level")&&r.log.setLevel(p,S.get("console.level").slice(-1)[0]),S.has("console.lock")){var k=S.get("console.lock").slice(-1)[0];k=="true"&&r.log.lock(p)}}return r.log.consoleLogger=p,pr}var vr,ma;function La(){return ma||(ma=1,vr=rt(),Mt(),pt(),Vr(),da()),vr}var gr={exports:{}},Ca;function ka(){if(Ca)return gr.exports;Ca=1;var r=ue();ot(),et(),yt(),ut(),ft(),Zr(),Xe(),de(),lr();var e=r.asn1,n=gr.exports=r.pkcs7=r.pkcs7||{};n.messageFromPem=function(u){var g=r.pem.decode(u)[0];if(g.type!=="PKCS7"){var C=new Error('Could not convert PKCS#7 message from PEM; PEM header type is not "PKCS#7".');throw C.headerType=g.type,C}if(g.procType&&g.procType.type==="ENCRYPTED")throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");var m=e.fromDer(g.body);return n.messageFromAsn1(m)},n.messageToPem=function(u,g){var C={type:"PKCS7",body:e.toDer(u.toAsn1()).getBytes()};return r.pem.encode(C,{maxline:g})},n.messageFromAsn1=function(u){var g={},C=[];if(!e.validate(u,n.asn1.contentInfoValidator,g,C)){var m=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.");throw m.errors=C,m}var s=e.derToOid(g.contentType),d;switch(s){case r.pki.oids.envelopedData:d=n.createEnvelopedData();break;case r.pki.oids.encryptedData:d=n.createEncryptedData();break;case r.pki.oids.signedData:d=n.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+s+" is not (yet) supported.")}return d.fromAsn1(g.content.value[0]),d},n.createSignedData=function(){var u=null;return u={type:r.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(m){if(k(u,m,n.asn1.signedDataValidator),u.certificates=[],u.crls=[],u.digestAlgorithmIdentifiers=[],u.contentInfo=null,u.signerInfos=[],u.rawCapture.certificates)for(var s=u.rawCapture.certificates.value,d=0;d<s.length;++d)u.certificates.push(r.pki.certificateFromAsn1(s[d]))},toAsn1:function(){u.contentInfo||u.sign();for(var m=[],s=0;s<u.certificates.length;++s)m.push(r.pki.certificateToAsn1(u.certificates[s]));var d=[],v=e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(u.version).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,u.digestAlgorithmIdentifiers),u.contentInfo])]);return m.length>0&&v.value[0].value.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!0,m)),d.length>0&&v.value[0].value.push(e.create(e.Class.CONTEXT_SPECIFIC,1,!0,d)),v.value[0].value.push(e.create(e.Class.UNIVERSAL,e.Type.SET,!0,u.signerInfos)),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(u.type).getBytes()),v])},addSigner:function(m){var s=m.issuer,d=m.serialNumber;if(m.certificate){var v=m.certificate;typeof v=="string"&&(v=r.pki.certificateFromPem(v)),s=v.issuer.attributes,d=v.serialNumber}var I=m.key;if(!I)throw new Error("Could not add PKCS#7 signer; no private key specified.");typeof I=="string"&&(I=r.pki.privateKeyFromPem(I));var R=m.digestAlgorithm||r.pki.oids.sha1;switch(R){case r.pki.oids.sha1:case r.pki.oids.sha256:case r.pki.oids.sha384:case r.pki.oids.sha512:case r.pki.oids.md5:break;default:throw new Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+R)}var h=m.authenticatedAttributes||[];if(h.length>0){for(var i=!1,a=!1,B=0;B<h.length;++B){var D=h[B];if(!i&&D.type===r.pki.oids.contentType){if(i=!0,a)break;continue}if(!a&&D.type===r.pki.oids.messageDigest){if(a=!0,i)break;continue}}if(!i||!a)throw new Error("Invalid signer.authenticatedAttributes. If signer.authenticatedAttributes is specified, then it must contain at least two attributes, PKCS #9 content-type and PKCS #9 message-digest.")}u.signers.push({key:I,version:1,issuer:s,serialNumber:d,digestAlgorithm:R,signatureAlgorithm:r.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:h,unauthenticatedAttributes:[]})},sign:function(m){if(m=m||{},(typeof u.content!="object"||u.contentInfo===null)&&(u.contentInfo=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(r.pki.oids.data).getBytes())]),"content"in u)){var s;u.content instanceof r.util.ByteBuffer?s=u.content.bytes():typeof u.content=="string"&&(s=r.util.encodeUtf8(u.content)),m.detached?u.detachedContent=e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,s):u.contentInfo.value.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,s)]))}if(u.signers.length!==0){var d=g();C(d)}},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.")},addCertificate:function(m){typeof m=="string"&&(m=r.pki.certificateFromPem(m)),u.certificates.push(m)},addCertificateRevokationList:function(m){throw new Error("PKCS#7 CRL support not yet implemented.")}},u;function g(){for(var m={},s=0;s<u.signers.length;++s){var d=u.signers[s],v=d.digestAlgorithm;v in m||(m[v]=r.md[r.pki.oids[v]].create()),d.authenticatedAttributes.length===0?d.md=m[v]:d.md=r.md[r.pki.oids[v]].create()}u.digestAlgorithmIdentifiers=[];for(var v in m)u.digestAlgorithmIdentifiers.push(e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(v).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")]));return m}function C(m){var s;if(u.detachedContent?s=u.detachedContent:(s=u.contentInfo.value[1],s=s.value[0]),!s)throw new Error("Could not sign PKCS#7 message; there is no content to sign.");var d=e.derToOid(u.contentInfo.value[0].value),v=e.toDer(s);v.getByte(),e.getBerValueLength(v),v=v.getBytes();for(var I in m)m[I].start().update(v);for(var R=new Date,h=0;h<u.signers.length;++h){var i=u.signers[h];if(i.authenticatedAttributes.length===0){if(d!==r.pki.oids.data)throw new Error("Invalid signer; authenticatedAttributes must be present when the ContentInfo content type is not PKCS#7 Data.")}else{i.authenticatedAttributesAsn1=e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[]);for(var a=e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[]),B=0;B<i.authenticatedAttributes.length;++B){var D=i.authenticatedAttributes[B];D.type===r.pki.oids.messageDigest?D.value=m[i.digestAlgorithm].digest():D.type===r.pki.oids.signingTime&&(D.value||(D.value=R)),a.value.push(f(D)),i.authenticatedAttributesAsn1.value.push(f(D))}v=e.toDer(a).getBytes(),i.md.start().update(v)}i.signature=i.key.sign(i.md,"RSASSA-PKCS1-V1_5")}u.signerInfos=y(u.signers)}},n.createEncryptedData=function(){var u=null;return u={type:r.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:r.pki.oids["aes256-CBC"]},fromAsn1:function(g){k(u,g,n.asn1.encryptedDataValidator)},decrypt:function(g){g!==void 0&&(u.encryptedContent.key=g),E(u)}},u},n.createEnvelopedData=function(){var u=null;return u={type:r.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:r.pki.oids["aes256-CBC"]},fromAsn1:function(g){var C=k(u,g,n.asn1.envelopedDataValidator);u.recipients=x(C.recipientInfos.value)},toAsn1:function(){return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(u.type).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(u.version).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,c(u.recipients)),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,S(u.encryptedContent))])])])},findRecipient:function(g){for(var C=g.issuer.attributes,m=0;m<u.recipients.length;++m){var s=u.recipients[m],d=s.issuer;if(s.serialNumber===g.serialNumber&&d.length===C.length){for(var v=!0,I=0;I<C.length;++I)if(d[I].type!==C[I].type||d[I].value!==C[I].value){v=!1;break}if(v)return s}}return null},decrypt:function(g,C){if(u.encryptedContent.key===void 0&&g!==void 0&&C!==void 0)switch(g.encryptedContent.algorithm){case r.pki.oids.rsaEncryption:case r.pki.oids.desCBC:var m=C.decrypt(g.encryptedContent.content);u.encryptedContent.key=r.util.createBuffer(m);break;default:throw new Error("Unsupported asymmetric cipher, OID "+g.encryptedContent.algorithm)}E(u)},addRecipient:function(g){u.recipients.push({version:0,issuer:g.issuer.attributes,serialNumber:g.serialNumber,encryptedContent:{algorithm:r.pki.oids.rsaEncryption,key:g.publicKey}})},encrypt:function(g,C){if(u.encryptedContent.content===void 0){C=C||u.encryptedContent.algorithm,g=g||u.encryptedContent.key;var m,s,d;switch(C){case r.pki.oids["aes128-CBC"]:m=16,s=16,d=r.aes.createEncryptionCipher;break;case r.pki.oids["aes192-CBC"]:m=24,s=16,d=r.aes.createEncryptionCipher;break;case r.pki.oids["aes256-CBC"]:m=32,s=16,d=r.aes.createEncryptionCipher;break;case r.pki.oids["des-EDE3-CBC"]:m=24,s=8,d=r.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+C)}if(g===void 0)g=r.util.createBuffer(r.random.getBytes(m));else if(g.length()!=m)throw new Error("Symmetric key has wrong length; got "+g.length()+" bytes, expected "+m+".");u.encryptedContent.algorithm=C,u.encryptedContent.key=g,u.encryptedContent.parameter=r.util.createBuffer(r.random.getBytes(s));var v=d(g);if(v.start(u.encryptedContent.parameter.copy()),v.update(u.content),!v.finish())throw new Error("Symmetric encryption failed.");u.encryptedContent.content=v.output}for(var I=0;I<u.recipients.length;++I){var R=u.recipients[I];if(R.encryptedContent.content===void 0)switch(R.encryptedContent.algorithm){case r.pki.oids.rsaEncryption:R.encryptedContent.content=R.encryptedContent.key.encrypt(u.encryptedContent.key.data);break;default:throw new Error("Unsupported asymmetric cipher, OID "+R.encryptedContent.algorithm)}}}},u};function p(u){var g={},C=[];if(!e.validate(u,n.asn1.recipientInfoValidator,g,C)){var m=new Error("Cannot read PKCS#7 RecipientInfo. ASN.1 object is not an PKCS#7 RecipientInfo.");throw m.errors=C,m}return{version:g.version.charCodeAt(0),issuer:r.pki.RDNAttributesAsArray(g.issuer),serialNumber:r.util.createBuffer(g.serial).toHex(),encryptedContent:{algorithm:e.derToOid(g.encAlgorithm),parameter:g.encParameter?g.encParameter.value:void 0,content:g.encKey}}}function b(u){return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(u.version).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[r.pki.distinguishedNameToAsn1({attributes:u.issuer}),e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,r.util.hexToBytes(u.serialNumber))]),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(u.encryptedContent.algorithm).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")]),e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,u.encryptedContent.content)])}function x(u){for(var g=[],C=0;C<u.length;++C)g.push(p(u[C]));return g}function c(u){for(var g=[],C=0;C<u.length;++C)g.push(b(u[C]));return g}function t(u){var g=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(u.version).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[r.pki.distinguishedNameToAsn1({attributes:u.issuer}),e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,r.util.hexToBytes(u.serialNumber))]),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(u.digestAlgorithm).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")])]);if(u.authenticatedAttributesAsn1&&g.value.push(u.authenticatedAttributesAsn1),g.value.push(e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(u.signatureAlgorithm).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")])),g.value.push(e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,u.signature)),u.unauthenticatedAttributes.length>0){for(var C=e.create(e.Class.CONTEXT_SPECIFIC,1,!0,[]),m=0;m<u.unauthenticatedAttributes.length;++m){var s=u.unauthenticatedAttributes[m];C.values.push(f(s))}g.value.push(C)}return g}function y(u){for(var g=[],C=0;C<u.length;++C)g.push(t(u[C]));return g}function f(u){var g;if(u.type===r.pki.oids.contentType)g=e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(u.value).getBytes());else if(u.type===r.pki.oids.messageDigest)g=e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,u.value.bytes());else if(u.type===r.pki.oids.signingTime){var C=new Date("1950-01-01T00:00:00Z"),m=new Date("2050-01-01T00:00:00Z"),s=u.value;if(typeof s=="string"){var d=Date.parse(s);isNaN(d)?s.length===13?s=e.utcTimeToDate(s):s=e.generalizedTimeToDate(s):s=new Date(d)}s>=C&&s<m?g=e.create(e.Class.UNIVERSAL,e.Type.UTCTIME,!1,e.dateToUtcTime(s)):g=e.create(e.Class.UNIVERSAL,e.Type.GENERALIZEDTIME,!1,e.dateToGeneralizedTime(s))}return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(u.type).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[g])])}function S(u){return[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(r.pki.oids.data).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(u.algorithm).getBytes()),u.parameter?e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,u.parameter.getBytes()):void 0]),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,u.content.getBytes())])]}function k(u,g,C){var m={},s=[];if(!e.validate(g,C,m,s)){var d=new Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.");throw d.errors=d,d}var v=e.derToOid(m.contentType);if(v!==r.pki.oids.data)throw new Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(m.encryptedContent){var I="";if(r.util.isArray(m.encryptedContent))for(var R=0;R<m.encryptedContent.length;++R){if(m.encryptedContent[R].type!==e.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");I+=m.encryptedContent[R].value}else I=m.encryptedContent;u.encryptedContent={algorithm:e.derToOid(m.encAlgorithm),parameter:r.util.createBuffer(m.encParameter.value),content:r.util.createBuffer(I)}}if(m.content){var I="";if(r.util.isArray(m.content))for(var R=0;R<m.content.length;++R){if(m.content[R].type!==e.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");I+=m.content[R].value}else I=m.content;u.content=r.util.createBuffer(I)}return u.version=m.version.charCodeAt(0),u.rawCapture=m,m}function E(u){if(u.encryptedContent.key===void 0)throw new Error("Symmetric key not available.");if(u.content===void 0){var g;switch(u.encryptedContent.algorithm){case r.pki.oids["aes128-CBC"]:case r.pki.oids["aes192-CBC"]:case r.pki.oids["aes256-CBC"]:g=r.aes.createDecryptionCipher(u.encryptedContent.key);break;case r.pki.oids.desCBC:case r.pki.oids["des-EDE3-CBC"]:g=r.des.createDecryptionCipher(u.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+u.encryptedContent.algorithm)}if(g.start(u.encryptedContent.parameter),g.update(u.encryptedContent.content),!g.finish())throw new Error("Symmetric decryption failed.");u.content=g.output}}return gr.exports}var yr={exports:{}},Ea;function Da(){if(Ea)return yr.exports;Ea=1;var r=ue();ot(),dt(),Mt(),pt(),de();var e=yr.exports=r.ssh=r.ssh||{};e.privateKeyToPutty=function(x,c,t){t=t||"",c=c||"";var y="ssh-rsa",f=c===""?"none":"aes256-cbc",S="PuTTY-User-Key-File-2: "+y+`\r
`;S+="Encryption: "+f+`\r
`,S+="Comment: "+t+`\r
`;var k=r.util.createBuffer();p(k,y),n(k,x.e),n(k,x.n);var E=r.util.encode64(k.bytes(),64),u=Math.floor(E.length/66)+1;S+="Public-Lines: "+u+`\r
`,S+=E;var g=r.util.createBuffer();n(g,x.d),n(g,x.p),n(g,x.q),n(g,x.qInv);var C;if(!c)C=r.util.encode64(g.bytes(),64);else{var m=g.length()+16-1;m-=m%16;var s=b(g.bytes());s.truncate(s.length()-m+g.length()),g.putBuffer(s);var d=r.util.createBuffer();d.putBuffer(b("\0\0\0\0",c)),d.putBuffer(b("\0\0\0",c));var v=r.aes.createEncryptionCipher(d.truncate(8),"CBC");v.start(r.util.createBuffer().fillWithByte(0,16)),v.update(g.copy()),v.finish();var I=v.output;I.truncate(16),C=r.util.encode64(I.bytes(),64)}u=Math.floor(C.length/66)+1,S+=`\r
Private-Lines: `+u+`\r
`,S+=C;var R=b("putty-private-key-file-mac-key",c),h=r.util.createBuffer();p(h,y),p(h,f),p(h,t),h.putInt32(k.length()),h.putBuffer(k),h.putInt32(g.length()),h.putBuffer(g);var i=r.hmac.create();return i.start("sha1",R),i.update(h.bytes()),S+=`\r
Private-MAC: `+i.digest().toHex()+`\r
`,S},e.publicKeyToOpenSSH=function(x,c){var t="ssh-rsa";c=c||"";var y=r.util.createBuffer();return p(y,t),n(y,x.e),n(y,x.n),t+" "+r.util.encode64(y.bytes())+" "+c},e.privateKeyToOpenSSH=function(x,c){return c?r.pki.encryptRsaPrivateKey(x,c,{legacy:!0,algorithm:"aes128"}):r.pki.privateKeyToPem(x)},e.getPublicKeyFingerprint=function(x,c){c=c||{};var t=c.md||r.md.md5.create(),y="ssh-rsa",f=r.util.createBuffer();p(f,y),n(f,x.e),n(f,x.n),t.start(),t.update(f.getBytes());var S=t.digest();if(c.encoding==="hex"){var k=S.toHex();return c.delimiter?k.match(/.{2}/g).join(c.delimiter):k}else{if(c.encoding==="binary")return S.getBytes();if(c.encoding)throw new Error('Unknown encoding "'+c.encoding+'".')}return S};function n(x,c){var t=c.toString(16);t[0]>="8"&&(t="00"+t);var y=r.util.hexToBytes(t);x.putInt32(y.length),x.putBytes(y)}function p(x,c){x.putInt32(c.length),x.putString(c)}function b(){for(var x=r.md.sha1.create(),c=arguments.length,t=0;t<c;++t)x.update(arguments[t]);return x.digest()}return yr.exports}var mr,xa;function Ua(){return xa||(xa=1,mr=ue(),ot(),ba(),et(),Lt(),yt(),Na(),dt(),Ra(),wa(),La(),ta(),Yt(),ft(),zr(),sa(),ka(),ua(),Wr(),Kr(),ur(),Xe(),qr(),Da(),fa(),de()),mr}var Pa=Ua();const Tt=Ta(Pa);console.log("Content script loaded - Consent Cryptographic Handler with JWS");const vt={arrayBufferToHex(r){return Array.from(new Uint8Array(r)).map(e=>e.toString(16).padStart(2,"0")).join("")},stringToArrayBuffer(r){return new TextEncoder().encode(r)},hexToArrayBuffer(r){const e=new Uint8Array(r.length/2);for(let n=0;n<r.length;n+=2)e[n/2]=parseInt(r.substr(n,2),16);return e.buffer},base64UrlEncode(r){return btoa(String.fromCharCode(...new Uint8Array(r))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")},base64UrlDecode(r){return r+="=".repeat((4-r.length%4)%4),r=r.replace(/-/g,"+").replace(/_/g,"/"),Uint8Array.from(atob(r),e=>e.charCodeAt(0))},async importRSAPublicKey(r){const p=r.replace("-----BEGIN PUBLIC KEY-----","").replace("-----END PUBLIC KEY-----","").replace(/\s/g,""),b=atob(p),x=new Uint8Array(b.length);for(let c=0;c<b.length;c++)x[c]=b.charCodeAt(c);return window.crypto.subtle.importKey("spki",x.buffer,{name:"RSA-PSS",hash:{name:"SHA-256"}},!1,["verify"])},async importPrivateKey(r){const e=r.replace(/-----BEGIN (.*)-----/,"").replace(/-----END (.*)-----/,"").replace(/\s+/g,""),n=Uint8Array.from(atob(e),p=>p.charCodeAt(0));return await crypto.subtle.importKey("pkcs8",n.buffer,{name:"RSA-PSS",hash:"SHA-256"},!1,["sign"])},formatPem(r,e){const n=`-----BEGIN ${e}-----`,p=`-----END ${e}-----`,x=r.replace(/-----.*?-----/g,"").replace(/\s+/g,"").match(/.{1,64}/g).join(`
`);return`${n}
${x}
${p}`},async loadSigningKeyPair(){let r,e;try{r=localStorage.getItem("cert"),r=this.formatPem(r,"CERTIFICATE"),console.log(r),e=localStorage.getItem("privKey"),e=this.formatPem(e,"PRIVATE KEY"),console.log(e)}catch(b){throw console.error("Error getting local storage PEM values:",b),b}const n=Tt.pki.certificateFromPem(r);return{pubKey:Tt.pki.publicKeyToPem(n.publicKey),privKey:e}},async exportPublicKey(r){const e=await window.crypto.subtle.exportKey("spki",r),n=btoa(String.fromCharCode(...new Uint8Array(e))),p="-----BEGIN PUBLIC KEY-----",b="-----END PUBLIC KEY-----",x=n.match(/.{1,64}/g).join(`
`);return`${p}
${x}
${b}`},async signData(r,e){const n=this.stringToArrayBuffer(JSON.stringify(e));console.log("Falha aqui?");const p=await window.crypto.subtle.sign({name:"RSA-PSS",saltLength:32},r,n);return console.log("OU aqui?"),this.base64UrlEncode(p)},async verifyServerJWS(r,e,n){const p=JSON.parse(r);if(!p.payload||!Array.isArray(p.signatures))throw new Error("Invalid JWS JSON serialization format");const b=p.signatures[1];if(!b||!b.signature||!b.header)throw new Error("Missing server signature entry");if(!await window.crypto.subtle.verify({name:"RSA-PSS",saltLength:32},n,this.base64UrlDecode(b.signature),this.stringToArrayBuffer(JSON.stringify(e))))throw new Error("Invalid server signature");const c=this.base64UrlDecode(p.payload);return JSON.parse(new TextDecoder().decode(c))}};async function Cr(r){console.log("Processing consent data with JWS:",r);try{const n=await(await fetch("http://127.0.0.1:3000/api/server_certificate")).json(),p=Tt.pki.certificateFromPem(n),b=Tt.pki.publicKeyToPem(p.publicKey);console.log("Received server public key data:",b);const x=await vt.importRSAPublicKey(b);console.log("Imported server RSA public key");const c=await vt.loadSigningKeyPair(),t=await vt.importPrivateKey(c.privKey);console.log("Loaded client RSA signing keys");const y=await vt.signData(t,r);console.log("Client signed the consent");const f=await fetch("http://127.0.0.1:3000/api/consent",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({signature:y,consent:r,pubkey:c.pubKey})});console.log("Client sent the info");const S=await f.json();if(console.log(S),S.success&&S.serverSignedJWS)try{const k=await vt.verifyServerJWS(S.serverSignedJWS,r,x);return console.log(" Server-signed JWS verified successfully"),console.log("Final payload:",k),!0}catch(k){return console.error(" Server JWS verification failed:",k),!1}else return console.error("Server error:",S.error),!1}catch(e){return console.error("Error processing consent:",e),!1}}document.addEventListener("click",function(r){r.target.closest(".cm-btn-success")?(console.log(" User submitted positive consent"),setTimeout(()=>{console.log("Parsing cookie...");const e=document.cookie.split("; ").find(n=>n.startsWith("klaro="));if(e){const n=decodeURIComponent(e.split("=")[1]),b={consents:JSON.parse(n),confirmed:!0,timestamp:new Date().toISOString()};console.log("[DEBUG] consentData:",b),Cr(JSON.parse(JSON.stringify(b))).then(x=>{console.log("Consent processing complete:",x?"Success":"Failed")}).catch(x=>{console.error("Consent processing error:",x)})}else console.error("Klaro cookie not found.")},100)):r.target.closest(".cm-btn-decline")&&(console.log(" User submitted negative consent"),setTimeout(()=>{const e=window.klaro?.getManager();if(e){const n={consents:e.consents,confirmed:!1,timestamp:new Date().toISOString()};Cr(n).then(p=>{console.log("Consent processing complete:",p?"Success":"Failed")}).catch(p=>{console.error("Consent processing error:",p)})}},100))});let It=!1;document.addEventListener("checkConsentExtension",function(r){console.log("Extension check received:",r.detail);const e=new CustomEvent("consentExtensionPresent",{detail:{id:"cch-extension-present",version:"1.0"}});window.dispatchEvent(e),console.log("Extension presence confirmed to page")}),document.addEventListener("consentUpdated",function(r){if(console.log("Consent updated event received"),It){console.log("Already processing consent, skipping...");return}const e=window.klaroConsentData;e&&(console.log("Processing consent from event:",e),It=!0,window.consentHandledByExtension=!0,Cr(e).then(n=>{console.log("Consent processing complete:",n?"Success":"Failed"),It=!1}).catch(n=>{console.error("Consent processing error:",n),It=!1}))}),console.log("Consent Cryptographic Handler with JWS ready")})();
